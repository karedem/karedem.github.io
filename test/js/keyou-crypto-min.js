!function(t,e){"object"==typeof exports?module.exports=exports=e():"function"==typeof define&&define.amd?define([],e):t.KeyouCryptography=e()}(this,function(){function t(e,r,i){if(!(this instanceof t))return new t(e,r,i);null!=e&&("number"==typeof e?this.fromNumber(e,r,i):null==r&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,r))}function e(t){return U.charAt(t)}function r(t,e){var r=H[t.charCodeAt(e)];return null==r?-1:r}function n(e){var r=new t;return r.fromInt(e),r}function s(t){var e,r=1;return 0!=(e=t>>>16)&&(t=e,r+=16),0!=(e=t>>8)&&(t=e,r+=8),0!=(e=t>>4)&&(t=e,r+=4),0!=(e=t>>2)&&(t=e,r+=2),0!=(e=t>>1)&&(t=e,r+=1),r}function o(t){this.m=t}function a(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function h(t,e){return t&e}function u(t,e){return t|e}function c(t,e){return t^e}function f(t,e){return t&~e}function l(t){if(0==t)return-1;var e=0;return 0==(65535&t)&&(t>>=16,e+=16),0==(255&t)&&(t>>=8,e+=8),0==(15&t)&&(t>>=4,e+=4),0==(3&t)&&(t>>=2,e+=2),0==(1&t)&&++e,e}function g(t){for(var e=0;0!=t;)t&=t-1,++e;return e}function p(){}function d(t){return t}function F(e){this.r2=new t,this.q3=new t,t.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}function y(){this.i=0,this.j=0,this.S=new Array}function m(){return new y}function b(t){P[J++]^=255&t,P[J++]^=t>>8&255,P[J++]^=t>>16&255,P[J++]^=t>>24&255,J>=_&&(J-=_)}function A(){b((new Date).getTime())}function S(){if(null==M){for(A(),(M=m()).init(P),J=0;J<P.length;++J)P[J]=0;J=0}return M.next()}function E(){}function B(t,e){this.x=e,this.q=t}function w(e,r,i,n){this.curve=e,this.x=r,this.y=i,this.z=null==n?t.ONE:n,this.zinv=null}function x(t,e,r){this.q=t,this.a=this.fromBigInteger(e),this.b=this.fromBigInteger(r),this.infinity=new w(this,null,null)}function D(){this.BYTE_LENGTH=64,this.xBuf=new Array,this.xBufOff=0,this.byteCount=0,this.DIGEST_LENGTH=32,this.v0=[1937774191,1226093241,388252375,3666478592,2842636476,372324522,3817729613,2969243214],this.v0=[1937774191,1226093241,388252375,-628488704,-1452330820,372324522,-477237683,-1325724082],this.v=new Array(8),this.v_=new Array(8),this.X0=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.X=new Array(68),this.xOff=0,this.T_00_15=2043430169,this.T_16_63=2055708042,arguments.length>0?this.InitDigest(arguments[0]):this.Init()}var R=R||function(t){var e={};return e.util={},e.algorithm={},e.AsymmetricAlg={RSA:{name:"RSA"},SM2:{name:"SM2"}},e.SymmetricAlg={SM4:{name:"SM4",size:16},DES64:{name:"DES",size:8},DES128:{name:"DES",size:16},DES192:{name:"DES",size:24},AES128:{name:"AES",size:16},AES192:{name:"AES",size:24},AES256:{name:"AES",size:32}},e.Pad={padPKCS5:"PKCS5",padLV0:"LV0",pad0x00:"0x00",pad0x80:"0x80"},e.Hasher={NONE:{name:"NONE",DER_OID:""},SHA1:{name:"SHA1",DER_OID:"3021300906052b0E03021A05000414"},SHA224:{name:"SHA224",DER_OID:"302D300D06096086480165030402040500041C"},SHA256:{name:"SHA256",DER_OID:"3031300D060960864801650304020105000420"},SHA384:{name:"SHA384",DER_OID:"3041300D060960864801650304020205000430"},SHA512:{name:"SHA512",DER_OID:"3051300D060960864801650304020305000440"},MD5:{name:"MD5",DER_OID:"3020300C06082A864886F70d020505000410"}},e}();R.util.Checker={name:"Checker",checkOnlyPrintChar:function(t){return/^[\u0020-\u007E]+$/.test(t)},checkHasChinese:function(t){return/.*[\u2E80-\u9FFF]+.*$/.test(t)},checkArgument:function(t,e){if(!t)throw new TypeError("Illegal Argument:"+e)},checkExist:function(t,e){if(void 0===typeof t||null===t)throw new TypeError("object is undefined or object is null. "+e);return t},checkNotEmpty:function(t,e){if(void 0===typeof t||null===t)throw new TypeError("object is empty."+e);if(void 0!==typeof t.length&&0===t.length)throw new TypeError("object is empty."+e);return t},checkState:function(t,e){if(!t)throw new Error("Illegal State:"+e)}},function(){var t=R.util,e=t.Checker;t.Hex={name:"Hex",stringify:function(t){for(var e=[],r=t.length,i=0;i<r;i++){var n=t[i];e.push((n>>>4).toString(16)),e.push((15&n).toString(16))}return e.join("").toUpperCase()},encode:function(e){return"string"==typeof e&&e.constructor==String&&(e=t.Helper.ascstr2array(e)),this.stringify(e)},parse:function(t){var r=[];e.checkArgument(void 0!=t&&t.length%2==0,"illegal Hex string:"+t);var i=new RegExp("[A-Fa-f0-9]+$","g");e.checkArgument(t.match(i),"illegal Hex string:"+t);for(var n=t.length/2,s=0;s<n;s++)r[s]=parseInt(t.substring(2*s,2*s+2),16);return r},decode:function(t){return this.parse(t)},toUnsignBytes:function(t){for(var e=[],r=0;r<t.length;r++){var i=t[r];i<0&&(i+=256),e[r]=i}return e}}}(),R.util.UTF8={stringify:function(t){for(var e,r=t,i="",n=0;n<r.length;)(e=r[n])<192?n+=1:e<224?(e=(31&r[n])<<6|63&r[n+1],n+=2):e<240?(e=(15&r[n])<<12|(63&r[n+1])<<6|63&r[n+2],n+=3):e<248&&(e=(7&r[n])<<18|(63&r[n+1])<<12|(63&r[n+2])<<6|63&r[n+3],n+=4),i+=String.fromCharCode(e);return i},parse:function(t){for(var e,r=new Array,i=0;i<t.length;i++)(e=t.charCodeAt(i))<128?r.push(e):e<2048?(r.push(e>>>6&31|192),r.push(63&e|128)):e<65536?(r.push(e>>>12&15|224),r.push(e>>>6&63|128),r.push(63&e|128)):e<2097152&&(r.push(e>>>18&7|240),r.push(e>>>12&63|128),r.push(e>>>6&63|128),r.push(63&e|128));return r}},function(){var t=R.util.Long=function(t,e){this.high=t,this.low=e},e=function(t){for(;t<0;)t+=4294967296;return t};t.prototype.AND=function(){for(var r=new t(this.high,this.low),i=0;i<arguments.length;i++)r.high=arguments[i].high&r.high,r.low=arguments[i].low&r.low;return r.low=e(r.low),r},t.prototype.OR=function(){for(var r=new t(this.high,this.low),i=0;i<arguments.length;i++)r.high=arguments[i].high|r.high,r.low=arguments[i].low|r.low;return r.low=e(r.low),r},t.prototype.XOR=function(){for(var r=new t(this.high,this.low),i=0;i<arguments.length;i++)r.high=arguments[i].high^r.high,r.low=arguments[i].low^r.low;return r.low=e(r.low),r},t.prototype.leftShift=function(e){var r=new t(this.high,this.low),i=r.high<<e&4294967295;return e>=32?(r.high=r.low<<e-32,r.low=0,r):(r.high=i|r.low>>>32-e,r.low=r.low<<e&4294967295,r)},t.prototype.rightShift=function(e){var r=new t(this.high,this.low),i=r.low>>>e;return e>=32?(r.low=r.high>>>e-32,r.high=0,r):(r.low=i|r.high<<32-e&4294967295,r.high=r.high>>>e,r)},t.prototype.Negate=function(){var e=new t(this.high,this.low);return e.high=4294967295&~e.high,e.low=4294967295&~e.low,e},t.prototype.add=function(){for(var e=new t(this.high,this.low),r=0;r<arguments.length;r++){e.low+=arguments[r].low;var i=0;e.low>4294967295&&(i=1,e.low=e.low-4294967296),e.high+=arguments[r].high+i,e.high=4294967295&e.high}return e},t.prototype.mod=function(t){return(this.high%t<<32+this.low)%t},t.prototype.bigger=function(t){return this.high>t.high?1:this.high==t.high&&this.low>t.low?1:0},t.OR=function(t,e){return t.OR(e)},t.fixLow=function(t){return e(t)},t.getLongFromStr=function(e){var r=new t(0,0),i=e.indexOf("0x");if(e.length<=10){n=e.substring(e.length-8,e.length);return r.low=parseInt("0x"+n),r.high=0,r}if(0==i){var n=e.substring(e.length-8,e.length);r.low=parseInt("0x"+n);var s=e.substring(0,e.length-8);return r.high=parseInt(s),r}}}(),function(){var t=R.util,e=R.util.Checker,r=R.util.Long,n=R.util.Hex;t.Helper=function(){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=function(t){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(t)};return{getRandom:function(t){e.checkArgument(t>0,"the random of size must be more than zero.");for(var r,i=new Array(t),n=0;n<t;n++)r=987654071*function(t){var t=t,e=987654321,r=4294967295;return function(){var i=((e=36969*(65535&e)+(e>>16)&r)<<16)+(t=18e3*(65535&t)+(t>>16)&r)&r;return i/=4294967296,(i+=.5)*(Math.random()>.5?1:-1)}}(4294967296*(r||Math.random()))(),i[n]=255&r;return i},arraycopy:function(t,e,r,i,n){for(var s=0;s<n;s++)t[e+s]=r[i+s]},array2ascstr:function(t){for(var r="",i=0,n=t.length;i<n;i++)e.checkArgument(t[i]>=32&&t[i]<=126,"contains Non-printable ASCII Character in Array"),r+=String.fromCharCode(t[i]);return r},ascstr2array:function(t){if(0===t.length)return[];e.checkArgument(e.checkOnlyPrintChar(t),"only support printable ASCII character.");for(var r=new Array(t.length),i=0,n=t.length;i<n;i++)r[i]=t.charCodeAt(i);return r},bytes2integers:function(t,e){t.length%4!=0&&console.error("illegal argument.");for(var r=[],i=e||0,n=t.length;i<n;i+=4)r.push((t[i+0]<<24|t[i+1]<<16|t[i+2]<<8|t[i+3])>>>0);return r},integers2bytes:function(t,e){for(var r=[],i=e||0,n=t.length;i<n;i++)r.push(t[i]>>>24&255),r.push(t[i]>>>16&255),r.push(t[i]>>>8&255),r.push(t[i]>>>0&255);return r},hex2b64:function(e){var r,i,n="";for(r=0;r+3<=e.length;r+=3)i=parseInt(e.substring(r,r+3),16),n+=t.charAt(i>>6)+t.charAt(63&i);for(r+1==e.length?(i=parseInt(e.substring(r,r+1),16),n+=t.charAt(i<<2)):r+2==e.length&&(i=parseInt(e.substring(r,r+2),16),n+=t.charAt(i>>2)+t.charAt((3&i)<<4));(3&n.length)>0;)n+="=";return n},b64tohex:function(e){var r,i,n="",o=0;for(r=0;r<e.length&&"="!=e.charAt(r);++r)v=t.indexOf(e.charAt(r)),v<0||(0==o?(n+=s(v>>2),i=3&v,o=1):1==o?(n+=s(i<<2|v>>4),i=15&v,o=2):2==o?(n+=s(i),n+=s(v>>2),i=3&v,o=3):(n+=s(i<<2|v>>4),n+=s(15&v),o=0));return 1==o&&(n+=s(i<<2)),n},asctob64:function(t){var e=this.ascstr2array(t),r=n.stringify(e);return this.hex2b64(r)},b64toasc:function(t){var e=this.b64tohex(t),r=n.parse(e);return this.array2ascstr(r)},convertLong:function(t){var e=new Array(8),i=r.getLongFromStr(t);return e[0]=i.high>>>24&255,e[1]=i.high>>>16&255,e[2]=i.high>>>8&255,e[3]=i.high>>>0&255,e[4]=i.low>>>24&255,e[5]=i.low>>>16&255,e[6]=i.low>>>8&255,e[7]=i.low>>>0&255,e},convertInteger:function(t){var e=new Array(4);return e[0]=t>>>24&255,e[1]=t>>>16&255,e[2]=t>>>8&255,e[3]=t>>>0&255,e},ascXOR:function(t,e){return[48,49,50,51,52,53,54,55,56,57,65,66,67,68,69,70][9*(t>>6)+(15&t)^9*(e>>6)+(15&e)]},arrayXOR:function(t,e){var r=[];for(i=0;i<t.length;i++)r[i]=t[i]^e[i];return r},generateDecRandom:function(t){for(var e=this.getRandom(t),r="",i=0;i<t;i++)r+=e[i]%9;return r}}}()}(),function(t,e){"object"==typeof exports?module.exports=exports=e():"function"==typeof define&&define.amd?define([],e):t.UnionLogger=e()}(this,function(){var t=t||{size:1e3,startIndex:0,endIndex:0,store:new Array(1e3),get:function(){for(var t="",e=this.startIndex;e<this.endIndex;e++)t+="\n"+this.store[e];return t},set:function(t){this.store[this.endIndex]=t,this.endIndex=99==this.endIndex?0:this.endIndex+1},clean:function(){this.store=new Array(1e3),this.endIndex=0}};return t}),R.util.DataPadding={encodeWithNone:function(t,e){return t},decodeWithNone:function(t){return t},encodeWithPKCS5:function(t,e){for(var r=e-t.length%e,i=new Array(t.length+r),n=0;n<t.length;n++)i[n]=t[n];for(n=t.length;n<r+t.length;n++)i[n]=r;return i},decodeWithPKCS5:function(t){var e=t[t.length-1];return t.slice(0,t.length-e)},encodeWith0x00:function(t,e){for(var r=e-t.length%e,i=new Array(t.length+r),n=0;n<t.length;n++)i[n]=t[n];for(n=t.length;n<r+t.length;n++)i[n]=0;return i},decodeWith0x00:function(t){for(var e=0,r=t.length-1;r>=0;r--)if(0!=t[r]){e=r+1;break}return t.slice(0,e)},encodeWith0x80:function(t,e){for(var r=e-t.length%e,i=new Array(t.length+r),n=0;n<t.length;n++)i[n]=t[n];i[t.length]=128;for(n=t.length+1;n<r+t.length;n++)i[n]=0;return i},decodeWith0x80:function(t){for(var e=0,r=t.length-1;r>=0;r--)if(0!=t[r]&&128!=t[r]){e=r+1;break}return t.slice(0,e)},encodeWithLV0:function(t,e){},decodeWithLV0:function(t){}};var T=T||function(t,e){var r={},i=r.lib={},n=i.Base=function(){function t(){}return{extend:function(e){t.prototype=this;var r=new t;return e&&r.mixIn(e),r.hasOwnProperty("init")||(r.init=function(){r.$super.init.apply(this,arguments)}),r.init.prototype=r,r.$super=this,r},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),s=i.WordArray=n.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=void 0!=e?e:4*t.length},toString:function(t){return(t||a).stringify(this)},concat:function(t){var e=this.words,r=t.words,i=this.sigBytes,n=t.sigBytes;if(this.clamp(),i%4)for(o=0;o<n;o++){var s=r[o>>>2]>>>24-o%4*8&255;e[i+o>>>2]|=s<<24-(i+o)%4*8}else if(r.length>65535)for(var o=0;o<n;o+=4)e[i+o>>>2]=r[o>>>2];else e.push.apply(e,r);return this.sigBytes+=n,this},clamp:function(){var e=this.words,r=this.sigBytes;e[r>>>2]&=4294967295<<32-r%4*8,e.length=t.ceil(r/4)},clone:function(){var t=n.clone.call(this);return t.words=this.words.slice(0),t},random:function(e){for(var r=[],i=0;i<e;i+=4)r.push(4294967296*t.random()|0);return new s.init(r,e)}}),o=r.enc={},a=o.Hex={stringify:function(t){for(var e=t.words,r=t.sigBytes,i=[],n=0;n<r;n++){var s=e[n>>>2]>>>24-n%4*8&255;i.push((s>>>4).toString(16)),i.push((15&s).toString(16))}return i.join("")},parse:function(t){for(var e=t.length,r=[],i=0;i<e;i+=2)r[i>>>3]|=parseInt(t.substr(i,2),16)<<24-i%8*4;return new s.init(r,e/2)}},h=o.Latin1={stringify:function(t){for(var e=t.words,r=t.sigBytes,i=[],n=0;n<r;n++){var s=e[n>>>2]>>>24-n%4*8&255;i.push(String.fromCharCode(s))}return i.join("")},parse:function(t){for(var e=t.length,r=[],i=0;i<e;i++)r[i>>>2]|=(255&t.charCodeAt(i))<<24-i%4*8;return new s.init(r,e)}},u=o.Utf8={stringify:function(t){try{return decodeURIComponent(escape(h.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return h.parse(unescape(encodeURIComponent(t)))}},c=i.BufferedBlockAlgorithm=n.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=u.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var r=this._data,i=r.words,n=r.sigBytes,o=this.blockSize,a=n/(4*o),h=(a=e?t.ceil(a):t.max((0|a)-this._minBufferSize,0))*o,u=t.min(4*h,n);if(h){for(var c=0;c<h;c+=o)this._doProcessBlock(i,c);var f=i.splice(0,h);r.sigBytes-=u}return new s.init(f,u)},clone:function(){var t=n.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0}),f=(i.Hasher=c.extend({cfg:n.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){c.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,r){return new t.init(r).finalize(e)}},_createHmacHelper:function(t){return function(e,r){return new f.HMAC.init(t,r).finalize(e)}}}),r.algo={});return r}(Math);T.lib.Cipher||function(t){var e=T,r=e.lib,i=r.Base,n=r.WordArray,s=r.BufferedBlockAlgorithm,o=e.enc,a=(o.Utf8,o.Base64),h=e.algo.EvpKDF,u=r.Cipher=s.extend({cfg:i.extend(),createEncryptor:function(t,e){return this.create(this._ENC_XFORM_MODE,t,e)},createDecryptor:function(t,e){return this.create(this._DEC_XFORM_MODE,t,e)},init:function(t,e,r){this.cfg=this.cfg.extend(r),this._xformMode=t,this._key=e,this.reset()},reset:function(){s.reset.call(this),this._doReset()},process:function(t){return this._append(t),this._process()},finalize:function(t){return t&&this._append(t),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function t(t){return"string"==typeof t?y:F}return function(e){return{encrypt:function(r,i,n){return t(i).encrypt(e,r,i,n)},decrypt:function(r,i,n){return t(i).decrypt(e,r,i,n)}}}}()}),c=(r.StreamCipher=u.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),e.mode={}),f=r.BlockCipherMode=i.extend({createEncryptor:function(t,e){return this.Encryptor.create(t,e)},createDecryptor:function(t,e){return this.Decryptor.create(t,e)},init:function(t,e){this._cipher=t,this._iv=e}}),l=c.CBC=function(){function e(e,r,i){var n=this._iv;if(n){s=n;this._iv=t}else var s=this._prevBlock;for(var o=0;o<i;o++)e[r+o]^=s[o]}var r=f.extend();return r.Encryptor=r.extend({processBlock:function(t,r){var i=this._cipher,n=i.blockSize;e.call(this,t,r,n),i.encryptBlock(t,r),this._prevBlock=t.slice(r,r+n)}}),r.Decryptor=r.extend({processBlock:function(t,r){var i=this._cipher,n=i.blockSize,s=t.slice(r,r+n);i.decryptBlock(t,r),e.call(this,t,r,n),this._prevBlock=s}}),r}(),g=(e.pad={}).Pkcs7={pad:function(t,e){for(var r=4*e,i=r-t.sigBytes%r,s=i<<24|i<<16|i<<8|i,o=[],a=0;a<i;a+=4)o.push(s);var h=n.create(o,i);t.concat(h)},unpad:function(t){var e=255&t.words[t.sigBytes-1>>>2];t.sigBytes-=e}},p=(r.BlockCipher=u.extend({cfg:u.cfg.extend({mode:l,padding:g}),reset:function(){u.reset.call(this);var t=this.cfg,e=t.iv,r=t.mode;if(this._xformMode==this._ENC_XFORM_MODE)i=r.createEncryptor;else{var i=r.createDecryptor;this._minBufferSize=1}this._mode=i.call(r,this,e&&e.words)},_doProcessBlock:function(t,e){this._mode.processBlock(t,e)},_doFinalize:function(){var t=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){t.pad(this._data,this.blockSize);e=this._process(!0)}else{var e=this._process(!0);t.unpad(e)}return e},blockSize:4}),r.CipherParams=i.extend({init:function(t){this.mixIn(t)},toString:function(t){return(t||this.formatter).stringify(this)}})),d=(e.format={}).OpenSSL={stringify:function(t){var e=t.ciphertext,r=t.salt;if(r)i=n.create([1398893684,1701076831]).concat(r).concat(e);else var i=e;return i.toString(a)},parse:function(t){var e=a.parse(t),r=e.words;if(1398893684==r[0]&&1701076831==r[1]){var i=n.create(r.slice(2,4));r.splice(0,4),e.sigBytes-=16}return p.create({ciphertext:e,salt:i})}},F=r.SerializableCipher=i.extend({cfg:i.extend({format:d}),encrypt:function(t,e,r,i){i=this.cfg.extend(i);var n=t.createEncryptor(r,i),s=n.finalize(e),o=n.cfg;return p.create({ciphertext:s,key:r,iv:o.iv,algorithm:t,mode:o.mode,padding:o.padding,blockSize:t.blockSize,formatter:i.format})},decrypt:function(t,e,r,i){return i=this.cfg.extend(i),e=this._parse(e,i.format),t.createDecryptor(r,i).finalize(e.ciphertext)},_parse:function(t,e){return"string"==typeof t?e.parse(t,this):t}}),v=(e.kdf={}).OpenSSL={execute:function(t,e,r,i){i||(i=n.random(8));var s=h.create({keySize:e+r}).compute(t,i),o=n.create(s.words.slice(e),4*r);return s.sigBytes=4*e,p.create({key:s,iv:o,salt:i})}},y=r.PasswordBasedCipher=F.extend({cfg:F.cfg.extend({kdf:v}),encrypt:function(t,e,r,i){var n=(i=this.cfg.extend(i)).kdf.execute(r,t.keySize,t.ivSize);i.iv=n.iv;var s=F.encrypt.call(this,t,e,n.key,i);return s.mixIn(n),s},decrypt:function(t,e,r,i){i=this.cfg.extend(i),e=this._parse(e,i.format);var n=i.kdf.execute(r,t.keySize,t.ivSize,e.salt);return i.iv=n.iv,F.decrypt.call(this,t,e,n.key,i)}})}(),function(){function t(t,e){var r=(this._lBlock>>>t^this._rBlock)&e;this._rBlock^=r,this._lBlock^=r<<t}function e(t,e){var r=(this._rBlock>>>t^this._lBlock)&e;this._lBlock^=r,this._rBlock^=r<<t}var r=T,i=r.lib,n=i.WordArray,s=i.BlockCipher,o=r.algo,a=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],h=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],u=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],c=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],f=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],l=o.DES=s.extend({_doReset:function(){for(var t=this._key.words,e=[],r=0;r<56;r++){var i=a[r]-1;e[r]=t[i>>>5]>>>31-i%32&1}for(var n=this._subKeys=[],s=0;s<16;s++){for(var o=n[s]=[],c=u[s],r=0;r<24;r++)o[r/6|0]|=e[(h[r]-1+c)%28]<<31-r%6,o[4+(r/6|0)]|=e[28+(h[r+24]-1+c)%28]<<31-r%6;o[0]=o[0]<<1|o[0]>>>31;for(r=1;r<7;r++)o[r]=o[r]>>>4*(r-1)+3;o[7]=o[7]<<5|o[7]>>>27}for(var f=this._invSubKeys=[],r=0;r<16;r++)f[r]=n[15-r]},encryptBlock:function(t,e){this._doCryptBlock(t,e,this._subKeys)},decryptBlock:function(t,e){this._doCryptBlock(t,e,this._invSubKeys)},_doCryptBlock:function(r,i,n){this._lBlock=r[i],this._rBlock=r[i+1],t.call(this,4,252645135),t.call(this,16,65535),e.call(this,2,858993459),e.call(this,8,16711935),t.call(this,1,1431655765);for(var s=0;s<16;s++){for(var o=n[s],a=this._lBlock,h=this._rBlock,u=0,l=0;l<8;l++)u|=c[l][((h^o[l])&f[l])>>>0];this._lBlock=h,this._rBlock=a^u}var g=this._lBlock;this._lBlock=this._rBlock,this._rBlock=g,t.call(this,1,1431655765),e.call(this,8,16711935),e.call(this,2,858993459),t.call(this,16,65535),t.call(this,4,252645135),r[i]=this._lBlock,r[i+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});r.DES=s._createHelper(l);var g=o.TripleDES=s.extend({_doReset:function(){var t=this._key.words;this._des1=l.createEncryptor(n.create(t.slice(0,2))),this._des2=l.createEncryptor(n.create(t.slice(2,4))),this._des3=l.createEncryptor(n.create(t.slice(4,6)))},encryptBlock:function(t,e){this._des1.encryptBlock(t,e),this._des2.decryptBlock(t,e),this._des3.encryptBlock(t,e)},decryptBlock:function(t,e){this._des3.decryptBlock(t,e),this._des2.encryptBlock(t,e),this._des1.decryptBlock(t,e)},keySize:6,ivSize:2,blockSize:2});r.TripleDES=s._createHelper(g)}(),function(){var t=T,e=t.lib.WordArray;t.enc.Base64={stringify:function(t){var e=t.words,r=t.sigBytes,i=this._map;t.clamp();for(var n=[],s=0;s<r;s+=3)for(var o=(e[s>>>2]>>>24-s%4*8&255)<<16|(e[s+1>>>2]>>>24-(s+1)%4*8&255)<<8|e[s+2>>>2]>>>24-(s+2)%4*8&255,a=0;a<4&&s+.75*a<r;a++)n.push(i.charAt(o>>>6*(3-a)&63));var h=i.charAt(64);if(h)for(;n.length%4;)n.push(h);return n.join("")},parse:function(t){var r=t.length,i=this._map,n=i.charAt(64);if(n){var s=t.indexOf(n);-1!=s&&(r=s)}for(var o=[],a=0,h=0;h<r;h++)if(h%4){var u=i.indexOf(t.charAt(h-1))<<h%4*2,c=i.indexOf(t.charAt(h))>>>6-h%4*2;o[a>>>2]|=(u|c)<<24-a%4*8,a++}return e.create(o,a)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}();var C=t.prototype;t.prototype.am=function(t,e,r,i,n,s){for(;--s>=0;){var o=e*this[t++]+r[i]+n;n=Math.floor(o/67108864),r[i++]=67108863&o}return n},t.prototype.DB=26,t.prototype.DM=67108863;var I=t.prototype.DV=1<<26;t.prototype.FV=Math.pow(2,52),t.prototype.F1=26,t.prototype.F2=0;var K,O,U="0123456789abcdefghijklmnopqrstuvwxyz",H=new Array;for(K="0".charCodeAt(0),O=0;O<=9;++O)H[K++]=O;for(K="a".charCodeAt(0),O=10;O<36;++O)H[K++]=O;for(K="A".charCodeAt(0),O=10;O<36;++O)H[K++]=O;o.prototype.convert=function(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t},o.prototype.revert=function(t){return t},o.prototype.reduce=function(t){t.divRemTo(this.m,null,t)},o.prototype.mulTo=function(t,e,r){t.multiplyTo(e,r),this.reduce(r)},o.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},a.prototype.convert=function(e){var r=new t;return e.abs().dlShiftTo(this.m.t,r),r.divRemTo(this.m,null,r),e.s<0&&r.compareTo(t.ZERO)>0&&this.m.subTo(r,r),r},a.prototype.revert=function(e){var r=new t;return e.copyTo(r),this.reduce(r),r},a.prototype.reduce=function(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=32767&t[e],i=r*this.mpl+((r*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(t[r=e+this.m.t]+=this.m.am(0,i,t,e,0,this.m.t);t[r]>=t.DV;)t[r]-=t.DV,t[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)},a.prototype.mulTo=function(t,e,r){t.multiplyTo(e,r),this.reduce(r)},a.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},C.copyTo=function(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s},C.fromInt=function(t){this.t=1,this.s=t<0?-1:0,t>0?this[0]=t:t<-1?this[0]=t+I:this.t=0},C.fromString=function(e,i){var n,s=this;if(16==i)n=4;else if(8==i)n=3;else if(256==i)n=8;else if(2==i)n=1;else if(32==i)n=5;else{if(4!=i)return void s.fromRadix(e,i);n=2}s.t=0,s.s=0;for(var o=e.length,a=!1,h=0;--o>=0;){var u=8==n?255&e[o]:r(e,o);u<0?"-"==e.charAt(o)&&(a=!0):(a=!1,0==h?s[s.t++]=u:h+n>s.DB?(s[s.t-1]|=(u&(1<<s.DB-h)-1)<<h,s[s.t++]=u>>s.DB-h):s[s.t-1]|=u<<h,(h+=n)>=s.DB&&(h-=s.DB))}8==n&&0!=(128&e[0])&&(s.s=-1,h>0&&(s[s.t-1]|=(1<<s.DB-h)-1<<h)),s.clamp(),a&&t.ZERO.subTo(s,s)},C.clamp=function(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t},C.dlShiftTo=function(t,e){var r;for(r=this.t-1;r>=0;--r)e[r+t]=this[r];for(r=t-1;r>=0;--r)e[r]=0;e.t=this.t+t,e.s=this.s},C.drShiftTo=function(t,e){for(var r=t;r<this.t;++r)e[r-t]=this[r];e.t=Math.max(this.t-t,0),e.s=this.s},C.lShiftTo=function(t,e){var r,i=this,n=t%i.DB,s=i.DB-n,o=(1<<s)-1,a=Math.floor(t/i.DB),h=i.s<<n&i.DM;for(r=i.t-1;r>=0;--r)e[r+a+1]=i[r]>>s|h,h=(i[r]&o)<<n;for(r=a-1;r>=0;--r)e[r]=0;e[a]=h,e.t=i.t+a+1,e.s=i.s,e.clamp()},C.rShiftTo=function(t,e){var r=this;e.s=r.s;var i=Math.floor(t/r.DB);if(i>=r.t)e.t=0;else{var n=t%r.DB,s=r.DB-n,o=(1<<n)-1;e[0]=r[i]>>n;for(var a=i+1;a<r.t;++a)e[a-i-1]|=(r[a]&o)<<s,e[a-i]=r[a]>>n;n>0&&(e[r.t-i-1]|=(r.s&o)<<s),e.t=r.t-i,e.clamp()}},C.subTo=function(t,e){for(var r=this,i=0,n=0,s=Math.min(t.t,r.t);i<s;)n+=r[i]-t[i],e[i++]=n&r.DM,n>>=r.DB;if(t.t<r.t){for(n-=t.s;i<r.t;)n+=r[i],e[i++]=n&r.DM,n>>=r.DB;n+=r.s}else{for(n+=r.s;i<t.t;)n-=t[i],e[i++]=n&r.DM,n>>=r.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e[i++]=r.DV+n:n>0&&(e[i++]=n),e.t=i,e.clamp()},C.multiplyTo=function(e,r){var i=this.abs(),n=e.abs(),s=i.t;for(r.t=s+n.t;--s>=0;)r[s]=0;for(s=0;s<n.t;++s)r[s+i.t]=i.am(0,n[s],r,s,0,i.t);r.s=0,r.clamp(),this.s!=e.s&&t.ZERO.subTo(r,r)},C.squareTo=function(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t[r]=0;for(r=0;r<e.t-1;++r){var i=e.am(r,e[r],t,2*r,0,1);(t[r+e.t]+=e.am(r+1,2*e[r],t,2*r+1,i,e.t-r-1))>=e.DV&&(t[r+e.t]-=e.DV,t[r+e.t+1]=1)}t.t>0&&(t[t.t-1]+=e.am(r,e[r],t,2*r,0,1)),t.s=0,t.clamp()},C.divRemTo=function(e,r,i){var n=this,o=e.abs();if(!(o.t<=0)){var a=n.abs();if(a.t<o.t)return null!=r&&r.fromInt(0),void(null!=i&&n.copyTo(i));null==i&&(i=new t);var h=new t,u=n.s,c=e.s,f=n.DB-s(o[o.t-1]);f>0?(o.lShiftTo(f,h),a.lShiftTo(f,i)):(o.copyTo(h),a.copyTo(i));var l=h.t,g=h[l-1];if(0!=g){var p=g*(1<<n.F1)+(l>1?h[l-2]>>n.F2:0),d=n.FV/p,F=(1<<n.F1)/p,v=1<<n.F2,y=i.t,m=y-l,b=null==r?new t:r;for(h.dlShiftTo(m,b),i.compareTo(b)>=0&&(i[i.t++]=1,i.subTo(b,i)),t.ONE.dlShiftTo(l,b),b.subTo(h,h);h.t<l;)h[h.t++]=0;for(;--m>=0;){var A=i[--y]==g?n.DM:Math.floor(i[y]*d+(i[y-1]+v)*F);if((i[y]+=h.am(0,A,i,m,0,l))<A)for(h.dlShiftTo(m,b),i.subTo(b,i);i[y]<--A;)i.subTo(b,i)}null!=r&&(i.drShiftTo(l,r),u!=c&&t.ZERO.subTo(r,r)),i.t=l,i.clamp(),f>0&&i.rShiftTo(f,i),u<0&&t.ZERO.subTo(i,i)}}},C.invDigit=function(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var e=3&t;return e=e*(2-(15&t)*e)&15,e=e*(2-(255&t)*e)&255,e=e*(2-((65535&t)*e&65535))&65535,(e=e*(2-t*e%this.DV)%this.DV)>0?this.DV-e:-e},C.isEven=function(){return 0==(this.t>0?1&this[0]:this.s)},C.exp=function(e,r){if(e>4294967295||e<1)return t.ONE;var i=new t,n=new t,o=r.convert(this),a=s(e)-1;for(o.copyTo(i);--a>=0;)if(r.sqrTo(i,n),(e&1<<a)>0)r.mulTo(n,o,i);else{var h=i;i=n,n=h}return r.revert(i)},C.toString=function(t){var r=this;if(r.s<0)return"-"+r.negate().toString(t);var i;if(16==t)i=4;else if(8==t)i=3;else if(2==t)i=1;else if(32==t)i=5;else{if(4!=t)return r.toRadix(t);i=2}var n,s=(1<<i)-1,o=!1,a="",h=r.t,u=r.DB-h*r.DB%i;if(h-- >0)for(u<r.DB&&(n=r[h]>>u)>0&&(o=!0,a=e(n));h>=0;)u<i?(n=(r[h]&(1<<u)-1)<<i-u,n|=r[--h]>>(u+=r.DB-i)):(n=r[h]>>(u-=i)&s,u<=0&&(u+=r.DB,--h)),n>0&&(o=!0),o&&(a+=e(n));return o?a:"0"},C.negate=function(){var e=new t;return t.ZERO.subTo(this,e),e},C.abs=function(){return this.s<0?this.negate():this},C.compareTo=function(t){var e=this.s-t.s;if(0!=e)return e;var r=this.t;if(0!=(e=r-t.t))return this.s<0?-e:e;for(;--r>=0;)if(0!=(e=this[r]-t[r]))return e;return 0},C.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+s(this[this.t-1]^this.s&this.DM)},C.byteLength=function(){return this.bitLength()>>3},C.mod=function(e){var r=new t;return this.abs().divRemTo(e,null,r),this.s<0&&r.compareTo(t.ZERO)>0&&e.subTo(r,r),r},C.modPowInt=function(t,e){var r;return r=t<256||e.isEven()?new o(e):new a(e),this.exp(t,r)},t.ZERO=n(0),t.ONE=n(1),p.prototype.convert=d,p.prototype.revert=d,p.prototype.mulTo=function(t,e,r){t.multiplyTo(e,r)},p.prototype.sqrTo=function(t,e){t.squareTo(e)},F.prototype.convert=function(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var r=new t;return e.copyTo(r),this.reduce(r),r},F.prototype.revert=function(t){return t},F.prototype.reduce=function(t){var e=this;for(t.drShiftTo(e.m.t-1,e.r2),t.t>e.m.t+1&&(t.t=e.m.t+1,t.clamp()),e.mu.multiplyUpperTo(e.r2,e.m.t+1,e.q3),e.m.multiplyLowerTo(e.q3,e.m.t+1,e.r2);t.compareTo(e.r2)<0;)t.dAddOffset(1,e.m.t+1);for(t.subTo(e.r2,t);t.compareTo(e.m)>=0;)t.subTo(e.m,t)},F.prototype.mulTo=function(t,e,r){t.multiplyTo(e,r),this.reduce(r)},F.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)};var N=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],k=(1<<26)/N[N.length-1];C.chunkSize=function(t){return Math.floor(Math.LN2*this.DB/Math.log(t))},C.toRadix=function(e){if(null==e&&(e=10),0==this.signum()||e<2||e>36)return"0";var r=this.chunkSize(e),i=Math.pow(e,r),s=n(i),o=new t,a=new t,h="";for(this.divRemTo(s,o,a);o.signum()>0;)h=(i+a.intValue()).toString(e).substr(1)+h,o.divRemTo(s,o,a);return a.intValue().toString(e)+h},C.fromRadix=function(e,i){var n=this;n.fromInt(0),null==i&&(i=10);for(var s=n.chunkSize(i),o=Math.pow(i,s),a=!1,h=0,u=0,c=0;c<e.length;++c){var f=r(e,c);f<0?"-"==e.charAt(c)&&0==n.signum()&&(a=!0):(u=i*u+f,++h>=s&&(n.dMultiply(o),n.dAddOffset(u,0),h=0,u=0))}h>0&&(n.dMultiply(Math.pow(i,h)),n.dAddOffset(u,0)),a&&t.ZERO.subTo(n,n)},C.fromNumber=function(e,r,i){var n=this;if("number"==typeof r)if(e<2)n.fromInt(1);else for(n.fromNumber(e,i),n.testBit(e-1)||n.bitwiseTo(t.ONE.shiftLeft(e-1),u,n),n.isEven()&&n.dAddOffset(1,0);!n.isProbablePrime(r);)n.dAddOffset(2,0),n.bitLength()>e&&n.subTo(t.ONE.shiftLeft(e-1),n);else{var s=new Array,o=7&e;s.length=1+(e>>3),r.nextBytes(s),o>0?s[0]&=(1<<o)-1:s[0]=0,n.fromString(s,256)}},C.bitwiseTo=function(t,e,r){var i,n,s=this,o=Math.min(t.t,s.t);for(i=0;i<o;++i)r[i]=e(s[i],t[i]);if(t.t<s.t){for(n=t.s&s.DM,i=o;i<s.t;++i)r[i]=e(s[i],n);r.t=s.t}else{for(n=s.s&s.DM,i=o;i<t.t;++i)r[i]=e(n,t[i]);r.t=t.t}r.s=e(s.s,t.s),r.clamp()},C.changeBit=function(e,r){var i=t.ONE.shiftLeft(e);return this.bitwiseTo(i,r,i),i},C.addTo=function(t,e){for(var r=this,i=0,n=0,s=Math.min(t.t,r.t);i<s;)n+=r[i]+t[i],e[i++]=n&r.DM,n>>=r.DB;if(t.t<r.t){for(n+=t.s;i<r.t;)n+=r[i],e[i++]=n&r.DM,n>>=r.DB;n+=r.s}else{for(n+=r.s;i<t.t;)n+=t[i],e[i++]=n&r.DM,n>>=r.DB;n+=t.s}e.s=n<0?-1:0,n>0?e[i++]=n:n<-1&&(e[i++]=r.DV+n),e.t=i,e.clamp()},C.dMultiply=function(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()},C.dAddOffset=function(t,e){if(0!=t){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}},C.multiplyLowerTo=function(t,e,r){var i=Math.min(this.t+t.t,e);for(r.s=0,r.t=i;i>0;)r[--i]=0;var n;for(n=r.t-this.t;i<n;++i)r[i+this.t]=this.am(0,t[i],r,i,0,this.t);for(n=Math.min(t.t,e);i<n;++i)this.am(0,t[i],r,i,0,e-i);r.clamp()},C.multiplyUpperTo=function(t,e,r){--e;var i=r.t=this.t+t.t-e;for(r.s=0;--i>=0;)r[i]=0;for(i=Math.max(e-this.t,0);i<t.t;++i)r[this.t+i-e]=this.am(e-i,t[i],r,0,0,this.t+i-e);r.clamp(),r.drShiftTo(1,r)},C.modInt=function(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(0==e)r=this[0]%t;else for(var i=this.t-1;i>=0;--i)r=(e*r+this[i])%t;return r},C.millerRabin=function(e){var r=this.subtract(t.ONE),i=r.getLowestSetBit();if(i<=0)return!1;var n=r.shiftRight(i);(e=e+1>>1)>N.length&&(e=N.length);for(var s=new t(null),o=[],a=0;a<e;++a){for(;u=N[Math.floor(Math.random()*N.length)],-1!=o.indexOf(u););o.push(u),s.fromInt(u);var h=s.modPow(n,this);if(0!=h.compareTo(t.ONE)&&0!=h.compareTo(r)){for(var u=1;u++<i&&0!=h.compareTo(r);)if(0==(h=h.modPowInt(2,this)).compareTo(t.ONE))return!1;if(0!=h.compareTo(r))return!1}}return!0},C.clone=function(){var e=new t;return this.copyTo(e),e},C.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},C.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},C.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},C.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},C.toByteArray=function(){var t=this,e=t.t,r=new Array;r[0]=t.s;var i,n=t.DB-e*t.DB%8,s=0;if(e-- >0)for(n<t.DB&&(i=t[e]>>n)!=(t.s&t.DM)>>n&&(r[s++]=i|t.s<<t.DB-n);e>=0;)n<8?(i=(t[e]&(1<<n)-1)<<8-n,i|=t[--e]>>(n+=t.DB-8)):(i=t[e]>>(n-=8)&255,n<=0&&(n+=t.DB,--e)),0!=(128&i)&&(i|=-256),0===s&&(128&t.s)!=(128&i)&&++s,(s>0||i!=t.s)&&(r[s++]=i);return r},C.toByteArraySigned=function(){return R.util.Hex.toUnsignBytes(this.toByteArray())},t.fromByteArrayUnsigned=function(e){if(void 0!=e&&Array.isArray(e))return new t(R.util.Hex.stringify(e),16)},C.equals=function(t){return 0==this.compareTo(t)},C.min=function(t){return this.compareTo(t)<0?this:t},C.max=function(t){return this.compareTo(t)>0?this:t},C.and=function(e){var r=new t;return this.bitwiseTo(e,h,r),r},C.or=function(e){var r=new t;return this.bitwiseTo(e,u,r),r},C.xor=function(e){var r=new t;return this.bitwiseTo(e,c,r),r},C.andNot=function(e){var r=new t;return this.bitwiseTo(e,f,r),r},C.not=function(){for(var e=new t,r=0;r<this.t;++r)e[r]=this.DM&~this[r];return e.t=this.t,e.s=~this.s,e},C.shiftLeft=function(e){var r=new t;return e<0?this.rShiftTo(-e,r):this.lShiftTo(e,r),r},C.shiftRight=function(e){var r=new t;return e<0?this.lShiftTo(-e,r):this.rShiftTo(e,r),r},C.getLowestSetBit=function(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+l(this[t]);return this.s<0?this.t*this.DB:-1},C.bitCount=function(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=g(this[r]^e);return t},C.testBit=function(t){var e=Math.floor(t/this.DB);return e>=this.t?0!=this.s:0!=(this[e]&1<<t%this.DB)},C.setBit=function(t){return this.changeBit(t,u)},C.clearBit=function(t){return this.changeBit(t,f)},C.flipBit=function(t){return this.changeBit(t,c)},C.add=function(e){var r=new t;return this.addTo(e,r),r},C.subtract=function(e){var r=new t;return this.subTo(e,r),r},C.multiply=function(e){var r=new t;return this.multiplyTo(e,r),r},C.divide=function(e){var r=new t;return this.divRemTo(e,r,null),r},C.remainder=function(e){var r=new t;return this.divRemTo(e,null,r),r},C.divideAndRemainder=function(e){var r=new t,i=new t;return this.divRemTo(e,r,i),new Array(r,i)},C.modPow=function(e,r){var i,h,u=e.bitLength(),c=n(1);if(u<=0)return c;i=u<18?1:u<48?3:u<144?4:u<768?5:6,h=u<8?new o(r):r.isEven()?new F(r):new a(r);var f=new Array,l=3,g=i-1,p=(1<<i)-1;if(f[1]=h.convert(this),i>1){var d=new t;for(h.sqrTo(f[1],d);l<=p;)f[l]=new t,h.mulTo(d,f[l-2],f[l]),l+=2}var v,y,m=e.t-1,b=!0,A=new t;for(u=s(e[m])-1;m>=0;){for(u>=g?v=e[m]>>u-g&p:(v=(e[m]&(1<<u+1)-1)<<g-u,m>0&&(v|=e[m-1]>>this.DB+u-g)),l=i;0==(1&v);)v>>=1,--l;if((u-=l)<0&&(u+=this.DB,--m),b)f[v].copyTo(c),b=!1;else{for(;l>1;)h.sqrTo(c,A),h.sqrTo(A,c),l-=2;l>0?h.sqrTo(c,A):(y=c,c=A,A=y),h.mulTo(A,f[v],c)}for(;m>=0&&0==(e[m]&1<<u);)h.sqrTo(c,A),y=c,c=A,A=y,--u<0&&(u=this.DB-1,--m)}return h.revert(c)},C.modInverse=function(e){var r=e.isEven();if(0===this.signum())throw new Error("division by zero");if(this.isEven()&&r||0==e.signum())return t.ZERO;for(var i=e.clone(),s=this.clone(),o=n(1),a=n(0),h=n(0),u=n(1);0!=i.signum();){for(;i.isEven();)i.rShiftTo(1,i),r?(o.isEven()&&a.isEven()||(o.addTo(this,o),a.subTo(e,a)),o.rShiftTo(1,o)):a.isEven()||a.subTo(e,a),a.rShiftTo(1,a);for(;s.isEven();)s.rShiftTo(1,s),r?(h.isEven()&&u.isEven()||(h.addTo(this,h),u.subTo(e,u)),h.rShiftTo(1,h)):u.isEven()||u.subTo(e,u),u.rShiftTo(1,u);i.compareTo(s)>=0?(i.subTo(s,i),r&&o.subTo(h,o),a.subTo(u,a)):(s.subTo(i,s),r&&h.subTo(o,h),u.subTo(a,u))}if(0!=s.compareTo(t.ONE))return t.ZERO;for(;u.compareTo(e)>=0;)u.subTo(e,u);for(;u.signum()<0;)u.addTo(e,u);return u},C.pow=function(t){return this.exp(t,new p)},C.gcd=function(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var i=e;e=r,r=i}var n=e.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return e;for(n<s&&(s=n),s>0&&(e.rShiftTo(s,e),r.rShiftTo(s,r));e.signum()>0;)(n=e.getLowestSetBit())>0&&e.rShiftTo(n,e),(n=r.getLowestSetBit())>0&&r.rShiftTo(n,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r},C.isProbablePrime=function(t){var e,r=this.abs();if(1==r.t&&r[0]<=N[N.length-1]){for(e=0;e<N.length;++e)if(r[0]==N[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<N.length;){for(var i=N[e],n=e+1;n<N.length&&i<k;)i*=N[n++];for(i=r.modInt(i);e<n;)if(i%N[e++]==0)return!1}return r.millerRabin(t)},C.square=function(){var e=new t;return this.squareTo(e),e},y.prototype.init=function(t){var e,r,i;for(e=0;e<256;++e)this.S[e]=e;for(r=0,e=0;e<256;++e)r=r+this.S[e]+t[e%t.length]&255,i=this.S[e],this.S[e]=this.S[r],this.S[r]=i;this.i=0,this.j=0},y.prototype.next=function(){var t;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,t=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=t,this.S[t+this.S[this.i]&255]};var M,P,J,_=256;if(null==P){P=new Array(32),J=0;var L;for(L=0;L<32;++L)P[J++]=255&Math.random(10);for(;J<_;)L=Math.floor(65536*Math.random()),P[J++]=L>>>8,P[J++]=255&L;J=0,A()}return E.prototype.nextBytes=function(t){var e;for(e=0;e<t.length;++e)t[e]=S()},"undefined"!=typeof KJUR&&KJUR||(KJUR={}),void 0!==KJUR.crypto&&KJUR.crypto||(KJUR.crypto={}),KJUR.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",sm3:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"},this.CRYPTOJSMESSAGEDIGESTNAME={md5:"CryptoJS.algo.MD5",sha1:"CryptoJS.algo.SHA1",sha224:"CryptoJS.algo.SHA224",sha256:"CryptoJS.algo.SHA256",sha384:"CryptoJS.algo.SHA384",sha512:"CryptoJS.algo.SHA512",ripemd160:"CryptoJS.algo.RIPEMD160",sm3:"CryptoJS.algo.SM3"},this.getDigestInfoHex=function(t,e){if(void 0===this.DIGESTINFOHEAD[e])throw"alg not supported in Util.DIGESTINFOHEAD: "+e;return this.DIGESTINFOHEAD[e]+t},this.getPaddedDigestInfoHex=function(t,e,r){var i=this.getDigestInfoHex(t,e),n=r/4;if(i.length+22>n)throw"key is too short for SigAlg: keylen="+r+","+e;for(var s="00"+i,o="",a=n-"0001".length-s.length,h=0;h<a;h+=2)o+="ff";return"0001"+o+s},this.hashString=function(t,e){return new KJUR.crypto.MessageDigest({alg:e}).digestString(t)},this.hashHex=function(t,e){return new KJUR.crypto.MessageDigest({alg:e}).digestHex(t)},this.sha1=function(t){return new KJUR.crypto.MessageDigest({alg:"sha1",prov:"cryptojs"}).digestString(t)},this.sha256=function(t){return new KJUR.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"}).digestString(t)},this.sha256Hex=function(t){return new KJUR.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"}).digestHex(t)},this.sha512=function(t){return new KJUR.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"}).digestString(t)},this.sha512Hex=function(t){return new KJUR.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"}).digestHex(t)},this.md5=function(t){return new KJUR.crypto.MessageDigest({alg:"md5",prov:"cryptojs"}).digestString(t)},this.ripemd160=function(t){return new KJUR.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"}).digestString(t)},this.getCryptoJSMDByName=function(t){}},KJUR.crypto.MessageDigest=function(t){this.setAlgAndProvider=function(t,e){if(null!=t&&void 0===e&&(e=KJUR.crypto.Util.DEFAULTPROVIDER[t]),-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:sm3:".indexOf(t)&&"cryptojs"==e){try{this.md=KJUR.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[t].create()}catch(e){throw"setAlgAndProvider hash alg set fail alg="+t+"/"+e}this.updateString=function(t){this.md.update(t)},this.updateHex=function(t){var e=T.enc.Hex.parse(t);this.md.update(e)},this.digest=function(){return this.md.finalize().toString(T.enc.Hex)},this.digestString=function(t){return this.updateString(t),this.digest()},this.digestHex=function(t){return this.updateHex(t),this.digest()}}if(-1!=":sha256:".indexOf(t)&&"sjcl"==e){try{this.md=new sjcl.hash.sha256}catch(e){throw"setAlgAndProvider hash alg set fail alg="+t+"/"+e}this.updateString=function(t){this.md.update(t)},this.updateHex=function(t){var e=sjcl.codec.hex.toBits(t);this.md.update(e)},this.digest=function(){var t=this.md.finalize();return sjcl.codec.hex.fromBits(t)},this.digestString=function(t){return this.updateString(t),this.digest()},this.digestHex=function(t){return this.updateHex(t),this.digest()}}},this.updateString=function(t){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(t){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestString=function(t){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(t){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},void 0!==t&&void 0!==t.alg&&(this.algName=t.alg,void 0===t.prov&&(this.provName=KJUR.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))},KJUR.crypto.Mac=function(t){this.setAlgAndProvider=function(t,e){if(null==t&&(t="hmacsha1"),"hmac"!=(t=t.toLowerCase()).substr(0,4))throw"setAlgAndProvider unsupported HMAC alg: "+t;void 0===e&&(e=KJUR.crypto.Util.DEFAULTPROVIDER[t]),this.algProv=t+"/"+e;var r=t.substr(4);if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(r)&&"cryptojs"==e){try{var i=KJUR.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[r];this.mac=T.algo.HMAC.create(i,this.pass)}catch(t){throw"setAlgAndProvider hash alg set fail hashAlg="+r+"/"+t}this.updateString=function(t){this.mac.update(t)},this.updateHex=function(t){var e=T.enc.Hex.parse(t);this.mac.update(e)},this.doFinal=function(){return this.mac.finalize().toString(T.enc.Hex)},this.doFinalString=function(t){return this.updateString(t),this.doFinal()},this.doFinalHex=function(t){return this.updateHex(t),this.doFinal()}}},this.updateString=function(t){throw"updateString(str) not supported for this alg/prov: "+this.algProv},this.updateHex=function(t){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv},this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv},this.doFinalString=function(t){throw"digestString(str) not supported for this alg/prov: "+this.algProv},this.doFinalHex=function(t){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv},void 0!==t&&(void 0!==t.pass&&(this.pass=t.pass),void 0!==t.alg&&(this.algName=t.alg,void 0===t.prov&&(this.provName=KJUR.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName)))},KJUR.crypto.Signature=function(e){var r=null;if(this._setAlgNames=function(){this.algName.match(/^(.+)with(.+)$/)&&(this.mdAlgName=RegExp.$1.toLowerCase(),this.pubkeyAlgName=RegExp.$2.toLowerCase())},this._zeroPaddingOfSignature=function(t,e){for(var r="",i=e/4-t.length,n=0;n<i;n++)r+="0";return r+t},this.setAlgAndProvider=function(e,r){if(this._setAlgNames(),"cryptojs/jsrsa"!=r)throw"provider not supported: "+r;if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:sm3:".indexOf(this.mdAlgName)){try{this.md=new KJUR.crypto.MessageDigest({alg:this.mdAlgName})}catch(t){throw"setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+t}this.init=function(t,e){var r=null;try{r=void 0===e?KEYUTIL.getKey(t):KEYUTIL.getKey(t,e)}catch(t){throw"init failed:"+t}if(!0===r.isPrivate)this.prvKey=r,this.state="SIGN";else{if(!0!==r.isPublic)throw"init failed.:"+r;this.pubKey=r,this.state="VERIFY"}},this.initSign=function(t){"string"==typeof t.ecprvhex&&"string"==typeof t.eccurvename?(this.ecprvhex=t.ecprvhex,this.eccurvename=t.eccurvename):this.prvKey=t,this.state="SIGN"},this.initVerifyByPublicKey=function(t){"string"==typeof t.ecpubhex&&"string"==typeof t.eccurvename?(this.ecpubhex=t.ecpubhex,this.eccurvename=t.eccurvename):t instanceof KJUR.crypto.ECDSA?this.pubKey=t:t instanceof RSAKey&&(this.pubKey=t),this.state="VERIFY"},this.initVerifyByCertificatePEM=function(t){var e=new X509;e.readCertPEM(t),this.pubKey=e.subjectPublicKeyRSA,this.state="VERIFY"},this.updateString=function(t){this.md.updateString(t)},this.updateHex=function(t){this.md.updateHex(t)},this.sign=function(){if("sm2"!=this.eccurvename&&(this.sHashHex=this.md.digest()),void 0!==this.ecprvhex&&void 0!==this.eccurvename)if("sm2"==this.eccurvename){var e=(c=new KJUR.crypto.SM3withSM2({curve:this.eccurvename})).ecparams.G,r=e.multiply(new t(this.ecprvhex,16)),i=r.getX().toBigInteger().toRadix(16)+r.getY().toBigInteger().toRadix(16),n=new D,s=(new D).GetZ(e,i),o=n.GetWords(n.GetHex(s).toString()),a=T.enc.Utf8.stringify(this.md.md._data);a=T.enc.Utf8.parse(a).toString(),a=n.GetWords(a);var h=new Array(n.GetDigestSize());n.BlockUpdate(o,0,o.length),n.BlockUpdate(a,0,a.length),n.DoFinal(h,0);var u=n.GetHex(h).toString();this.sHashHex=u,this.hSign=c.signHex(this.sHashHex,this.ecprvhex)}else{var c=new KJUR.crypto.ECDSA({curve:this.eccurvename});this.hSign=c.signHex(this.sHashHex,this.ecprvhex)}else if("rsaandmgf1"==this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if("rsa"==this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else if(this.prvKey instanceof KJUR.crypto.ECDSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else{if(!(this.prvKey instanceof KJUR.crypto.DSA))throw"Signature: unsupported public key alg: "+this.pubkeyAlgName;this.hSign=this.prvKey.signWithMessageHash(this.sHashHex)}return this.hSign},this.signString=function(t){this.updateString(t),this.sign()},this.signHex=function(t){this.updateHex(t),this.sign()},this.verify=function(t){if("sm2"!=this.eccurvename&&(this.sHashHex=this.md.digest()),void 0!==this.ecpubhex&&void 0!==this.eccurvename){if("sm2"==this.eccurvename){var e=(u=new KJUR.crypto.SM3withSM2({curve:this.eccurvename})).ecparams.G,r=this.ecpubhex.substr(2,128),i=new D,n=(new D).GetZ(e,r),s=i.GetWords(i.GetHex(n).toString()),o=T.enc.Utf8.stringify(this.md.md._data);o=T.enc.Utf8.parse(o).toString(),o=i.GetWords(o);var a=new Array(i.GetDigestSize());i.BlockUpdate(s,0,s.length),i.BlockUpdate(o,0,o.length),i.DoFinal(a,0);var h=i.GetHex(a).toString();return this.sHashHex=h,u.verifyHex(this.sHashHex,t,this.ecpubhex)}var u=new KJUR.crypto.ECDSA({curve:this.eccurvename});return u.verifyHex(this.sHashHex,t,this.ecpubhex)}if("rsaandmgf1"==this.pubkeyAlgName)return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,t,this.mdAlgName,this.pssSaltLen);if("rsa"==this.pubkeyAlgName)return this.pubKey.verifyWithMessageHash(this.sHashHex,t);if(this.pubKey instanceof KJUR.crypto.ECDSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,t);if(this.pubKey instanceof KJUR.crypto.DSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,t);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}},this.init=function(t,e){throw"init(key, pass) not supported for this alg:prov="+this.algProvName},this.initVerifyByPublicKey=function(t){throw"initVerifyByPublicKey(rsaPubKeyy) not supported for this alg:prov="+this.algProvName},this.initVerifyByCertificatePEM=function(t){throw"initVerifyByCertificatePEM(certPEM) not supported for this alg:prov="+this.algProvName},this.initSign=function(t){throw"initSign(prvKey) not supported for this alg:prov="+this.algProvName},this.updateString=function(t){throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(t){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName},this.signString=function(t){throw"digestString(str) not supported for this alg:prov="+this.algProvName},this.signHex=function(t){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(t){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},this.initParams=e,void 0!==e&&(void 0!==e.alg&&(this.algName=e.alg,void 0===e.prov?this.provName=KJUR.crypto.Util.DEFAULTPROVIDER[this.algName]:this.provName=e.prov,this.algProvName=this.algName+":"+this.provName,this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),void 0!==e.psssaltlen&&(this.pssSaltLen=e.psssaltlen),void 0!==e.prvkeypem)){if(void 0!==e.prvkeypas)throw"both prvkeypem and prvkeypas parameters not supported";try{(r=new RSAKey).readPrivateKeyFromPEMString(e.prvkeypem),this.initSign(r)}catch(t){throw"fatal error to load pem private key: "+t}}},KJUR.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040023":"secp521r1","2b81040022":"secp384r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}},B.prototype.equals=function(t){return t==this||this.q.equals(t.q)&&this.x.equals(t.x)},B.prototype.toBigInteger=function(){return this.x},B.prototype.negate=function(){return new B(this.q,this.x.negate().mod(this.q))},B.prototype.add=function(t){return new B(this.q,this.x.add(t.toBigInteger()).mod(this.q))},B.prototype.subtract=function(t){return new B(this.q,this.x.subtract(t.toBigInteger()).mod(this.q))},B.prototype.multiply=function(t){return new B(this.q,this.x.multiply(t.toBigInteger()).mod(this.q))},B.prototype.square=function(){return new B(this.q,this.x.square().mod(this.q))},B.prototype.divide=function(t){return new B(this.q,this.x.multiply(t.toBigInteger().modInverse(this.q)).mod(this.q))},w.prototype.getX=function(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))},w.prototype.getY=function(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))},w.prototype.equals=function(e){if(e==this)return!0;if(this.isInfinity())return e.isInfinity();if(e.isInfinity())return this.isInfinity();return!!e.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(e.z)).mod(this.curve.q).equals(t.ZERO)&&e.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(e.z)).mod(this.curve.q).equals(t.ZERO)},w.prototype.isInfinity=function(){return null==this.x&&null==this.y||this.z.equals(t.ZERO)&&!this.y.toBigInteger().equals(t.ZERO)},w.prototype.negate=function(){return new w(this.curve,this.x,this.y.negate(),this.z)},w.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var r=e.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(e.z)).mod(this.curve.q),i=e.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(e.z)).mod(this.curve.q);if(t.ZERO.equals(i))return t.ZERO.equals(r)?this.twice():this.curve.getInfinity();var n=new t("3"),s=this.x.toBigInteger(),o=this.y.toBigInteger(),a=(e.x.toBigInteger(),e.y.toBigInteger(),i.square()),h=a.multiply(i),u=s.multiply(a),c=r.square().multiply(this.z),f=c.subtract(u.shiftLeft(1)).multiply(e.z).subtract(h).multiply(i).mod(this.curve.q),l=u.multiply(n).multiply(r).subtract(o.multiply(h)).subtract(c.multiply(r)).multiply(e.z).add(r.multiply(h)).mod(this.curve.q),g=h.multiply(this.z).multiply(e.z).mod(this.curve.q);return new w(this.curve,this.curve.fromBigInteger(f),this.curve.fromBigInteger(l),g)},w.prototype.twice=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var e=new t("3"),r=this.x.toBigInteger(),i=this.y.toBigInteger(),n=i.multiply(this.z),s=n.multiply(i).mod(this.curve.q),o=this.curve.a.toBigInteger(),a=r.square().multiply(e);t.ZERO.equals(o)||(a=a.add(this.z.square().multiply(o)));var h=(a=a.mod(this.curve.q)).square().subtract(r.shiftLeft(3).multiply(s)).shiftLeft(1).multiply(n).mod(this.curve.q),u=a.multiply(e).multiply(r).subtract(s.shiftLeft(1)).shiftLeft(2).multiply(s).subtract(a.square().multiply(a)).mod(this.curve.q),c=n.square().multiply(n).shiftLeft(3).mod(this.curve.q);return new w(this.curve,this.curve.fromBigInteger(h),this.curve.fromBigInteger(u),c)},w.prototype.multiply=function(e){if(this.isInfinity())return this;if(0==e.signum())return this.curve.getInfinity();var r,i=e,n=i.multiply(new t("3")),s=this.negate(),o=this;for(r=n.bitLength()-2;r>0;--r){o=o.twice();var a=n.testBit(r);a!=i.testBit(r)&&(o=o.add(a?this:s))}return o},w.prototype.multiplyTwo=function(t,e,r){var i;i=t.bitLength()>r.bitLength()?t.bitLength()-1:r.bitLength()-1;for(var n=this.curve.getInfinity(),s=this.add(e);i>=0;)n=n.twice(),t.testBit(i)?n=r.testBit(i)?n.add(s):n.add(this):r.testBit(i)&&(n=n.add(e)),--i;return n},x.prototype.getQ=function(){return this.q},x.prototype.getA=function(){return this.a},x.prototype.getB=function(){return this.b},x.prototype.equals=function(t){return t==this||this.q.equals(t.q)&&this.a.equals(t.a)&&this.b.equals(t.b)},x.prototype.getInfinity=function(){return this.infinity},x.prototype.fromBigInteger=function(t){return new B(this.q,t)},x.prototype.decodePointHex=function(e){switch(parseInt(e.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:return null;case 4:case 6:case 7:var r=(e.length-2)/2,i=e.substr(2,r),n=e.substr(r+2,r);return new w(this,this.fromBigInteger(new t(i,16)),this.fromBigInteger(new t(n,16)));default:return null}},B.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)},w.prototype.getEncoded=function(t){var e=function(t,e){var r=t.toByteArrayUnsigned();if(e<r.length)r=r.slice(r.length-e);else for(;e>r.length;)r.unshift(0);return r},r=this.getX().toBigInteger(),i=this.getY().toBigInteger(),n=e(r,32);return t?i.isEven()?n.unshift(2):n.unshift(3):(n.unshift(4),n=n.concat(e(i,32))),n},w.decodeFrom=function(e,r){r[0];var i=r.length-1,n=r.slice(1,1+i/2),s=r.slice(1+i/2,1+i);n.unshift(0),s.unshift(0);var o=new t(n),a=new t(s);return new w(e,e.fromBigInteger(o),e.fromBigInteger(a))},w.decodeFromHex=function(e,r){r.substr(0,2);var i=r.length-2,n=r.substr(2,i/2),s=r.substr(2+i/2,i/2),o=new t(n,16),a=new t(s,16);return new w(e,e.fromBigInteger(o),e.fromBigInteger(a))},w.prototype.add2D=function(t){if(this.isInfinity())return t;if(t.isInfinity())return this;if(this.x.equals(t.x))return this.y.equals(t.y)?this.twice():this.curve.getInfinity();var e=t.x.subtract(this.x),r=t.y.subtract(this.y).divide(e),i=r.square().subtract(this.x).subtract(t.x),n=r.multiply(this.x.subtract(i)).subtract(this.y);return new w(this.curve,i,n)},w.prototype.twice2D=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var e=this.curve.fromBigInteger(t.valueOf(2)),r=this.curve.fromBigInteger(t.valueOf(3)),i=this.x.square().multiply(r).add(this.curve.a).divide(this.y.multiply(e)),n=i.square().subtract(this.x.multiply(e)),s=i.multiply(this.x.subtract(n)).subtract(this.y);return new w(this.curve,n,s)},w.prototype.multiply2D=function(e){if(this.isInfinity())return this;if(0==e.signum())return this.curve.getInfinity();var r,i=e,n=i.multiply(new t("3")),s=this.negate(),o=this;for(r=n.bitLength()-2;r>0;--r){o=o.twice();var a=n.testBit(r);a!=i.testBit(r)&&(o=o.add2D(a?this:s))}return o},w.prototype.isOnCurve=function(){var t=this.getX().toBigInteger(),e=this.getY().toBigInteger(),r=this.curve.getA().toBigInteger(),i=this.curve.getB().toBigInteger(),n=this.curve.getQ(),s=e.multiply(e).mod(n),o=t.multiply(t).multiply(t).add(r.multiply(t)).add(i).mod(n);return s.equals(o)},w.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"},w.prototype.validate=function(){var e=this.curve.getQ();if(this.isInfinity())throw new Error("Point is at infinity.");var r=this.getX().toBigInteger(),i=this.getY().toBigInteger();if(r.compareTo(t.ONE)<0||r.compareTo(e.subtract(t.ONE))>0)throw new Error("x coordinate out of bounds");if(i.compareTo(t.ONE)<0||i.compareTo(e.subtract(t.ONE))>0)throw new Error("y coordinate out of bounds");if(!this.isOnCurve())throw new Error("Point is not on the curve.");if(this.multiply(e).isInfinity())throw new Error("Point is not a scalar multiple of G.");return!0},"undefined"!=typeof KJUR&&KJUR||(KJUR={}),void 0!==KJUR.crypto&&KJUR.crypto||(KJUR.crypto={}),KJUR.crypto.ECDSA=function(e){var r=new E;this.type="EC",this.getBigRandom=function(e){return new t(e.bitLength(),r).mod(e.subtract(t.ONE)).add(t.ONE)},this.setNamedCurve=function(t){this.ecparams=KJUR.crypto.ECParameterDB.getByName(t),this.prvKeyHex=null,this.pubKeyHex=null,this.curveName=t},this.setPrivateKeyHex=function(t){this.isPrivate=!0,this.prvKeyHex=t},this.setPublicKeyHex=function(t){this.isPublic=!0,this.pubKeyHex=t},this.generateKeyPairHex=function(){var t=this.ecparams.n,e=this.getBigRandom(t),r=this.ecparams.G.multiply(e),i=r.getX().toBigInteger(),n=r.getY().toBigInteger(),s=this.ecparams.keylen/4,o=("0000000000"+e.toString(16)).slice(-s),a="04"+("0000000000"+i.toString(16)).slice(-s)+("0000000000"+n.toString(16)).slice(-s);return this.setPrivateKeyHex(o),this.setPublicKeyHex(a),{ecprvhex:o,ecpubhex:a}},this.signWithMessageHash=function(t){return this.signHex(t,this.prvKeyHex)},this.signHex=function(e,r){var i=new t(r,16),n=this.ecparams.n,s=new t(e,16);do{var o=this.getBigRandom(n),a=this.ecparams.G.multiply(o).getX().toBigInteger().mod(n)}while(a.compareTo(t.ZERO)<=0);var h=o.modInverse(n).multiply(s.add(i.multiply(a))).mod(n);return KJUR.crypto.ECDSA.biRSSigToASN1Sig(a,h)},this.signWithoutHash=function(e,r){var i,n,s,o=t.fromByteArrayUnsigned(r),a=this.ecparams.n,h=t.fromByteArrayUnsigned(e);do{do{n=this.getBigRandom(a);var u=this.ecparams.G.multiply(n);i=(i=h.add(u.getX().toBigInteger())).mod(a)}while(0==i.compareTo(t.ZERO)||i.add(n).equals(a));var c=o.add(t.ONE).modInverse(a);s=i.multiply(o),s=(s=(s=n.subtract(s)).multiply(c)).mod(a)}while(0==s.compareTo(t.ZERO));return this.serializeSig(i,s)},this.getZForHash=function(t,e){var r=R.algorithm.SM3,i=(R.util.Hex,t.length<<3);t.unshift(255&i),t.unshift(i>>8&255),r.init(),r.update(t);var n=this.ecparams.curve,s=n.a.toBigInteger().toByteArraySigned();33==s.length&&s.shift();var o=n.b.toBigInteger().toByteArraySigned();33==o.length&&o.shift();var a=this.ecparams.G,h=a.getX().toBigInteger().toByteArraySigned();33==h.length&&h.shift();var u=a.getY().toBigInteger().toByteArraySigned();33==u.length&&u.shift(),r.update(s),r.update(o),r.update(h),r.update(u);var c=e.getX().toBigInteger().toByteArraySigned(),f=e.getY().toBigInteger().toByteArraySigned();return 33==c.length&&c.shift(),33==f.length&&f.shift(),r.update(c),r.update(f),r.doFinal()},this.sign=function(e,r){var i=R.algorithm.SM3,n=(R.util.Hex,[49,50,51,52,53,54,55,56,49,50,51,52,53,54,55,56]),s=this.ecparams.G,o=t.fromByteArrayUnsigned(r),a=this.getZForHash(n,s.multiply(o));i.init(),i.update(a),i.update(e);var h=i.doFinal();return this.signWithoutHash(h,r)},this.verifyWithMessageHash=function(t,e){return this.verifyHex(t,e,this.pubKeyHex)},this.verifyHex=function(e,r,i){var n,s,o=KJUR.crypto.ECDSA.parseSigHex(r);n=o.r,s=o.s;var a;a=w.decodeFromHex(this.ecparams.curve,i);var h=new t(e,16);return this.verifyRaw(h,n,s,a)},this.verifyWithoutHash=function(e,r,i){var n,s;if(Array.isArray(r)){var o=this.parseSig(r);n=o.r,s=o.s}else{if("object"!=typeof r||!r.r||!r.s)throw"Invalid value for signature";n=r.r,s=r.s}var a;if(i instanceof w)a=i;else{if(!Array.isArray(i))throw"Invalid format for pubkey value, must be byte array or ECPointFp";4!=i[0]&&i.unshift(4),a=w.decodeFrom(this.ecparams.curve,i)}var h=t.fromByteArrayUnsigned(e);return this.verifyRaw(h,n,s,a)},this.createPoint=function(t){var e=this.ecparams.curve;return"04"!=t.substr(0,2)&&(t="04"+t),w.decodeFromHex(e,t)},this.verify=function(t,e,r){var i=R.algorithm.SM3,n=[49,50,51,52,53,54,55,56,49,50,51,52,53,54,55,56],s=(this.ecparams.G,R.util.Hex),o=this.createPoint(s.encode(r)),a=this.getZForHash(n,o);i.init(),i.update(a),i.update(t);var h=i.doFinal();return this.verifyWithoutHash(h,e,r)},this.verifyRaw=function(e,r,i,n){var s=this.ecparams.n,o=this.ecparams.G;if(r.compareTo(t.ONE)<0||r.compareTo(s)>=0)return!1;if(i.compareTo(t.ONE)<0||i.compareTo(s)>=0)return!1;var a=r.add(i).mod(s);if(0==a.compareTo(t.ZERO))return!1;var h=o.multiply(i);return h=h.add(n.multiply(a)),e.add(h.getX().toBigInteger()).mod(s).equals(r)},this.serializeSig=function(t,e){var r=t.toByteArraySigned(),i=e.toByteArraySigned(),n=[];return n.push(2),n.push(r.length),(n=n.concat(r)).push(2),n.push(i.length),(n=n.concat(i)).unshift(n.length),n.unshift(48),n},this.parseSig=function(e){var r;if(48!=e[0])throw new Error("Signature not a valid DERSequence");if(r=2,2!=e[r])throw new Error("First element in signature must be a DERInteger");var i=e.slice(r+2,r+2+e[r+1]);if(r+=2+e[r+1],2!=e[r])throw new Error("Second element in signature must be a DERInteger");var n=e.slice(r+2,r+2+e[r+1]);return r+=2+e[r+1],{r:t.fromByteArrayUnsigned(i),s:t.fromByteArrayUnsigned(n)}},this.parseSigCompact=function(e){if(65!==e.length)throw"Signature has the wrong length";var r=e[0]-27;if(r<0||r>7)throw"Invalid signature type";var i=this.ecparams.n;return{r:t.fromByteArrayUnsigned(e.slice(1,33)).mod(i),s:t.fromByteArrayUnsigned(e.slice(33,65)).mod(i),i:r}},void 0!==e&&void 0!==e.curve&&(this.curveName=e.curve),void 0===this.curveName&&(this.curveName="secp256r1"),this.setNamedCurve(this.curveName),void 0!==e&&(void 0!==e.prv&&this.setPrivateKeyHex(e.prv),void 0!==e.pub&&this.setPublicKeyHex(e.pub))},KJUR.crypto.ECDSA.parseSigHex=function(e){var r=KJUR.crypto.ECDSA.parseSigHexInHexRS(e);return{r:new t(r.r,16),s:new t(r.s,16)}},KJUR.crypto.ECDSA.parseSigHexInHexRS=function(t){if("30"!=t.substr(0,2))throw"signature is not a ASN.1 sequence";var e=ASN1HEX.getPosArrayOfChildren_AtObj(t,0);if(2!=e.length)throw"number of signature ASN.1 sequence elements seem wrong";var r=e[0],i=e[1];if("02"!=t.substr(r,2))throw"1st item of sequene of signature is not ASN.1 integer";if("02"!=t.substr(i,2))throw"2nd item of sequene of signature is not ASN.1 integer";return{r:ASN1HEX.getHexOfV_AtObj(t,r),s:ASN1HEX.getHexOfV_AtObj(t,i)}},KJUR.crypto.ECDSA.asn1SigToConcatSig=function(t){var e=KJUR.crypto.ECDSA.parseSigHexInHexRS(t),r=e.r,i=e.s;if("00"==r.substr(0,2)&&r.length/2*8%128==8&&(r=r.substr(2)),"00"==i.substr(0,2)&&i.length/2*8%128==8&&(i=i.substr(2)),r.length/2*8%128!=0)throw"unknown ECDSA sig r length error";if(i.length/2*8%128!=0)throw"unknown ECDSA sig s length error";return r+i},KJUR.crypto.ECDSA.concatSigToASN1Sig=function(t){if(t.length/2*8%128!=0)throw"unknown ECDSA concatinated r-s sig  length error";var e=t.substr(0,t.length/2),r=t.substr(t.length/2);return KJUR.crypto.ECDSA.hexRSSigToASN1Sig(e,r)},KJUR.crypto.ECDSA.hexRSSigToASN1Sig=function(e,r){var i=new t(e,16),n=new t(r,16);return KJUR.crypto.ECDSA.biRSSigToASN1Sig(i,n)},KJUR.crypto.ECDSA.biRSSigToASN1Sig=function(t,e){var r=new KJUR.asn1.DERInteger({bigint:t}),i=new KJUR.asn1.DERInteger({bigint:e});return new KJUR.asn1.DERSequence({array:[r,i]}).getEncodedHex()},function(){var t=T,e=t.lib,r=e.WordArray,i=e.Hasher,n=[],s=t.algo.SM3=i.extend({_doReset:function(){this._hash=new r.init([1937774191,1226093241,388252375,3666478592,2842636476,372324522,3817729613,2969243214])},_doProcessBlock:function(t,e){for(var r=this._hash.words,i=r[0],s=r[1],o=r[2],a=r[3],h=r[4],u=0;u<80;u++){if(u<16)n[u]=0|t[e+u];else{var c=n[u-3]^n[u-8]^n[u-14]^n[u-16];n[u]=c<<1|c>>>31}var f=(i<<5|i>>>27)+h+n[u];f+=u<20?1518500249+(s&o|~s&a):u<40?1859775393+(s^o^a):u<60?(s&o|s&a|o&a)-1894007588:(s^o^a)-899497514,h=a,a=o,o=s<<30|s>>>2,s=i,i=f}r[0]=r[0]+i|0,r[1]=r[1]+s|0,r[2]=r[2]+o|0,r[3]=r[3]+a|0,r[4]=r[4]+h|0},_doFinalize:function(){var t=this._data,e=t.words,r=8*this._nDataBytes,i=8*t.sigBytes;return e[i>>>5]|=128<<24-i%32,e[14+(i+64>>>9<<4)]=Math.floor(r/4294967296),e[15+(i+64>>>9<<4)]=r,t.sigBytes=4*e.length,this._process(),this._hash},clone:function(){var t=i.clone.call(this);return t._hash=this._hash.clone(),t}});t.SM3=i._createHelper(s),t.HmacSM3=i._createHmacHelper(s)}(),D.prototype={Init:function(){this.xBuf=new Array(4),this.Reset()},InitDigest:function(t){this.xBuf=new Array(t.xBuf.length),Array.Copy(t.xBuf,0,this.xBuf,0,t.xBuf.length),this.xBufOff=t.xBufOff,this.byteCount=t.byteCount,Array.Copy(t.X,0,this.X,0,t.X.length),this.xOff=t.xOff,Array.Copy(t.v,0,this.v,0,t.v.length)},GetDigestSize:function(){return this.DIGEST_LENGTH},Reset:function(){this.byteCount=0,this.xBufOff=0,Array.Clear(this.xBuf,0,this.xBuf.length),Array.Copy(this.v0,0,this.v,0,this.v0.length),this.xOff=0,Array.Copy(this.X0,0,this.X,0,this.X0.length)},GetByteLength:function(){return this.BYTE_LENGTH},ProcessBlock:function(){var t,e=this.X,r=new Array(64);for(t=16;t<68;t++)e[t]=this.P1(e[t-16]^e[t-9]^this.ROTATE(e[t-3],15))^this.ROTATE(e[t-13],7)^e[t-6];for(t=0;t<64;t++)r[t]=e[t]^e[t+4];var i=this.v,n=this.v_;Array.Copy(i,0,n,0,this.v0.length);var s,o,a,h,u;for(t=0;t<16;t++)u=this.ROTATE(n[0],12),s=Int32.parse(Int32.parse(u+n[4])+this.ROTATE(this.T_00_15,t)),o=(s=this.ROTATE(s,7))^u,a=Int32.parse(Int32.parse(this.FF_00_15(n[0],n[1],n[2])+n[3])+o)+r[t],h=Int32.parse(Int32.parse(this.GG_00_15(n[4],n[5],n[6])+n[7])+s)+e[t],n[3]=n[2],n[2]=this.ROTATE(n[1],9),n[1]=n[0],n[0]=a,n[7]=n[6],n[6]=this.ROTATE(n[5],19),n[5]=n[4],n[4]=this.P0(h);for(t=16;t<64;t++)u=this.ROTATE(n[0],12),s=Int32.parse(Int32.parse(u+n[4])+this.ROTATE(this.T_16_63,t)),o=(s=this.ROTATE(s,7))^u,a=Int32.parse(Int32.parse(this.FF_16_63(n[0],n[1],n[2])+n[3])+o)+r[t],h=Int32.parse(Int32.parse(this.GG_16_63(n[4],n[5],n[6])+n[7])+s)+e[t],n[3]=n[2],n[2]=this.ROTATE(n[1],9),n[1]=n[0],n[0]=a,n[7]=n[6],n[6]=this.ROTATE(n[5],19),n[5]=n[4],n[4]=this.P0(h);for(t=0;t<8;t++)i[t]^=Int32.parse(n[t]);this.xOff=0,Array.Copy(this.X0,0,this.X,0,this.X0.length)},ProcessWord:function(t,e){var r=t[e]<<24;r|=(255&t[++e])<<16,r|=(255&t[++e])<<8,r|=255&t[++e],this.X[this.xOff]=r,16==++this.xOff&&this.ProcessBlock()},ProcessLength:function(t){this.xOff>14&&this.ProcessBlock(),this.X[14]=this.URShiftLong(t,32),this.X[15]=4294967295&t},IntToBigEndian:function(t,e,r){e[r]=Int32.parseByte(this.URShift(t,24)),e[++r]=Int32.parseByte(this.URShift(t,16)),e[++r]=Int32.parseByte(this.URShift(t,8)),e[++r]=Int32.parseByte(t)},DoFinal:function(t,e){this.Finish();for(var r=0;r<8;r++)this.IntToBigEndian(this.v[r],t,e+4*r);this.Reset();var i=t.length;for(r=0;r<i;r++)t[r]&=255;return this.DIGEST_LENGTH},Update:function(t){this.xBuf[this.xBufOff++]=t,this.xBufOff==this.xBuf.length&&(this.ProcessWord(this.xBuf,0),this.xBufOff=0),this.byteCount++},BlockUpdate:function(t,e,r){for(var i=0;i<r;i++)this.Update(t[i+e])},Finish:function(){var t=this.byteCount<<3;for(this.Update(128);0!=this.xBufOff;)this.Update(0);this.ProcessLength(t),this.ProcessBlock()},ROTATE:function(t,e){return t<<e|this.URShift(t,32-e)},P0:function(t){return t^this.ROTATE(t,9)^this.ROTATE(t,17)},P1:function(t){return t^this.ROTATE(t,15)^this.ROTATE(t,23)},FF_00_15:function(t,e,r){return t^e^r},FF_16_63:function(t,e,r){return t&e|t&r|e&r},GG_00_15:function(t,e,r){return t^e^r},GG_16_63:function(t,e,r){return t&e|~t&r},URShift:function(t,e){return(t>Int32.maxValue||t<Int32.minValue)&&(t=Int32.parse(t)),t>=0?t>>e:(t>>e)+(2<<~e)},URShiftLong:function(e,r){var i,n=new t;if(n.fromInt(e),n.signum()>=0)i=n.shiftRight(r).intValue();else{var s=new t;s.fromInt(2);var o=~r,a="";if(o<0){for(var h=64+o,u=0;u<h;u++)a+="0";var c=new t;c.fromInt(e>>r);var f=new t("10"+a,2);a=f.toRadix(10),i=f.add(c).toRadix(10)}else i=(e>>r)+(a=s.shiftLeft(~r).intValue())}return i},GetZ:function(t,e){var r=T.enc.Utf8.parse("1234567812345678"),i=4*r.words.length*8;this.Update(i>>8&255),this.Update(255&i);var n=this.GetWords(r.toString());this.BlockUpdate(n,0,n.length);var s=this.GetWords(t.curve.a.toBigInteger().toRadix(16)),o=this.GetWords(t.curve.b.toBigInteger().toRadix(16)),a=this.GetWords(t.getX().toBigInteger().toRadix(16)),h=this.GetWords(t.getY().toBigInteger().toRadix(16)),u=this.GetWords(e.substr(0,64)),c=this.GetWords(e.substr(64,64));this.BlockUpdate(s,0,s.length),this.BlockUpdate(o,0,o.length),this.BlockUpdate(a,0,a.length),this.BlockUpdate(h,0,h.length),this.BlockUpdate(u,0,u.length),this.BlockUpdate(c,0,c.length);var f=new Array(this.GetDigestSize());return this.DoFinal(f,0),f},GetWords:function(t){for(var e=[],r=t.length,i=0;i<r;i+=2)e[e.length]=parseInt(t.substr(i,2),16);return e},GetHex:function(t){for(var e=[],r=0,i=0;i<2*t.length;i+=2)e[i>>>3]|=parseInt(t[r])<<24-i%8*4,r++;return new T.lib.WordArray.init(e,t.length)}},Array.Clear=function(t,e,r){for(elm in t)t[elm]=null},Array.Copy=function(t,e,r,i,n){for(var s=t.slice(e,e+n),o=0;o<s.length;o++)r[i]=s[o],i++},this.Int32={minValue:-parseInt("10000000000000000000000000000000",2),maxValue:parseInt("01111111111111111111111111111111",2),parse:function(t){if(t<this.minValue){for(var e=(s=(n=new Number(-t)).toString(2)).substr(s.length-31,31),r="",i=0;i<e.length;i++)r+="0"==(o=e.substr(i,1))?"1":"0";return(a=parseInt(r,2))+1}if(t>this.maxValue){for(var n=Number(t),s=n.toString(2),e=s.substr(s.length-31,31),r="",i=0;i<e.length;i++){var o=e.substr(i,1);r+="0"==o?"1":"0"}var a=parseInt(r,2);return-(a+1)}return t},parseByte:function(t){if(t<0){for(var e=(s=(n=new Number(-t)).toString(2)).substr(s.length-8,8),r="",i=0;i<e.length;i++)r+="0"==e.substr(i,1)?"1":"0";return parseInt(r,2)+1}if(t>255){var n=Number(t),s=n.toString(2);return parseInt(s.substr(s.length-8,8),2)}return t}},"undefined"!=typeof KJUR&&KJUR||(KJUR={}),void 0!==KJUR.crypto&&KJUR.crypto||(KJUR.crypto={}),KJUR.crypto.SM3withSM2=function(e){var r=new E;this.type="SM2",this.getBigRandom=function(e){return new t(e.bitLength(),r).mod(e.subtract(t.ONE)).add(t.ONE)},this.setNamedCurve=function(t){this.ecparams=KJUR.crypto.ECParameterDB.getByName(t),this.prvKeyHex=null,this.pubKeyHex=null,this.curveName=t},this.setPrivateKeyHex=function(t){this.isPrivate=!0,this.prvKeyHex=t},this.setPublicKeyHex=function(t){this.isPublic=!0,this.pubKeyHex=t},this.generateKeyPairHex=function(){var t=this.ecparams.n,e=this.getBigRandom(t),r=this.ecparams.G.multiply(e),i=r.getX().toBigInteger(),n=r.getY().toBigInteger(),s=this.ecparams.keylen/4,o=("0000000000"+e.toString(16)).slice(-s),a="04"+("0000000000"+i.toString(16)).slice(-s)+("0000000000"+n.toString(16)).slice(-s);return this.setPrivateKeyHex(o),this.setPublicKeyHex(a),{ecprvhex:o,ecpubhex:a}},this.signWithMessageHash=function(t){return this.signHex(t,this.prvKeyHex)},this.signHex=function(e,r){var i=new t(r,16),n=this.ecparams.n,s=new t(e,16),o=null,a=null,h=null,u=null,c=i;do{do{var f=this.generateKeyPairHex();o=new t(f.ecprvhex,16);var l=f.ecpubhex;a=w.decodeFromHex(this.ecparams.curve,l),h=(h=s.add(a.getX().toBigInteger())).mod(n)}while(h.equals(t.ZERO)||h.add(o).equals(n));var g=c.add(t.ONE);g=g.modInverse(n),u=h.multiply(c),u=o.subtract(u).mod(n),u=g.multiply(u).mod(n)}while(u.equals(t.ZERO));return KJUR.crypto.ECDSA.biRSSigToASN1Sig(h,u)},this.sign=function(e,r){var i=t.fromByteArrayUnsigned(r),n=this.ecparams.n,s=t.fromByteArrayUnsigned(e);do{var o=this.getBigRandom(n),a=this.ecparams.G.multiply(o).getX().toBigInteger().mod(n)}while(a.compareTo(t.ZERO)<=0);var h=o.modInverse(n).multiply(s.add(i.multiply(a))).mod(n);return this.serializeSig(a,h)},this.verifyWithMessageHash=function(t,e){return this.verifyHex(t,e,this.pubKeyHex)},this.verifyHex=function(e,r,i){var n,s,o=KJUR.crypto.ECDSA.parseSigHex(r);n=o.r,s=o.s;var a;a=w.decodeFromHex(this.ecparams.curve,i);var h=new t(e,16);return this.verifyRaw(h,n,s,a)},this.verify=function(e,r,i){var n,s;if(Array.isArray(r)){var o=this.parseSig(r);n=o.r,s=o.s}else{if("object"!=typeof r||!r.r||!r.s)throw"Invalid value for signature";n=r.r,s=r.s}var a;if(i instanceof w)a=i;else{if(!Array.isArray(i))throw"Invalid format for pubkey value, must be byte array or ECPointFp";a=w.decodeFrom(this.ecparams.curve,i)}var h=t.fromByteArrayUnsigned(e);return this.verifyRaw(h,n,s,a)},this.verifyRaw=function(e,r,i,n){var s=this.ecparams.n,o=this.ecparams.G,a=r.add(i).mod(s);if(a.equals(t.ZERO))return!1;var h=o.multiply(i);h=h.add(n.multiply(a));var u=e.add(h.getX().toBigInteger()).mod(s);return r.equals(u)},this.serializeSig=function(t,e){var r=t.toByteArraySigned(),i=e.toByteArraySigned(),n=[];return n.push(2),n.push(r.length),(n=n.concat(r)).push(2),n.push(i.length),(n=n.concat(i)).unshift(n.length),n.unshift(48),n},this.parseSig=function(e){var r;if(48!=e[0])throw new Error("Signature not a valid DERSequence");if(r=2,2!=e[r])throw new Error("First element in signature must be a DERInteger");var i=e.slice(r+2,r+2+e[r+1]);if(r+=2+e[r+1],2!=e[r])throw new Error("Second element in signature must be a DERInteger");var n=e.slice(r+2,r+2+e[r+1]);return r+=2+e[r+1],{r:t.fromByteArrayUnsigned(i),s:t.fromByteArrayUnsigned(n)}},this.parseSigCompact=function(e){if(65!==e.length)throw"Signature has the wrong length";var r=e[0]-27;if(r<0||r>7)throw"Invalid signature type";var i=this.ecparams.n;return{r:t.fromByteArrayUnsigned(e.slice(1,33)).mod(i),s:t.fromByteArrayUnsigned(e.slice(33,65)).mod(i),i:r}},void 0!==e&&void 0!==e.curve&&(this.curveName=e.curve),void 0===this.curveName&&(this.curveName="sm2"),this.setNamedCurve(this.curveName),void 0!==e&&(void 0!==e.prv&&this.setPrivateKeyHex(e.prv),void 0!==e.pub&&this.setPublicKeyHex(e.pub))},"undefined"!=typeof KJUR&&KJUR||(KJUR={}),void 0!==KJUR.crypto&&KJUR.crypto||(KJUR.crypto={}),KJUR.crypto.ECParameterDB=new function(){function e(e){return new t(e,16)}var r={},i={};this.getByName=function(t){var e=t;if(void 0!==i[e]&&(e=i[t]),void 0!==r[e])return r[e];throw"unregistered EC curve name: "+e},this.regist=function(t,n,s,o,a,h,u,c,f,l,g,p){r[t]={};var d=e(s),F=e(o),v=e(a),y=e(h),m=e(u),b=new x(d,F,v),A=b.decodePointHex("04"+c+f);r[t].name=t,r[t].keylen=n,r[t].curve=b,r[t].G=A,r[t].n=y,r[t].h=m,r[t].oid=g,r[t].info=p;for(var S=0;S<l.length;S++)i[l[S]]=t}},KJUR.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field"),KJUR.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field"),KJUR.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field"),KJUR.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]),KJUR.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]),KJUR.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]),KJUR.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]),KJUR.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]),KJUR.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]),KJUR.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]),KJUR.crypto.ECParameterDB.regist("sm2",256,"FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFF","FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFC","28E9FA9E9D9F5E344D5A9E4BCF6509A7F39789F515AB8F92DDBCBD414D940E93","FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFF7203DF6B21C6052B53BBF40939D54123","1","32C4AE2C1F1981195F9904466A39C9948FE30BBFF2660BE1715A4589334C74C7","BC3736A2F4F6779C59BDCEE36B692153D0A9877CC62A474002DF32E52139F0A0",["sm2","SM2"]),function(e){var r=function(t){this.ct=1,this.p2=null,this.sm3keybase=null,this.dataForc3=new Array,this.key=new Array(32),this.keyOff=0,this.cipherMode=void 0!==t?t:SM2CipherMode.C1C3C2};r.prototype={Reset:function(){this.sm3keybase=new D,this.dataForc3=new Array;for(var t=this.p2.getX().toBigInteger().toRadix(16);t.length<64;)t="0"+t;for(var e=this.GetWords(t),r=this.p2.getY().toBigInteger().toRadix(16);r.length<64;)r="0"+r;var i=this.GetWords(r);this.sm3keybase.BlockUpdate(e,0,e.length);for(var n=0;n<e.length;n++)this.dataForc3.push(e[n]);this.sm3keybase.BlockUpdate(i,0,i.length),this.ct=1,this.NextKey()},NextKey:function(){var t=new D(this.sm3keybase);t.Update(this.ct>>24&255),t.Update(this.ct>>16&255),t.Update(this.ct>>8&255),t.Update(255&this.ct),t.DoFinal(this.key,0),this.keyOff=0,this.ct++},ArrayCopy:function(t,e,r){for(var i=0;i<t.length;i++)e.length>i+r?e[i+r]=t[i]:e.push(t[i])},KDF:function(t){for(var e=new Array(t),r=R.algorithm.SM3,i=new Array(32),n=1,s=t/32,o=t%32,a=this.p2.getX().toBigInteger().toRadix(16);a.length<64;)a="0"+a;for(var h=this.GetWords(a),u=this.p2.getY().toBigInteger().toRadix(16);u.length<64;)u="0"+u;for(var c=this.GetWords(u),f=0,l=0;l<s;l++){for(var g=new Array,l=0;l<h.length;l++)g.push(h[l]);for(l=0;l<h.length;l++)g.push(c[l]);g.push(n>>24&255),g.push(n>>16&255),g.push(n>>8&255),g.push(255&n);p=r.digest(g);this.ArrayCopy(p,e,f),f+=32,n++}if(0!=o){for(var g=new Array,l=0;l<h.length;l++)g.push(h[l]);for(l=0;l<h.length;l++)g.push(c[l]);g.push(n>>24&255),g.push(n>>16&255),g.push(n>>8&255),g.push(255&n);var p=r.digest(g);this.ArrayCopy(p,i,0)}Array.Copy(i,0,e,f,o);for(l=0;l<e.length;l++)e[l]=255&e[l];return e},InitEncipher:function(e){var r=null,i=null,n=new KJUR.crypto.ECDSA({curve:"sm2"}),s=n.generateKeyPairHex();r=new t(s.ecprvhex,16);var o=s.ecpubhex;return i=w.decodeFromHex(n.ecparams.curve,o),this.p2=e.multiply(r),this.Reset(),i},EncryptBlock:function(t){for(r=0;r<t.length;r++)this.dataForc3.push(t[r]);for(var e=this.KDF(t.length),r=0;r<t.length;r++)t[r]^=e[r]},InitDecipher:function(t,e){this.p2=e.multiply(t);this.p2.getX().toBigInteger().toRadix(16),this.p2.getY().toBigInteger().toRadix(16);this.Reset()},DecryptBlock:function(t){var e=this.KDF(t.length),r=0;for(r=0;r<e.length;r++)e[r].toString(16);for(r=0;r<t.length;r++)t[r]^=e[r];for(r=0;r<t.length;r++)this.dataForc3.push(t[r])},Dofinal:function(t){for(var e=this.p2.getY().toBigInteger().toRadix(16);e.length<64;)e="0"+e;for(var r=this.GetWords(e),i=R.algorithm.SM3,n=0;n<r.length;n++)this.dataForc3.push(r[n]);var s=i.digest(this.dataForc3);this.ArrayCopy(s,t,0),this.Reset()},Encrypt:function(t,e){var r=new Array(e.length);Array.Copy(e,0,r,0,e.length);var i=this.InitEncipher(t);this.EncryptBlock(r);var n=new Array(32);this.Dofinal(n);for(var s=i.getX().toBigInteger().toRadix(16),o=i.getY().toBigInteger().toRadix(16);s.length<64;)s="0"+s;for(;o.length<64;)o="0"+o;var a=s+o,h=this.GetHex(r).toString();h.length%2!=0&&(h="0"+h);var u=this.GetHex(n).toString(),c=a+h+u;return this.cipherMode==SM2CipherMode.C1C3C2&&(c=a+u+h),c},GetWords:function(t){for(var e=[],r=t.length,i=0;i<r;i+=2)e[e.length]=parseInt(t.substr(i,2),16);return e},GetHex:function(t){for(var e=[],r=0,i=0;i<2*t.length;i+=2)e[i>>>3]|=parseInt(t[r])<<24-i%8*4,r++;return new T.lib.WordArray.init(e,t.length)},Decrypt:function(t,e){var r=e,i=r.substr(0,64),n=r.substr(0+i.length,64),s=r.substr(i.length+n.length,r.length-i.length-n.length-64),o=r.substr(r.length-64);this.cipherMode==SM2CipherMode.C1C3C2&&(o=r.substr(i.length+n.length,64),s=r.substr(i.length+n.length+64));var a=this.GetWords(s),h=this.CreatePoint(i,n);this.InitDecipher(t,h),this.DecryptBlock(a);var u=new Array(32);return this.Dofinal(u),this.GetHex(u).toString()==o?this.GetHex(a).toString():""},CreatePoint:function(t,e){var r=new KJUR.crypto.ECDSA({curve:"sm2"}),i=(r.ecparams.curve,"04"+t+e);return w.decodeFromHex(r.ecparams.curve,i)},XORForTV:function(t,e){var r=t.toString(2),i=e.toString(2),n=r.split(""),s=i.split(""),o="";if(n.length>=s.length)for(h=n.length;h>0;h--){u=n.length-h;if(s.length<h)o+=n[u];else{var a=n.length-s.length;n[u]==s[u-a]?o+="0":o+="1"}}else for(var h=s.length;h>0;h--){var u=s.length-h;n.length<h?o+=s[u]:n[u-(a=s.length-n.length)]==s[u]?o+="0":o+="1"}return parseInt(o,2)}},e.SM2Cipher=r}(this),this.SM2CipherMode={C1C2C3:"0",C1C3C2:"1"},function(){var e=R.algorithm,r=R.util.Hex,i=R.util.Checker;e.SM2={generate:function(){var t=new KJUR.crypto.ECDSA({curve:"SM2"}).generateKeyPairHex();return{publicKey:r.parse(t.ecpubhex.substring(2,130)),privateKey:r.parse(t.ecprvhex)}},encrypt:function(t,e){i.checkNotEmpty(t,"plaintext is empty."),i.checkNotEmpty(e,"publicKey is empty."),i.checkArgument(64==e.length,"illegal SM2 public key:"+r.stringify(e));var n=r.stringify(e),s=n.substring(0,64),o=n.substring(64,128),a=SM2CipherMode.C1C3C2,h=new SM2Cipher(a),u=h.CreatePoint(s,o),c=h.Encrypt(u,t);return r.parse(c)},decrypt:function(e,n){i.checkArgument(void 0!=e&&e.length>0,"illegal ciphertext:"+r.stringify(e)),i.checkArgument(void 0!=n&&32==n.length,"illegal SM2 public key:"+r.stringify(n));var s=r.stringify(e).toLowerCase(),o=SM2CipherMode.C1C3C2,a=new SM2Cipher(o),h=new t(r.stringify(n),16),u=a.Decrypt(h,s);return r.parse(u)},sign:function(t,e){return i.checkArgument(void 0!=t&&t.length>0,"illegal data:"+r.stringify(t)),new KJUR.crypto.ECDSA({curve:"SM2"}).sign(t,e)},verify:function(t,e,r){return new KJUR.crypto.ECDSA({curve:"SM2"}).verify(t,e,r)},signWithoutHash:function(t,e){return new KJUR.crypto.ECDSA({curve:"SM2"}).signWithoutHash(t,e)},verifyWithoutHash:function(t,e,r){return new KJUR.crypto.ECDSA({curve:"SM2"}).verifyWithoutHash(t,e,r)},name:"SM2 algorithm",mode:"C1C3C2",testKeypair:{publicKey:"C5F171CC415C5C2759FE4668F51C0D7DA2CB85AE754F29135FED90D50C3B437D2EEA0F54163C3880C13618FF0F7CA67201DFF244016F09F19F7C1EC5D4033546",privateKey:"32803B68C49C9285F31577ACA17B7EE92E0828707F12FF8EE74442F75D68C5C8"},SM2_KEY_SIZE:32}}(),function(){var t=R.algorithm,e=R.util.Checker;t.SM3=function(){for(var t=new Array(0,0),r=new Array(0,0,0,0,0,0,0,0),i=new Array(64),n=0;n<64;n++)i[n]=0;var s=[128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],o=[255,255,255,254,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,0,0,0,255,255,255,255,255,255,255,252,40,233,250,158,157,159,94,52,77,90,158,75,207,101,9,167,243,151,137,245,21,171,143,146,221,188,189,65,77,148,14,147,50,196,174,44,31,25,129,25,95,153,4,70,106,57,201,148,143,227,11,191,242,102,11,225,113,90,69,137,51,76,116,199,188,55,54,162,244,246,119,156,89,189,206,227,107,105,33,83,208,169,135,124,198,42,71,64,2,223,50,229,33,57,240,160],a=function(t){return t>>>0},h=function(t){return 4294967295-a(t)>>>0},u=function(t,e,r){return a(t^e^r)},c=function(t,e,r){return a(t&e|t&r|e&r)},f=function(t,e,r){return a(t^e^r)},l=function(t,e,r){return a(t&e|h(t)&r)},g=function(t,e){return a(a(t)<<e%32)},p=function(t,e){return a(g(t,e)|a(t)>>>32-e%32)},d=function(t){return a(a(t)^p(t,9)^p(t,17))},F=function(t){return a(a(t)^p(t,15)^p(t,23))},v=function(){t[0]=0,t[1]=0,r[0]=1937774191,r[1]=1226093241,r[2]=388252375,r[3]=3666478592,r[4]=2842636476,r[5]=372324522,r[6]=3817729613,r[7]=2969243214},y=function(t,e,r){var i=4278190080&t[e+r+0]<<24|16711680&t[e+r+1]<<16|65280&t[e+r+2]<<8|255&t[e+r+3];return a(i)},m=function(t,e,r){t>>>=0,e[r+0]=255&(4278190080&t)>>>24,e[r+1]=255&(16711680&t)>>>16,e[r+2]=255&(65280&t)>>>8,e[r+3]=255&t},b=function(t,e){for(var i,n,s,o,h,g,v,m,b,A,S,E,B,w,x,D,R=new Array(68),T=new Array(64),C=new Array(64),I=68;I>0;I--)R[I-1]=0;for(I=64;I>0;I--)T[I-1]=0;for(I=0;I<16;I++)C[I]=2043430169;for(I=16;I<64;I++)C[I]=2055708042;for(I=0;I<16;I++)R[I]=y(t,e,4*I);for(I=16;I<68;I++)B=(R[I-16]^R[I-9])>>>0,w=p(R[I-3],15),x=F((B^w)>>>0),D=(p(R[I-13],7)^R[I-6])>>>0,R[I]=(x^D)>>>0;for(I=0;I<64;I++)T[I]=(R[I]^R[I+4])>>>0;h=r[0]>>>0,g=r[1]>>>0,v=r[2]>>>0,m=r[3]>>>0,b=r[4]>>>0,A=r[5]>>>0,S=r[6]>>>0,E=r[7]>>>0;for(I=0;I<16;I++)n=(i=p(p(h,12)+b+p(C[I],I),7))^p(h,12)>>>0,s=u(h,g,v)+m+n+T[I],o=f(b,A,S)+E+i+R[I],m=a(v),v=p(g,9),g=a(h),h=a(s),E=a(S),S=p(A,19),A=a(b),b=d(o);for(I=16;I<64;I++)i=a(p(p(h,12)+b+p(C[I],I),7)),n=a(i^p(h,12)),s=a(c(h,g,v)+m+n+T[I]),o=a(l(b,A,S)+E+i+R[I]),m=a(v),v=p(g,9),g=a(h),h=a(s),E=a(S),S=p(A,19),A=a(b),b=d(o);r[0]=(h^r[0])>>>0,r[1]=(g^r[1])>>>0,r[2]=(v^r[2])>>>0,r[3]=(m^r[3])>>>0,r[4]=(b^r[4])>>>0,r[5]=(A^r[5])>>>0,r[6]=(S^r[6])>>>0,r[7]=(E^r[7])>>>0},A=function(t,e,r,i,n){for(var s=0;s<n;s++)t[e+s]=r[i+s]},S=function(e,r){if(void 0!==typeof e&&null!==e){var n=63&t[0],s=64-n;t[0]+=r,t[0],t[0]<r&&t[1]++;var o=0;for(0!==n&&r>=s&&(A(i,n,e,o,s),b(i,0),o+=s,r-=s,n=0);r>=64;)b(e,o),o+=64,r-=64;r>0&&A(i,n,e,o,r)}},E=function(){var e,i,n,o=new Array(32),h=new Array(8);i=a(t[0]>>>29|t[1]<<3),n=a(t[0]<<3),m(i,h,0),m(n,h,4),e=a(63&t[0]),S(s,e<56?56-e:120-e),S(h,8);for(var u=0;u<8;u++)m(r[u],o,4*u);return o};return{digest:function(t){return e.checkExist(t,"illegal input."),v(),S(t,t.length),E()},init:function(){v()},update:function(t){e.checkExist(t,"illegal input."),S(t,t.length)},doFinal:function(){return E()},hmacWithPublicKey:function(t,e,r){var i=new Array(2+e.length+128+64),n=new Array(t.length+32);e.length;i[0]=e.length>>8&255,i[1]=255&e.length,A(i,2,e,0,e.length),A(i,2+e.length,o,0,o.length),A(i,2+e.length+o.length,r,0,r.length);var s=digest(i);return A(n,0,s,0,32),A(n,32,t,0,t.length),digest(n)},hmac:function(t,e){for(var r=new Array(64),i=new Array(64),n=0;n<64;n++)r[n]=54,i[n]=92;for(var n=0,s=t.length;n<s;n++)r[n]=(r[n]^t[n])>>>0,i[n]=(i[n]^t[n])>>>0;v(),S(r,r.length),S(e,e.length);var o=E();return v(),S(i,i.length),S(o,o.length),E()}}}()}(),function(){var t=R.algorithm,e=R.util.Checker;t.SM4=function(){function t(t,e){return t<<e|t>>>32-e}function r(e){return e^t(e,2)^t(e,10)^t(e,18)^t(e,24)}function i(e){return e^t(e,13)^t(e,23)}function n(t){return(255&l[t>>>24&255])<<24|(255&l[t>>>16&255])<<16|(255&l[t>>>8&255])<<8|255&l[255&t]}function s(t,e){return e?r(n(t)):i(n(t))}function o(t,e,r,i,n){return t^s(e^r^i^n,!0)}function a(t){for(var e=new Array(32),r=new Array(4),i=0;i<4;i++)r[i]=u(t,4*i);for(var n=new Array(4),i=0;i<4;i++)n[i]=r[i]^p[i];for(i=0;i<32;i+=4)e[i]=n[0]=n[0]^s(n[1]^n[2]^n[3]^g[i],!1),e[i+1]=n[1]=n[1]^s(n[2]^n[3]^n[0]^g[i+1],!1),e[i+2]=n[2]=n[2]^s(n[3]^n[0]^n[1]^g[i+2],!1),e[i+3]=n[3]=n[3]^s(n[0]^n[1]^n[2]^g[i+3],!1);return e}function h(t,e,r,i,n,s){for(var a=new Array(4),h=0;h<4;h++)a[h]=u(t,e+4*h);for(h=0;h<32;h+=4)s==f?(a[0]=o(a[0],a[1],a[2],a[3],n[h]),a[1]=o(a[1],a[2],a[3],a[0],n[h+1]),a[2]=o(a[2],a[3],a[0],a[1],n[h+2]),a[3]=o(a[3],a[0],a[1],a[2],n[h+3])):(a[0]=o(a[0],a[1],a[2],a[3],n[31-h]),a[1]=o(a[1],a[2],a[3],a[0],n[30-h]),a[2]=o(a[2],a[3],a[0],a[1],n[29-h]),a[3]=o(a[3],a[0],a[1],a[2],n[28-h]));for(h=0;h<4;h++)c(a[3-h],r,i+4*h)}function u(t,e){return(255&t[e])<<24|(255&t[e+1])<<16|(255&t[e+2])<<8|255&t[e+3]}function c(t,e,r){e[r]=(4278190080&t)>>>24,e[r+1]=(16711680&t)>>>16,e[r+2]=(65280&t)>>>8,e[r+3]=255&t}var f=0,l=[214,144,233,254,204,225,61,183,22,182,20,194,40,251,44,5,43,103,154,118,42,190,4,195,170,68,19,38,73,134,6,153,156,66,80,244,145,239,152,122,51,84,11,67,237,207,172,98,228,179,28,169,201,8,232,149,128,223,148,250,117,143,63,166,71,7,167,252,243,115,23,186,131,89,60,25,230,133,79,168,104,107,129,178,113,100,218,139,248,235,15,75,112,86,157,53,30,36,14,94,99,88,209,162,37,34,124,59,1,33,120,135,212,0,70,87,159,211,39,82,76,54,2,231,160,196,200,158,234,191,138,210,64,199,56,181,163,247,242,206,249,97,21,161,224,174,93,164,155,52,26,85,173,147,50,48,245,140,177,227,29,246,226,46,130,102,202,96,192,41,35,171,13,83,78,111,213,219,55,69,222,253,142,47,3,255,106,114,109,108,91,81,141,27,175,146,187,221,188,127,17,217,92,65,31,16,90,216,10,193,49,136,165,205,123,189,45,116,208,18,184,229,180,176,137,105,151,74,12,150,119,126,101,185,241,9,197,110,198,132,24,240,125,236,58,220,77,32,121,238,95,62,215,203,57,72],g=[462357,472066609,943670861,1415275113,1886879365,2358483617,2830087869,3301692121,3773296373,4228057617,404694573,876298825,1347903077,1819507329,2291111581,2762715833,3234320085,3705924337,4177462797,337322537,808926789,1280531041,1752135293,2223739545,2695343797,3166948049,3638552301,4110090761,269950501,741554753,1213159005,1684763257],p=[2746333894,1453994832,1736282519,2993693404],d=function(t,e){for(var r=new Array(16),i=0;i<16;i++)r[i]=t[i]^e[i];return r},F=function(t,e,r,i,n){for(var s=0;s<n;s++)r[s+i]=t[s+e];return t};return{name:"SM4 algorithm",KEY_SIZE:16,encryptWithECB:function(t,r){e.checkArgument(void 0!==t&&t.length%16==0,"illegal plaintext:the length of plaintext must be the multiple of 16."),e.checkArgument(void 0!==r&&16===r.length,"illegal key:the length of sm4Key must be 16 bytes.");for(var i=a(r),n=t.length,s=new Array(n),o=0;o<n;)h(t,o,s,o,i,f),o+=16;return s},decryptWithECB:function(t,r){e.checkArgument(void 0!==t&&t.length%16==0,"illegal ciphertext:the length of ciphertext must be the multiple of 16."),e.checkArgument(void 0!==r&&16===r.length,"illegal key:the length of sm4Key must be 16 bytes.");for(var i=a(r),n=new Array(t.length),s=0;s<t.length;)h(t,s,n,s,i,1),s+=16;return n},encryptWithCBC:function(t,r,i){e.checkArgument(void 0!=typeof t&&t.length%16==0,"illegal plaintext:the length of plaintext must be the multiple of 16."),e.checkArgument(void 0!==r&&16===r.length,"illegal key:the length of sm4Key must be 16 bytes."),e.checkArgument(void 0!==i&&16===i.length,"illegal iv:the length of sm4 iv must be 16 bytes.");for(var n=a(r),s=new Array(t.length),o=0;o<t.length;o+=16){var u=t.slice(o,o+16),c=d(u,i),l=new Array(16);h(c,0,l,0,n,f),F(l,0,s,o,16),i=l}return s},decryptWithCBC:function(t,r,i){e.checkArgument(void 0!=typeof t&&t.length%16==0,"illegal plaintext:the length of plaintext must be the multiple of 16."),e.checkArgument(void 0!==r&&16===r.length,"illegal key:the length of sm4Key must be 16 bytes."),e.checkArgument(void 0!==i&&16===i.length,"illegal iv:the length of sm4 iv must be 16 bytes.");for(var n=a(r),s=new Array(t.length),o=0;o<t.length;o+=16){var u=t.slice(o,o+16),c=new Array(16);h(u,0,c,0,n,1);var f=d(c,i);i=t.slice(o,o+16),F(f,0,s,o,16)}return s}}}()}(),function(){var t=R.algorithm;R.util.Checker,t.AES=function(){function t(t,e){return t>>>e|t<<-e}function e(t){return(t&R)<<1^((t&D)>>>7)*T}function r(t){var e=t&C;return e^=e>>>1,(t&I)<<2^e>>>2^e>>>5}function i(i){var n,s;return n=i,s=n^t(n,8),n^=e(s),s^=r(n),n^=s^t(s,16)}function n(t){return 255&S[255&t]|(255&S[t>>8&255])<<8|(255&S[t>>16&255])<<16|S[t>>24&255]<<24}function s(t,e){var r=255&t[e];return r|=(255&t[++e])<<8,r|=(255&t[++e])<<16,r|=t[++e]<<24}function o(e,r){var o=e.length>>>2;l=o+6;for(var a=new Array(l+1),h=0;h<=l;h++)a[h]=new Array(4);switch(o){case 4:f=s(e,0);a[0][0]=f;g=s(e,4);a[0][1]=g;p=s(e,8);a[0][2]=p;d=s(e,12);a[0][3]=d;for(h=1;h<=10;++h)f^=c=n(t(d,8))^B[h-1],a[h][0]=f,g^=f,a[h][1]=g,p^=g,a[h][2]=p,d^=p,a[h][3]=d;break;case 6:f=s(e,0);a[0][0]=f;g=s(e,4);a[0][1]=g;p=s(e,8);a[0][2]=p;d=s(e,12);a[0][3]=d;F=s(e,16);a[1][0]=F;v=s(e,20);a[1][1]=v;var u=1,c=n(t(v,8))^u;u<<=1,f^=c,a[1][2]=f,g^=f,a[1][3]=g,p^=g,a[2][0]=p,d^=p,a[2][1]=d,F^=d,a[2][2]=F,v^=F,a[2][3]=v;for(h=3;h<12;h+=3)c=n(t(v,8))^u,u<<=1,f^=c,a[h][0]=f,g^=f,a[h][1]=g,p^=g,a[h][2]=p,d^=p,a[h][3]=d,F^=d,a[h+1][0]=F,v^=F,a[h+1][1]=v,c=n(t(v,8))^u,u<<=1,f^=c,a[h+1][2]=f,g^=f,a[h+1][3]=g,p^=g,a[h+2][0]=p,d^=p,a[h+2][1]=d,F^=d,a[h+2][2]=F,v^=F,a[h+2][3]=v;f^=c=n(t(v,8))^u,a[12][0]=f,g^=f,a[12][1]=g,p^=g,a[12][2]=p,d^=p,a[12][3]=d;break;case 8:var f=s(e,0);a[0][0]=f;var g=s(e,4);a[0][1]=g;var p=s(e,8);a[0][2]=p;var d=s(e,12);a[0][3]=d;var F=s(e,16);a[1][0]=F;var v=s(e,20);a[1][1]=v;var y=s(e,24);a[1][2]=y;var b=s(e,28);a[1][3]=b;for(var u=1,h=2;h<14;h+=2)c=n(t(b,8))^u,u<<=1,f^=c,a[h][0]=f,g^=f,a[h][1]=g,p^=g,a[h][2]=p,d^=p,a[h][3]=d,F^=c=n(d),a[h+1][0]=F,v^=F,a[h+1][1]=v,y^=v,a[h+1][2]=y,b^=y,a[h+1][3]=b;f^=c=n(t(b,8))^u,a[14][0]=f,g^=f,a[14][1]=g,p^=g,a[14][2]=p,d^=p,a[14][3]=d;break;default:return-1}if(r===m)for(var A=1;A<l;A++)for(h=0;h<4;h++)a[A][h]=i(a[A][h]);return a}function a(t,e){var r=e;g=255&t[r++],g|=(255&t[r++])<<8,g|=(255&t[r++])<<16,g|=t[r++]<<24,p=255&t[r++],p|=(255&t[r++])<<8,p|=(255&t[r++])<<16,p|=t[r++]<<24,d=255&t[r++],d|=(255&t[r++])<<8,d|=(255&t[r++])<<16,d|=t[r++]<<24,F=255&t[r++],F|=(255&t[r++])<<8,F|=(255&t[r++])<<16,F|=t[r++]<<24}function h(t,e){var r=e;t[r++]=255&g,t[r++]=g>>>8&255,t[r++]=g>>>16&255,t[r++]=g>>>24&255,t[r++]=255&p,t[r++]=p>>>8&255,t[r++]=p>>>16&255,t[r++]=p>>>24&255,t[r++]=255&d,t[r++]=d>>>8&255,t[r++]=d>>>16&255,t[r++]=d>>>24&255,t[r++]=255&F,t[r++]=F>>>8&255,t[r++]=F>>>16&255,t[r++]=F>>>24&255}function u(e){for(var r,i,n,s=g^e[0][0],o=p^e[0][1],a=d^e[0][2],h=1,u=F^e[0][3];h<l-1;)r=w[255&s]^t(w[o>>>8&255],24)^t(w[a>>>16&255],16)^t(w[u>>>24&255],8)^e[h][0],i=w[255&o]^t(w[a>>>8&255],24)^t(w[u>>>16&255],16)^t(w[s>>>24&255],8)^e[h][1],n=w[255&a]^t(w[u>>>8&255],24)^t(w[s>>>16&255],16)^t(w[o>>>24&255],8)^e[h][2],u=w[255&u]^t(w[s>>>8&255],24)^t(w[o>>>16&255],16)^t(w[a>>>24&255],8)^e[h++][3],s=w[255&r]^t(w[i>>>8&255],24)^t(w[n>>>16&255],16)^t(w[u>>>24&255],8)^e[h][0],o=w[255&i]^t(w[n>>>8&255],24)^t(w[u>>>16&255],16)^t(w[r>>>24&255],8)^e[h][1],a=w[255&n]^t(w[u>>>8&255],24)^t(w[r>>>16&255],16)^t(w[i>>>24&255],8)^e[h][2],u=w[255&u]^t(w[r>>>8&255],24)^t(w[i>>>16&255],16)^t(w[n>>>24&255],8)^e[h++][3];r=w[255&s]^t(w[o>>>8&255],24)^t(w[a>>>16&255],16)^t(w[u>>>24&255],8)^e[h][0],i=w[255&o]^t(w[a>>>8&255],24)^t(w[u>>>16&255],16)^t(w[s>>>24&255],8)^e[h][1],n=w[255&a]^t(w[u>>>8&255],24)^t(w[s>>>16&255],16)^t(w[o>>>24&255],8)^e[h][2],u=w[255&u]^t(w[s>>>8&255],24)^t(w[o>>>16&255],16)^t(w[a>>>24&255],8)^e[h++][3],g=255&S[255&r]^(255&S[i>>>8&255])<<8^(255&S[n>>>16&255])<<16^S[u>>>24&255]<<24^e[h][0],p=255&S[255&i]^(255&S[n>>>8&255])<<8^(255&S[u>>>16&255])<<16^S[r>>>24&255]<<24^e[h][1],d=255&S[255&n]^(255&S[u>>>8&255])<<8^(255&S[r>>>16&255])<<16^S[i>>>24&255]<<24^e[h][2],F=255&S[255&u]^(255&S[r>>>8&255])<<8^(255&S[i>>>16&255])<<16^S[n>>>24&255]<<24^e[h][3]}function c(e){for(var r,i,n,s=g^e[l][0],o=p^e[l][1],a=d^e[l][2],h=l-1,u=F^e[l][3];h>1;)r=x[255&s]^t(x[u>>>8&255],24)^t(x[a>>>16&255],16)^t(x[o>>>24&255],8)^e[h][0],i=x[255&o]^t(x[s>>>8&255],24)^t(x[u>>>16&255],16)^t(x[a>>>24&255],8)^e[h][1],n=x[255&a]^t(x[o>>>8&255],24)^t(x[s>>>16&255],16)^t(x[u>>>24&255],8)^e[h][2],u=x[255&u]^t(x[a>>>8&255],24)^t(x[o>>>16&255],16)^t(x[s>>>24&255],8)^e[h--][3],s=x[255&r]^t(x[u>>>8&255],24)^t(x[n>>>16&255],16)^t(x[i>>>24&255],8)^e[h][0],o=x[255&i]^t(x[r>>>8&255],24)^t(x[u>>>16&255],16)^t(x[n>>>24&255],8)^e[h][1],a=x[255&n]^t(x[i>>>8&255],24)^t(x[r>>>16&255],16)^t(x[u>>>24&255],8)^e[h][2],u=x[255&u]^t(x[n>>>8&255],24)^t(x[i>>>16&255],16)^t(x[r>>>24&255],8)^e[h--][3];r=x[255&s]^t(x[u>>>8&255],24)^t(x[a>>>16&255],16)^t(x[o>>>24&255],8)^e[h][0],i=x[255&o]^t(x[s>>>8&255],24)^t(x[u>>>16&255],16)^t(x[a>>>24&255],8)^e[h][1],n=x[255&a]^t(x[o>>>8&255],24)^t(x[s>>>16&255],16)^t(x[u>>>24&255],8)^e[h][2],u=x[255&u]^t(x[a>>>8&255],24)^t(x[o>>>16&255],16)^t(x[s>>>24&255],8)^e[h][3],g=255&E[255&r]^(255&E[u>>>8&255])<<8^(255&E[n>>>16&255])<<16^E[i>>>24&255]<<24^e[0][0],p=255&E[255&i]^(255&E[r>>>8&255])<<8^(255&E[u>>>16&255])<<16^E[n>>>24&255]<<24^e[0][1],d=255&E[255&n]^(255&E[i>>>8&255])<<8^(255&E[r>>>16&255])<<16^E[u>>>24&255]<<24^e[0][2],F=255&E[255&u]^(255&E[n>>>8&255])<<8^(255&E[i>>>16&255])<<16^E[r>>>24&255]<<24^e[0][3]}function f(t,e,r,i){return v===y?(a(t,e),u(A),h(r,i)):(a(t,e),c(A),h(r,i)),b}var l,g,p,d,F,v,y=0,m=1,b=16,A=new Array,S=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],E=[82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125],B=[1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145],w=[2774754246,2222750968,2574743534,2373680118,234025727,3177933782,2976870366,1422247313,1345335392,50397442,2842126286,2099981142,436141799,1658312629,3870010189,2591454956,1170918031,2642575903,1086966153,2273148410,368769775,3948501426,3376891790,200339707,3970805057,1742001331,4255294047,3937382213,3214711843,4154762323,2524082916,1539358875,3266819957,486407649,2928907069,1780885068,1513502316,1094664062,49805301,1338821763,1546925160,4104496465,887481809,150073849,2473685474,1943591083,1395732834,1058346282,201589768,1388824469,1696801606,1589887901,672667696,2711000631,251987210,3046808111,151455502,907153956,2608889883,1038279391,652995533,1764173646,3451040383,2675275242,453576978,2659418909,1949051992,773462580,756751158,2993581788,3998898868,4221608027,4132590244,1295727478,1641469623,3467883389,2066295122,1055122397,1898917726,2542044179,4115878822,1758581177,0,753790401,1612718144,536673507,3367088505,3982187446,3194645204,1187761037,3653156455,1262041458,3729410708,3561770136,3898103984,1255133061,1808847035,720367557,3853167183,385612781,3309519750,3612167578,1429418854,2491778321,3477423498,284817897,100794884,2172616702,4031795360,1144798328,3131023141,3819481163,4082192802,4272137053,3225436288,2324664069,2912064063,3164445985,1211644016,83228145,3753688163,3249976951,1977277103,1663115586,806359072,452984805,250868733,1842533055,1288555905,336333848,890442534,804056259,3781124030,2727843637,3427026056,957814574,1472513171,4071073621,2189328124,1195195770,2892260552,3881655738,723065138,2507371494,2690670784,2558624025,3511635870,2145180835,1713513028,2116692564,2878378043,2206763019,3393603212,703524551,3552098411,1007948840,2044649127,3797835452,487262998,1994120109,1004593371,1446130276,1312438900,503974420,3679013266,168166924,1814307912,3831258296,1573044895,1859376061,4021070915,2791465668,2828112185,2761266481,937747667,2339994098,854058965,1137232011,1496790894,3077402074,2358086913,1691735473,3528347292,3769215305,3027004632,4199962284,133494003,636152527,2942657994,2390391540,3920539207,403179536,3585784431,2289596656,1864705354,1915629148,605822008,4054230615,3350508659,1371981463,602466507,2094914977,2624877800,555687742,3712699286,3703422305,2257292045,2240449039,2423288032,1111375484,3300242801,2858837708,3628615824,84083462,32962295,302911004,2741068226,1597322602,4183250862,3501832553,2441512471,1489093017,656219450,3114180135,954327513,335083755,3013122091,856756514,3144247762,1893325225,2307821063,2811532339,3063651117,572399164,2458355477,552200649,1238290055,4283782570,2015897680,2061492133,2408352771,4171342169,2156497161,386731290,3669999461,837215959,3326231172,3093850320,3275833730,2962856233,1999449434,286199582,3417354363,4233385128,3602627437,974525996],x=[1353184337,1399144830,3282310938,2522752826,3412831035,4047871263,2874735276,2466505547,1442459680,4134368941,2440481928,625738485,4242007375,3620416197,2151953702,2409849525,1230680542,1729870373,2551114309,3787521629,41234371,317738113,2744600205,3338261355,3881799427,2510066197,3950669247,3663286933,763608788,3542185048,694804553,1154009486,1787413109,2021232372,1799248025,3715217703,3058688446,397248752,1722556617,3023752829,407560035,2184256229,1613975959,1165972322,3765920945,2226023355,480281086,2485848313,1483229296,436028815,2272059028,3086515026,601060267,3791801202,1468997603,715871590,120122290,63092015,2591802758,2768779219,4068943920,2997206819,3127509762,1552029421,723308426,2461301159,4042393587,2715969870,3455375973,3586000134,526529745,2331944644,2639474228,2689987490,853641733,1978398372,971801355,2867814464,111112542,1360031421,4186579262,1023860118,2919579357,1186850381,3045938321,90031217,1876166148,4279586912,620468249,2548678102,3426959497,2006899047,3175278768,2290845959,945494503,3689859193,1191869601,3910091388,3374220536,0,2206629897,1223502642,2893025566,1316117100,4227796733,1446544655,517320253,658058550,1691946762,564550760,3511966619,976107044,2976320012,266819475,3533106868,2660342555,1338359936,2720062561,1766553434,370807324,179999714,3844776128,1138762300,488053522,185403662,2915535858,3114841645,3366526484,2233069911,1275557295,3151862254,4250959779,2670068215,3170202204,3309004356,880737115,1982415755,3703972811,1761406390,1676797112,3403428311,277177154,1076008723,538035844,2099530373,4164795346,288553390,1839278535,1261411869,4080055004,3964831245,3504587127,1813426987,2579067049,4199060497,577038663,3297574056,440397984,3626794326,4019204898,3343796615,3251714265,4272081548,906744984,3481400742,685669029,646887386,2764025151,3835509292,227702864,2613862250,1648787028,3256061430,3904428176,1593260334,4121936770,3196083615,2090061929,2838353263,3004310991,999926984,2809993232,1852021992,2075868123,158869197,4095236462,28809964,2828685187,1701746150,2129067946,147831841,3873969647,3650873274,3459673930,3557400554,3598495785,2947720241,824393514,815048134,3227951669,935087732,2798289660,2966458592,366520115,1251476721,4158319681,240176511,804688151,2379631990,1303441219,1414376140,3741619940,3820343710,461924940,3089050817,2136040774,82468509,1563790337,1937016826,776014843,1511876531,1389550482,861278441,323475053,2355222426,2047648055,2383738969,2302415851,3995576782,902390199,3991215329,1018251130,1507840668,1064563285,2043548696,3208103795,3939366739,1537932639,342834655,2262516856,2180231114,1053059257,741614648,1598071746,1925389590,203809468,2336832552,1100287487,1895934009,3736275976,2632234200,2428589668,1636092795,1890988757,1952214088,1113045200],D=2155905152,R=2139062143,T=27,C=3233857728,I=1061109567,K=function(t,e){for(var r=new Array(b),i=0;i<b;i++)r[i]=t[i]^e[i];return r},O=function(t,e,r,i,n){for(var s=0;s<n;s++)r[s+i]=t[s+e];return t};return{name:"AES algorithm",KEY_SIZE:b,encryptWithECB:function(t,e){A=o(e,y),v=y;for(var r=t.length,i=new Array(r),n=0;n<r;)f(t,n,i,n),n+=16;return i},decryptWithECB:function(t,e){A=o(e,m),v=m;for(var r=t.length,i=new Array(r),n=0;n<r;)f(t,n,i,n),n+=16;return i},encryptWithCBC:function(t,e,r){A=o(e,y),v=y;for(var i=new Array(t.length),n=0;n<t.length;n+=16){var s=t.slice(n,n+16),a=K(s,r),h=new Array(b);f(a,0,h,0),O(h,0,i,n,b),r=h}return i},decryptWithCBC:function(t,e,r){A=o(e,m),v=m;for(var i=new Array(t.length),n=0;n<t.length;n+=16){var s=t.slice(n,n+16),a=new Array(b);f(s,0,a,0);var h=K(a,r);r=s,O(h,0,i,n,b)}return i}}}()}(),function(t){function e(t,r,i){if(!(this instanceof e))return new e(t,r,i);null!=t&&("number"==typeof t?this.fromNumber(t,r,i):null==r&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,r))}function r(t){return C.charAt(t)}function i(t,e){var r=I[t.charCodeAt(e)];return null==r?-1:r}function n(t){var r=new e;return r.fromInt(t),r}function s(t){var e,r=1;return 0!=(e=t>>>16)&&(t=e,r+=16),0!=(e=t>>8)&&(t=e,r+=8),0!=(e=t>>4)&&(t=e,r+=4),0!=(e=t>>2)&&(t=e,r+=2),0!=(e=t>>1)&&(t=e,r+=1),r}function o(t){this.m=t}function a(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function h(t,e){return t&e}function u(t,e){return t|e}function c(t,e){return t^e}function f(t,e){return t&~e}function l(t){if(0==t)return-1;var e=0;return 0==(65535&t)&&(t>>=16,e+=16),0==(255&t)&&(t>>=8,e+=8),0==(15&t)&&(t>>=4,e+=4),0==(3&t)&&(t>>=2,e+=2),0==(1&t)&&++e,e}function g(t){for(var e=0;0!=t;)t&=t-1,++e;return e}function p(){}function d(t){return t}function F(t){this.r2=new e,this.q3=new e,e.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function v(){this.i=0,this.j=0,this.S=new Array}function y(){}function m(t,r){return new e(t,r)}function b(t){for(var e=[],r=t.length,i=0;i<r;i++){var n=t[i];e.push((n>>>4).toString(16)),e.push((15&n).toString(16))}return e.join("").toUpperCase()}function A(t,r,i){if(r<t.length+11)return UnionLogger.set("Message too long for RSA"),null;for(var n=new Array,s=t.length-1;s>=0&&r>0;)n[--r]=t[s--];n[--r]=0;var o=r;if(i&&"sign"===i){for(;r>2;)n[--r]=255;n[--r]=1}else{for(var a=new y,h=new Array;r>2;){for(h[0]=0;0==h[0];)a.nextBytes(h);n[--r]=h[0]}n[--r]=2}return UnionLogger.set("RandomHex: "+b(n.slice(2,o))),n[--r]=0,UnionLogger.set("PlainText"+b(n)),new e(n)}function S(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function E(t,e){for(var r=t.toByteArray(),i=0;i<r.length&&0==r[i];)++i;if(r.length-i!=e-1||2!=r[i]&&1!=r[i])return UnionLogger.set("unpad PKCS#1 failed."),null;++i;for(var n=0;0!=r[i];)if(n++,++i>=r.length)return UnionLogger.set("unpad PKCS#1 failed."),null;if(n<8)return UnionLogger.set("unpad PKCS#1 failed."),null;for(var s=[];++i<r.length;)s.push(255&r[i]);return s}function B(t){var e,r,i="";for(e=0;e+3<=t.length;e+=3)r=parseInt(t.substring(e,e+3),16),i+=M.charAt(r>>6)+M.charAt(63&r);for(e+1==t.length?(r=parseInt(t.substring(e,e+1),16),i+=M.charAt(r<<2)):e+2==t.length&&(r=parseInt(t.substring(e,e+2),16),i+=M.charAt(r>>2)+M.charAt((3&r)<<4));(3&i.length)>0;)i+=P;return i}var w=e.prototype;e.prototype.am=function(t,e,r,i,n,s){for(;--s>=0;){var o=e*this[t++]+r[i]+n;n=Math.floor(o/67108864),r[i++]=67108863&o}return n},e.prototype.DB=26,e.prototype.DM=67108863;var x=e.prototype.DV=1<<26;e.prototype.FV=Math.pow(2,52),e.prototype.F1=26,e.prototype.F2=0;var D,R,C="0123456789abcdefghijklmnopqrstuvwxyz",I=new Array;for(D="0".charCodeAt(0),R=0;R<=9;++R)I[D++]=R;for(D="a".charCodeAt(0),R=10;R<36;++R)I[D++]=R;for(D="A".charCodeAt(0),R=10;R<36;++R)I[D++]=R;o.prototype.convert=function(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t},o.prototype.revert=function(t){return t},o.prototype.reduce=function(t){t.divRemTo(this.m,null,t)},o.prototype.mulTo=function(t,e,r){t.multiplyTo(e,r),this.reduce(r)},o.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},a.prototype.convert=function(t){var r=new e;return t.abs().dlShiftTo(this.m.t,r),r.divRemTo(this.m,null,r),t.s<0&&r.compareTo(e.ZERO)>0&&this.m.subTo(r,r),r},a.prototype.revert=function(t){var r=new e;return t.copyTo(r),this.reduce(r),r},a.prototype.reduce=function(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=32767&t[e],i=r*this.mpl+((r*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(t[r=e+this.m.t]+=this.m.am(0,i,t,e,0,this.m.t);t[r]>=t.DV;)t[r]-=t.DV,t[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)},a.prototype.mulTo=function(t,e,r){t.multiplyTo(e,r),this.reduce(r)},a.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},w.copyTo=function(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s},w.fromInt=function(t){this.t=1,this.s=t<0?-1:0,t>0?this[0]=t:t<-1?this[0]=t+x:this.t=0},w.fromString=function(t,r){var n,s=this;if(16==r)n=4;else if(8==r)n=3;else if(256==r)n=8;else if(2==r)n=1;else if(32==r)n=5;else{if(4!=r)return void s.fromRadix(t,r);n=2}s.t=0,s.s=0;for(var o=t.length,a=!1,h=0;--o>=0;){var u=8==n?255&t[o]:i(t,o);u<0?"-"==t.charAt(o)&&(a=!0):(a=!1,0==h?s[s.t++]=u:h+n>s.DB?(s[s.t-1]|=(u&(1<<s.DB-h)-1)<<h,s[s.t++]=u>>s.DB-h):s[s.t-1]|=u<<h,(h+=n)>=s.DB&&(h-=s.DB))}8==n&&0!=(128&t[0])&&(s.s=-1,h>0&&(s[s.t-1]|=(1<<s.DB-h)-1<<h)),s.clamp(),a&&e.ZERO.subTo(s,s)},w.clamp=function(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t},w.dlShiftTo=function(t,e){var r;for(r=this.t-1;r>=0;--r)e[r+t]=this[r];for(r=t-1;r>=0;--r)e[r]=0;e.t=this.t+t,e.s=this.s},w.drShiftTo=function(t,e){for(var r=t;r<this.t;++r)e[r-t]=this[r];e.t=Math.max(this.t-t,0),e.s=this.s},w.lShiftTo=function(t,e){var r,i=this,n=t%i.DB,s=i.DB-n,o=(1<<s)-1,a=Math.floor(t/i.DB),h=i.s<<n&i.DM;for(r=i.t-1;r>=0;--r)e[r+a+1]=i[r]>>s|h,h=(i[r]&o)<<n;for(r=a-1;r>=0;--r)e[r]=0;e[a]=h,e.t=i.t+a+1,e.s=i.s,e.clamp()},w.rShiftTo=function(t,e){var r=this;e.s=r.s;var i=Math.floor(t/r.DB);if(i>=r.t)e.t=0;else{var n=t%r.DB,s=r.DB-n,o=(1<<n)-1;e[0]=r[i]>>n;for(var a=i+1;a<r.t;++a)e[a-i-1]|=(r[a]&o)<<s,e[a-i]=r[a]>>n;n>0&&(e[r.t-i-1]|=(r.s&o)<<s),e.t=r.t-i,e.clamp()}},w.subTo=function(t,e){for(var r=this,i=0,n=0,s=Math.min(t.t,r.t);i<s;)n+=r[i]-t[i],e[i++]=n&r.DM,n>>=r.DB;if(t.t<r.t){for(n-=t.s;i<r.t;)n+=r[i],e[i++]=n&r.DM,n>>=r.DB;n+=r.s}else{for(n+=r.s;i<t.t;)n-=t[i],e[i++]=n&r.DM,n>>=r.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e[i++]=r.DV+n:n>0&&(e[i++]=n),e.t=i,e.clamp()},w.multiplyTo=function(t,r){var i=this.abs(),n=t.abs(),s=i.t;for(r.t=s+n.t;--s>=0;)r[s]=0;for(s=0;s<n.t;++s)r[s+i.t]=i.am(0,n[s],r,s,0,i.t);r.s=0,r.clamp(),this.s!=t.s&&e.ZERO.subTo(r,r)},w.squareTo=function(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t[r]=0;for(r=0;r<e.t-1;++r){var i=e.am(r,e[r],t,2*r,0,1);(t[r+e.t]+=e.am(r+1,2*e[r],t,2*r+1,i,e.t-r-1))>=e.DV&&(t[r+e.t]-=e.DV,t[r+e.t+1]=1)}t.t>0&&(t[t.t-1]+=e.am(r,e[r],t,2*r,0,1)),t.s=0,t.clamp()},w.divRemTo=function(t,r,i){var n=this,o=t.abs();if(!(o.t<=0)){var a=n.abs();if(a.t<o.t)return null!=r&&r.fromInt(0),void(null!=i&&n.copyTo(i));null==i&&(i=new e);var h=new e,u=n.s,c=t.s,f=n.DB-s(o[o.t-1]);f>0?(o.lShiftTo(f,h),a.lShiftTo(f,i)):(o.copyTo(h),a.copyTo(i));var l=h.t,g=h[l-1];if(0!=g){var p=g*(1<<n.F1)+(l>1?h[l-2]>>n.F2:0),d=n.FV/p,F=(1<<n.F1)/p,v=1<<n.F2,y=i.t,m=y-l,b=null==r?new e:r;for(h.dlShiftTo(m,b),i.compareTo(b)>=0&&(i[i.t++]=1,i.subTo(b,i)),e.ONE.dlShiftTo(l,b),b.subTo(h,h);h.t<l;)h[h.t++]=0;for(;--m>=0;){var A=i[--y]==g?n.DM:Math.floor(i[y]*d+(i[y-1]+v)*F);if((i[y]+=h.am(0,A,i,m,0,l))<A)for(h.dlShiftTo(m,b),i.subTo(b,i);i[y]<--A;)i.subTo(b,i)}null!=r&&(i.drShiftTo(l,r),u!=c&&e.ZERO.subTo(r,r)),i.t=l,i.clamp(),f>0&&i.rShiftTo(f,i),u<0&&e.ZERO.subTo(i,i)}}},w.invDigit=function(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var e=3&t;return e=e*(2-(15&t)*e)&15,e=e*(2-(255&t)*e)&255,e=e*(2-((65535&t)*e&65535))&65535,(e=e*(2-t*e%this.DV)%this.DV)>0?this.DV-e:-e},w.isEven=function(){return 0==(this.t>0?1&this[0]:this.s)},w.exp=function(t,r){if(t>4294967295||t<1)return e.ONE;var i=new e,n=new e,o=r.convert(this),a=s(t)-1;for(o.copyTo(i);--a>=0;)if(r.sqrTo(i,n),(t&1<<a)>0)r.mulTo(n,o,i);else{var h=i;i=n,n=h}return r.revert(i)},w.toString=function(t){var e=this;if(e.s<0)return"-"+e.negate().toString(t);var i;if(16==t)i=4;else if(8==t)i=3;else if(2==t)i=1;else if(32==t)i=5;else{if(4!=t)return e.toRadix(t);i=2}var n,s=(1<<i)-1,o=!1,a="",h=e.t,u=e.DB-h*e.DB%i;if(h-- >0)for(u<e.DB&&(n=e[h]>>u)>0&&(o=!0,a=r(n));h>=0;)u<i?(n=(e[h]&(1<<u)-1)<<i-u,n|=e[--h]>>(u+=e.DB-i)):(n=e[h]>>(u-=i)&s,u<=0&&(u+=e.DB,--h)),n>0&&(o=!0),o&&(a+=r(n));return o?a:"0"},w.negate=function(){var t=new e;return e.ZERO.subTo(this,t),t},w.abs=function(){return this.s<0?this.negate():this},w.compareTo=function(t){var e=this.s-t.s;if(0!=e)return e;var r=this.t;if(0!=(e=r-t.t))return this.s<0?-e:e;for(;--r>=0;)if(0!=(e=this[r]-t[r]))return e;return 0},w.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+s(this[this.t-1]^this.s&this.DM)},w.byteLength=function(){return this.bitLength()>>3},w.mod=function(t){var r=new e;return this.abs().divRemTo(t,null,r),this.s<0&&r.compareTo(e.ZERO)>0&&t.subTo(r,r),r},w.modPowInt=function(t,r){if(t>4294967295||t<1)return e.ONE;for(var i=t.toString(2),n=i.length,s=new Array,o=0;o<n;o++){var a;a=0==o?this.mod(r):s[o-1].multiply(s[o-1]).mod(r),s.push(a)}for(var h,o=0;o<n;o++)1==parseInt(i.charAt(n-o-1))&&(h=void 0==h?s[o]:h.multiply(s[o]).mod(r));return h},p.prototype.convert=d,p.prototype.revert=d,p.prototype.mulTo=function(t,e,r){t.multiplyTo(e,r)},p.prototype.sqrTo=function(t,e){t.squareTo(e)},F.prototype.convert=function(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var r=new e;return t.copyTo(r),this.reduce(r),r},F.prototype.revert=function(t){return t},F.prototype.reduce=function(t){var e=this;for(t.drShiftTo(e.m.t-1,e.r2),t.t>e.m.t+1&&(t.t=e.m.t+1,t.clamp()),e.mu.multiplyUpperTo(e.r2,e.m.t+1,e.q3),e.m.multiplyLowerTo(e.q3,e.m.t+1,e.r2);t.compareTo(e.r2)<0;)t.dAddOffset(1,e.m.t+1);for(t.subTo(e.r2,t);t.compareTo(e.m)>=0;)t.subTo(e.m,t)},F.prototype.mulTo=function(t,e,r){t.multiplyTo(e,r),this.reduce(r)},F.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)};var K=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],O=(1<<26)/K[K.length-1];w.chunkSize=function(t){return Math.floor(Math.LN2*this.DB/Math.log(t))},w.toRadix=function(t){if(null==t&&(t=10),0==this.signum()||t<2||t>36)return"0";var r=this.chunkSize(t),i=Math.pow(t,r),s=n(i),o=new e,a=new e,h="";for(this.divRemTo(s,o,a);o.signum()>0;)h=(i+a.intValue()).toString(t).substr(1)+h,o.divRemTo(s,o,a);return a.intValue().toString(t)+h},w.fromRadix=function(t,r){var n=this;n.fromInt(0),null==r&&(r=10);for(var s=n.chunkSize(r),o=Math.pow(r,s),a=!1,h=0,u=0,c=0;c<t.length;++c){var f=i(t,c);f<0?"-"==t.charAt(c)&&0==n.signum()&&(a=!0):(u=r*u+f,++h>=s&&(n.dMultiply(o),n.dAddOffset(u,0),h=0,u=0))}h>0&&(n.dMultiply(Math.pow(r,h)),n.dAddOffset(u,0)),a&&e.ZERO.subTo(n,n)},w.fromNumber=function(t,r,i){var n=this;if("number"==typeof r)if(t<2)n.fromInt(1);else for(n.fromNumber(t,i),n.testBit(t-1)||n.bitwiseTo(e.ONE.shiftLeft(t-1),u,n),n.isEven()&&n.dAddOffset(1,0);!n.isProbablePrime(r);)n.dAddOffset(2,0),n.bitLength()>t&&n.subTo(e.ONE.shiftLeft(t-1),n);else{var s=new Array,o=7&t;s.length=1+(t>>3),r.nextBytes(s),o>0?s[0]&=(1<<o)-1:s[0]=0,n.fromString(s,256)}},w.bitwiseTo=function(t,e,r){var i,n,s=this,o=Math.min(t.t,s.t);for(i=0;i<o;++i)r[i]=e(s[i],t[i]);if(t.t<s.t){for(n=t.s&s.DM,i=o;i<s.t;++i)r[i]=e(s[i],n);r.t=s.t}else{for(n=s.s&s.DM,i=o;i<t.t;++i)r[i]=e(n,t[i]);r.t=t.t}r.s=e(s.s,t.s),r.clamp()},w.changeBit=function(t,r){var i=e.ONE.shiftLeft(t);return this.bitwiseTo(i,r,i),i},w.addTo=function(t,e){for(var r=this,i=0,n=0,s=Math.min(t.t,r.t);i<s;)n+=r[i]+t[i],e[i++]=n&r.DM,n>>=r.DB;if(t.t<r.t){for(n+=t.s;i<r.t;)n+=r[i],e[i++]=n&r.DM,n>>=r.DB;n+=r.s}else{for(n+=r.s;i<t.t;)n+=t[i],e[i++]=n&r.DM,n>>=r.DB;n+=t.s}e.s=n<0?-1:0,n>0?e[i++]=n:n<-1&&(e[i++]=r.DV+n),e.t=i,e.clamp()},w.dMultiply=function(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()},w.dAddOffset=function(t,e){if(0!=t){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}},w.multiplyLowerTo=function(t,e,r){var i=Math.min(this.t+t.t,e);for(r.s=0,r.t=i;i>0;)r[--i]=0;var n;for(n=r.t-this.t;i<n;++i)r[i+this.t]=this.am(0,t[i],r,i,0,this.t);for(n=Math.min(t.t,e);i<n;++i)this.am(0,t[i],r,i,0,e-i);r.clamp()},w.multiplyUpperTo=function(t,e,r){--e;var i=r.t=this.t+t.t-e;for(r.s=0;--i>=0;)r[i]=0;for(i=Math.max(e-this.t,0);i<t.t;++i)r[this.t+i-e]=this.am(e-i,t[i],r,0,0,this.t+i-e);r.clamp(),r.drShiftTo(1,r)},w.modInt=function(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(0==e)r=this[0]%t;else for(var i=this.t-1;i>=0;--i)r=(e*r+this[i])%t;return r},w.millerRabin=function(t){var r=this.subtract(e.ONE),i=r.getLowestSetBit();if(i<=0)return!1;var n=r.shiftRight(i);(t=t+1>>1)>K.length&&(t=K.length);for(var s=new e(null),o=[],a=0;a<t;++a){for(;u=K[Math.floor(Math.random()*K.length)],-1!=o.indexOf(u););o.push(u),s.fromInt(u);var h=s.modPow(n,this);if(0!=h.compareTo(e.ONE)&&0!=h.compareTo(r)){for(var u=1;u++<i&&0!=h.compareTo(r);)if(0==(h=h.modPowInt(2,this)).compareTo(e.ONE))return!1;if(0!=h.compareTo(r))return!1}}return!0},w.clone=function(){var t=new e;return this.copyTo(t),t},w.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},w.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},w.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},w.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},w.toByteArray=function(){var t=this,e=t.t,r=new Array;r[0]=t.s;var i,n=t.DB-e*t.DB%8,s=0;if(e-- >0)for(n<t.DB&&(i=t[e]>>n)!=(t.s&t.DM)>>n&&(r[s++]=i|t.s<<t.DB-n);e>=0;)n<8?(i=(t[e]&(1<<n)-1)<<8-n,i|=t[--e]>>(n+=t.DB-8)):(i=t[e]>>(n-=8)&255,n<=0&&(n+=t.DB,--e)),0!=(128&i)&&(i|=-256),0===s&&(128&t.s)!=(128&i)&&++s,(s>0||i!=t.s)&&(r[s++]=i);return r},w.equals=function(t){return 0==this.compareTo(t)},w.min=function(t){return this.compareTo(t)<0?this:t},w.max=function(t){return this.compareTo(t)>0?this:t},w.and=function(t){var r=new e;return this.bitwiseTo(t,h,r),r},w.or=function(t){var r=new e;return this.bitwiseTo(t,u,r),r},w.xor=function(t){var r=new e;return this.bitwiseTo(t,c,r),r},w.andNot=function(t){var r=new e;return this.bitwiseTo(t,f,r),r},w.not=function(){for(var t=new e,r=0;r<this.t;++r)t[r]=this.DM&~this[r];return t.t=this.t,t.s=~this.s,t},w.shiftLeft=function(t){var r=new e;return t<0?this.rShiftTo(-t,r):this.lShiftTo(t,r),r},w.shiftRight=function(t){var r=new e;return t<0?this.lShiftTo(-t,r):this.rShiftTo(t,r),r},w.getLowestSetBit=function(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+l(this[t]);return this.s<0?this.t*this.DB:-1},w.bitCount=function(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=g(this[r]^e);return t},w.testBit=function(t){var e=Math.floor(t/this.DB);return e>=this.t?0!=this.s:0!=(this[e]&1<<t%this.DB)},w.setBit=function(t){return this.changeBit(t,u)},w.clearBit=function(t){return this.changeBit(t,f)},w.flipBit=function(t){return this.changeBit(t,c)},w.add=function(t){var r=new e;return this.addTo(t,r),r},w.subtract=function(t){var r=new e;return this.subTo(t,r),r},w.multiply=function(t){var r=new e;return this.multiplyTo(t,r),r},w.divide=function(t){var r=new e;return this.divRemTo(t,r,null),r},w.remainder=function(t){var r=new e;return this.divRemTo(t,null,r),r},w.divideAndRemainder=function(t){var r=new e,i=new e;return this.divRemTo(t,r,i),new Array(r,i)},w.modPow=function(t,r){var i,h,u=t.bitLength(),c=n(1);if(u<=0)return c;i=u<18?1:u<48?3:u<144?4:u<768?5:6,h=u<8?new o(r):r.isEven()?new F(r):new a(r);var f=new Array,l=3,g=i-1,p=(1<<i)-1;if(f[1]=h.convert(this),i>1){var d=new e;for(h.sqrTo(f[1],d);l<=p;)f[l]=new e,h.mulTo(d,f[l-2],f[l]),l+=2}var v,y,m=t.t-1,b=!0,A=new e;for(u=s(t[m])-1;m>=0;){for(u>=g?v=t[m]>>u-g&p:(v=(t[m]&(1<<u+1)-1)<<g-u,m>0&&(v|=t[m-1]>>this.DB+u-g)),l=i;0==(1&v);)v>>=1,--l;if((u-=l)<0&&(u+=this.DB,--m),b)f[v].copyTo(c),b=!1;else{for(;l>1;)h.sqrTo(c,A),h.sqrTo(A,c),l-=2;l>0?h.sqrTo(c,A):(y=c,c=A,A=y),h.mulTo(A,f[v],c)}for(;m>=0&&0==(t[m]&1<<u);)h.sqrTo(c,A),y=c,c=A,A=y,--u<0&&(u=this.DB-1,--m)}return h.revert(c)},w.modInverse=function(t){var r=t.isEven();if(0===this.signum())throw new Error("division by zero");if(this.isEven()&&r||0==t.signum())return e.ZERO;for(var i=t.clone(),s=this.clone(),o=n(1),a=n(0),h=n(0),u=n(1);0!=i.signum();){for(;i.isEven();)i.rShiftTo(1,i),r?(o.isEven()&&a.isEven()||(o.addTo(this,o),a.subTo(t,a)),o.rShiftTo(1,o)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);for(;s.isEven();)s.rShiftTo(1,s),r?(h.isEven()&&u.isEven()||(h.addTo(this,h),u.subTo(t,u)),h.rShiftTo(1,h)):u.isEven()||u.subTo(t,u),u.rShiftTo(1,u);i.compareTo(s)>=0?(i.subTo(s,i),r&&o.subTo(h,o),a.subTo(u,a)):(s.subTo(i,s),r&&h.subTo(o,h),u.subTo(a,u))}if(0!=s.compareTo(e.ONE))return e.ZERO;for(;u.compareTo(t)>=0;)u.subTo(t,u);for(;u.signum()<0;)u.addTo(t,u);return u},w.pow=function(t){return this.exp(t,new p)},w.gcd=function(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var i=e;e=r,r=i}var n=e.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return e;for(n<s&&(s=n),s>0&&(e.rShiftTo(s,e),r.rShiftTo(s,r));e.signum()>0;)(n=e.getLowestSetBit())>0&&e.rShiftTo(n,e),(n=r.getLowestSetBit())>0&&r.rShiftTo(n,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r},w.isProbablePrime=function(t){var e,r=this.abs();if(1==r.t&&r[0]<=K[K.length-1]){for(e=0;e<K.length;++e)if(r[0]==K[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<K.length;){for(var i=K[e],n=e+1;n<K.length&&i<O;)i*=K[n++];for(i=r.modInt(i);e<n;)if(i%K[e++]==0)return!1}return r.millerRabin(t)},w.square=function(){var t=new e;return this.squareTo(t),t},e.ZERO=n(0),e.ONE=n(1),v.prototype.init=function(t){var e,r,i;for(e=0;e<256;++e)this.S[e]=e;for(r=0,e=0;e<256;++e)r=r+this.S[e]+t[e%t.length]&255,i=this.S[e],this.S[e]=this.S[r],this.S[r]=i;this.i=0,this.j=0},v.prototype.next=function(){var t;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,t=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=t,this.S[t+this.S[this.i]&255]};var U,H;if(null==U){U=new Array,H=0;var N,k=new Array(256);for(N=0;N<k.length;++N)k[N]=Math.random(10),U[H++]=255&k[N]}y.prototype.nextBytes=function(t){for(var e,r=0;r<t.length;r++)e=987654071*function(t){var t=t,e=987654321,r=4294967295;return function(){var i=((e=36969*(65535&e)+(e>>16)&r)<<16)+(t=18e3*(65535&t)+(t>>16)&r)&r;return i/=4294967296,(i+=.5)*(Math.random()>.5?1:-1)}}(4294967296*(e||Math.random()))(),t[r]=255&e;return t},S.prototype.pkcs1pad2=A,S.prototype.sign=function(t){var e=A(t,this.n.bitLength()+7>>3,"sign");if(null==e)return null;var r=this.doPrivate(e);if(null==r)return null;var i=r.toString(16);return 0==(1&i.length)?i:"0"+i},S.prototype.verify=function(t,e){var r=m(t,16),i=this.doPublic(r);return null==i?null:E(i,this.n.bitLength()+7>>3).toString()===e.toString()},S.prototype.doPublic=function(t){return t.modPowInt(this.e,this.n)},S.prototype.setPublic=function(t,e){null!=t&&null!=e&&t.length>0&&e.length>0?(this.n=m(t,16),this.e=parseInt(e,16)):UnionLogger.set("Invalid RSA public key")},S.prototype.encrypt=function(t){var e=this.n.bitLength()+7>>3,r=A(t,e);if(null==r)return null;var i=this.doPublic(r);if(null==i)return null;var n=i.toString(16);return n.length<2*e?"0000000000000000000000000000000".substring(0,2*e-n.length)+n:n},S.prototype.doPrivate=function(t){if(null==this.p||null==this.q)return t.modPow(this.d,this.n);for(var e=t.mod(this.p).modPow(this.dmp1,this.p),r=t.mod(this.q).modPow(this.dmq1,this.q);e.compareTo(r)<0;)e=e.add(this.p);return e.subtract(r).multiply(this.coeff).mod(this.p).multiply(this.q).add(r)},S.prototype.setPrivate=function(t,e,r){null!=t&&null!=e&&t.length>0&&e.length>0?(this.n=m(t,16),this.e=parseInt(e,16),this.d=m(r,16)):UnionLogger.set("Invalid RSA private key")},S.prototype.setPrivateEx=function(t,e,r,i,n,s,o,a){null!=t&&null!=e&&t.length>0&&e.length>0?(this.n=m(t,16),this.e=parseInt(e,16),this.d=m(r,16),this.p=m(i,16),this.q=m(n,16),this.dmp1=m(s,16),this.dmq1=m(o,16),this.coeff=m(a,16)):UnionLogger.set("Invalid RSA private key")},S.prototype.generate=function(t,r){var i=new y,n=t>>1;this.e=parseInt(r,16);for(var s=new e(r,16);;){for(;this.p=new e(t-n,1,i),0!=this.p.subtract(e.ONE).gcd(s).compareTo(e.ONE)||!this.p.isProbablePrime(10););for(;this.q=new e(n,1,i),0!=this.q.subtract(e.ONE).gcd(s).compareTo(e.ONE)||!this.q.isProbablePrime(10););if(this.p.compareTo(this.q)<=0){var o=this.p;this.p=this.q,this.q=o}var a=this.p.subtract(e.ONE),h=this.q.subtract(e.ONE),u=a.multiply(h);if(0==u.gcd(s).compareTo(e.ONE)){this.n=this.p.multiply(this.q),this.d=s.modInverse(u),this.dmp1=this.d.mod(a),this.dmq1=this.d.mod(h),this.coeff=this.q.modInverse(this.p);break}}},S.prototype.decrypt=function(t){var e=m(t,16),r=this.doPrivate(e);return null==r?null:E(r,this.n.bitLength()+7>>3)},function(){S.prototype.generateAsync=function(t,r,i){var n=new y,s=t>>1;this.e=parseInt(r,16);var o=new e(r,16),a=this,h=function(){var r=function(){if(a.p.compareTo(a.q)<=0){var t=a.p;a.p=a.q,a.q=t}var r=a.p.subtract(e.ONE),n=a.q.subtract(e.ONE),s=r.multiply(n);0==s.gcd(o).compareTo(e.ONE)?(a.n=a.p.multiply(a.q),a.d=o.modInverse(s),a.dmp1=a.d.mod(r),a.dmq1=a.d.mod(n),a.coeff=a.q.modInverse(a.p),setTimeout(function(){i()},0)):setTimeout(h,0)},u=function(){a.q=nbi(),a.q.fromNumberAsync(s,1,n,function(){a.q.subtract(e.ONE).gcda(o,function(t){0==t.compareTo(e.ONE)&&a.q.isProbablePrime(10)?setTimeout(r,0):setTimeout(u,0)})})},c=function(){a.p=nbi(),a.p.fromNumberAsync(t-s,1,n,function(){a.p.subtract(e.ONE).gcda(o,function(t){0==t.compareTo(e.ONE)&&a.p.isProbablePrime(10)?setTimeout(u,0):setTimeout(c,0)})})};setTimeout(c,0)};setTimeout(h,0)};e.prototype.gcda=function(t,e){var r=this.s<0?this.negate():this.clone(),i=t.s<0?t.negate():t.clone();if(r.compareTo(i)<0){var n=r;r=i,i=n}var s=r.getLowestSetBit(),o=i.getLowestSetBit();if(o<0)e(r);else{s<o&&(o=s),o>0&&(r.rShiftTo(o,r),i.rShiftTo(o,i));var a=function(){(s=r.getLowestSetBit())>0&&r.rShiftTo(s,r),(s=i.getLowestSetBit())>0&&i.rShiftTo(s,i),r.compareTo(i)>=0?(r.subTo(i,r),r.rShiftTo(1,r)):(i.subTo(r,i),i.rShiftTo(1,i)),r.signum()>0?setTimeout(a,0):(o>0&&i.lShiftTo(o,i),setTimeout(function(){e(i)},0))};setTimeout(a,10)}};e.prototype.fromNumberAsync=function(t,r,i,n){if("number"==typeof r)if(t<2)this.fromInt(1);else{this.fromNumber(t,i),this.testBit(t-1)||this.bitwiseTo(e.ONE.shiftLeft(t-1),u,this),this.isEven()&&this.dAddOffset(1,0);var s=this,o=function(){s.dAddOffset(2,0),s.bitLength()>t&&s.subTo(e.ONE.shiftLeft(t-1),s),s.isProbablePrime(r)?setTimeout(function(){n()},0):setTimeout(o,0)};setTimeout(o,0)}else{var a=new Array,h=7&t;a.length=1+(t>>3),r.nextBytes(a),h>0?a[0]&=(1<<h)-1:a[0]=0,this.fromString(a,256)}}}();var M="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",P="=",J=J||{};J.env=J.env||{};var _=J,L=Object.prototype;J.extend=function(t,e,r){if(!e||!t)throw new Error("extend failed, please check that all dependencies are included.");var i,n=function(){};if(n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.superclass=e.prototype,e.prototype.constructor==L.constructor&&(e.prototype.constructor=e),r){for(i in r)_.hasOwnProperty(r,i)&&(t.prototype[i]=r[i]);_._IEEnumFix(t.prototype,r)}},"undefined"!=typeof KJUR&&KJUR||(KJUR={}),void 0!==KJUR.asn1&&KJUR.asn1||(KJUR.asn1={}),KJUR.asn1.ASN1Util=new function(){this.integerToByteHex=function(t){var e=t.toString(16);return e.length%2==1&&(e="0"+e),e},this.bigIntToMinTwosComplementsHex=function(t){var r=t.toString(16);if("-"!=r.substr(0,1))r.length%2==1?r="0"+r:r.match(/^[0-7]/)||(r="00"+r);else{var i=r.substr(1).length;i%2==1?i+=1:r.match(/^[0-7]/)||(i+=2);for(var n="",s=0;s<i;s++)n+="f";r=new e(n,16).xor(t).add(e.ONE).toString(16).replace(/^-/,"")}return r},this.getPEMStringFromHex=function(t,e){var r=T.enc.Hex.parse(t),i=T.enc.Base64.stringify(r).replace(/(.{64})/g,"$1\r\n");return i=i.replace(/\r\n$/,""),"-----BEGIN "+e+"-----\r\n"+i+"\r\n-----END "+e+"-----\r\n"}},KJUR.asn1.ASN1Object=function(){this.getLengthHexFromValue=function(){if(void 0===this.hV||null==this.hV)throw"this.hV is null or undefined.";if(this.hV.length%2==1)throw"value hex must be even length: n="+"".length+",v="+this.hV;var t=this.hV.length/2,e=t.toString(16);if(e.length%2==1&&(e="0"+e),t<128)return e;var r=e.length/2;if(r>15)throw"ASN.1 length too long to represent by 8x: n = "+t.toString(16);return(128+r).toString(16)+e},this.getEncodedHex=function(){return(null==this.hTLV||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getValueHex=function(){return this.getEncodedHex(),this.hV},this.getFreshValueHex=function(){return""}},KJUR.asn1.DERAbstractString=function(t){KJUR.asn1.DERAbstractString.superclass.constructor.call(this);this.getString=function(){return this.s},this.setString=function(t){this.hTLV=null,this.isModified=!0,this.s=t,this.hV=stohex(this.s)},this.setStringHex=function(t){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.getFreshValueHex=function(){return this.hV},void 0!==t&&(void 0!==t.str?this.setString(t.str):void 0!==t.hex&&this.setStringHex(t.hex))},J.extend(KJUR.asn1.DERAbstractString,KJUR.asn1.ASN1Object),KJUR.asn1.DERAbstractTime=function(t){KJUR.asn1.DERAbstractTime.superclass.constructor.call(this);this.localDateToUTC=function(t){return utc=t.getTime()+6e4*t.getTimezoneOffset(),new Date(utc)},this.formatDate=function(t,e){var r=this.zeroPadding,i=this.localDateToUTC(t),n=String(i.getFullYear());return"utc"==e&&(n=n.substr(2,2)),n+r(String(i.getMonth()+1),2)+r(String(i.getDate()),2)+r(String(i.getHours()),2)+r(String(i.getMinutes()),2)+r(String(i.getSeconds()),2)+"Z"},this.zeroPadding=function(t,e){return t.length>=e?t:new Array(e-t.length+1).join("0")+t},this.getString=function(){return this.s},this.setString=function(t){this.hTLV=null,this.isModified=!0,this.s=t,this.hV=stohex(this.s)},this.setByDateValue=function(t,e,r,i,n,s){var o=new Date(Date.UTC(t,e-1,r,i,n,s,0));this.setByDate(o)},this.getFreshValueHex=function(){return this.hV}},J.extend(KJUR.asn1.DERAbstractTime,KJUR.asn1.ASN1Object),KJUR.asn1.DERAbstractStructured=function(t){KJUR.asn1.DERAbstractString.superclass.constructor.call(this);this.setByASN1ObjectArray=function(t){this.hTLV=null,this.isModified=!0,this.asn1Array=t},this.appendASN1Object=function(t){this.hTLV=null,this.isModified=!0,this.asn1Array.push(t)},this.asn1Array=new Array,void 0!==t&&void 0!==t.array&&(this.asn1Array=t.array)},J.extend(KJUR.asn1.DERAbstractStructured,KJUR.asn1.ASN1Object),KJUR.asn1.DERBoolean=function(){KJUR.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV="0101ff"},J.extend(KJUR.asn1.DERBoolean,KJUR.asn1.ASN1Object),KJUR.asn1.DERInteger=function(t){KJUR.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.setByBigInteger=function(t){this.hTLV=null,this.isModified=!0,this.hV=KJUR.asn1.ASN1Util.bigIntToMinTwosComplementsHex(t)},this.setByInteger=function(t){var r=new e(String(t),10);this.setByBigInteger(r)},this.setValueHex=function(t){this.hV=t},this.getFreshValueHex=function(){return this.hV},void 0!==t&&(void 0!==t.bigint?this.setByBigInteger(t.bigint):void 0!==t.int?this.setByInteger(t.int):void 0!==t.hex&&this.setValueHex(t.hex))},J.extend(KJUR.asn1.DERInteger,KJUR.asn1.ASN1Object),KJUR.asn1.DERBitString=function(t){KJUR.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(t){this.hTLV=null,this.isModified=!0,this.hV=t},this.setUnusedBitsAndHexValue=function(t,e){if(t<0||7<t)throw"unused bits shall be from 0 to 7: u = "+t;var r="0"+t;this.hTLV=null,this.isModified=!0,this.hV=r+e},this.setByBinaryString=function(t){var e=8-(t=t.replace(/0+$/,"")).length%8;8==e&&(e=0);for(i=0;i<=e;i++)t+="0";for(var r="",i=0;i<t.length-1;i+=8){var n=t.substr(i,8),s=parseInt(n,2).toString(16);1==s.length&&(s="0"+s),r+=s}this.hTLV=null,this.isModified=!0,this.hV="0"+e+r},this.setByBooleanArray=function(t){for(var e="",r=0;r<t.length;r++)1==t[r]?e+="1":e+="0";this.setByBinaryString(e)},this.newFalseArray=function(t){for(var e=new Array(t),r=0;r<t;r++)e[r]=!1;return e},this.getFreshValueHex=function(){return this.hV},void 0!==t&&(void 0!==t.hex?this.setHexValueIncludingUnusedBits(t.hex):void 0!==t.bin?this.setByBinaryString(t.bin):void 0!==t.array&&this.setByBooleanArray(t.array))},J.extend(KJUR.asn1.DERBitString,KJUR.asn1.ASN1Object),KJUR.asn1.DEROctetString=function(t){KJUR.asn1.DEROctetString.superclass.constructor.call(this,t),this.hT="04"},J.extend(KJUR.asn1.DEROctetString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERNull=function(){KJUR.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},J.extend(KJUR.asn1.DERNull,KJUR.asn1.ASN1Object),KJUR.asn1.DERObjectIdentifier=function(t){var r=function(t){var e=t.toString(16);return 1==e.length&&(e="0"+e),e},i=function(t){var i="",n=new e(t,10).toString(2),s=7-n.length%7;7==s&&(s=0);for(var o="",a=0;a<s;a++)o+="0";n=o+n;for(a=0;a<n.length-1;a+=7){var h=n.substr(a,7);a!=n.length-7&&(h="1"+h),i+=r(parseInt(h,2))}return i};KJUR.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(t){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.setValueOidString=function(t){if(!t.match(/^[0-9.]+$/))throw"malformed oid string: "+t;var e="",n=t.split("."),s=40*parseInt(n[0])+parseInt(n[1]);e+=r(s),n.splice(0,2);for(var o=0;o<n.length;o++)e+=i(n[o]);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=e},this.setValueName=function(t){if(void 0===KJUR.asn1.x509.OID.name2oidList[t])throw"DERObjectIdentifier oidName undefined: "+t;var e=KJUR.asn1.x509.OID.name2oidList[t];this.setValueOidString(e)},this.getFreshValueHex=function(){return this.hV},void 0!==t&&(void 0!==t.oid?this.setValueOidString(t.oid):void 0!==t.hex?this.setValueHex(t.hex):void 0!==t.name&&this.setValueName(t.name))},J.extend(KJUR.asn1.DERObjectIdentifier,KJUR.asn1.ASN1Object),KJUR.asn1.DERUTF8String=function(t){KJUR.asn1.DERUTF8String.superclass.constructor.call(this,t),this.hT="0c"},J.extend(KJUR.asn1.DERUTF8String,KJUR.asn1.DERAbstractString),KJUR.asn1.DERNumericString=function(t){KJUR.asn1.DERNumericString.superclass.constructor.call(this,t),this.hT="12"},J.extend(KJUR.asn1.DERNumericString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERPrintableString=function(t){KJUR.asn1.DERPrintableString.superclass.constructor.call(this,t),this.hT="13"},J.extend(KJUR.asn1.DERPrintableString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERTeletexString=function(t){KJUR.asn1.DERTeletexString.superclass.constructor.call(this,t),this.hT="14"},J.extend(KJUR.asn1.DERTeletexString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERIA5String=function(t){KJUR.asn1.DERIA5String.superclass.constructor.call(this,t),this.hT="16"},J.extend(KJUR.asn1.DERIA5String,KJUR.asn1.DERAbstractString),KJUR.asn1.DERUTCTime=function(t){KJUR.asn1.DERUTCTime.superclass.constructor.call(this,t),this.hT="17",this.setByDate=function(t){this.hTLV=null,this.isModified=!0,this.date=t,this.s=this.formatDate(this.date,"utc"),this.hV=stohex(this.s)},void 0!==t&&(void 0!==t.str?this.setString(t.str):void 0!==t.hex?this.setStringHex(t.hex):void 0!==t.date&&this.setByDate(t.date))},J.extend(KJUR.asn1.DERUTCTime,KJUR.asn1.DERAbstractTime),KJUR.asn1.DERGeneralizedTime=function(t){KJUR.asn1.DERGeneralizedTime.superclass.constructor.call(this,t),this.hT="18",this.setByDate=function(t){this.hTLV=null,this.isModified=!0,this.date=t,this.s=this.formatDate(this.date,"gen"),this.hV=stohex(this.s)},void 0!==t&&(void 0!==t.str?this.setString(t.str):void 0!==t.hex?this.setStringHex(t.hex):void 0!==t.date&&this.setByDate(t.date))},J.extend(KJUR.asn1.DERGeneralizedTime,KJUR.asn1.DERAbstractTime),KJUR.asn1.DERSequence=function(t){KJUR.asn1.DERSequence.superclass.constructor.call(this,t),this.hT="30",this.getFreshValueHex=function(){for(var t="",e=0;e<this.asn1Array.length;e++)t+=this.asn1Array[e].getEncodedHex();return this.hV=t,this.hV}},J.extend(KJUR.asn1.DERSequence,KJUR.asn1.DERAbstractStructured),KJUR.asn1.DERSet=function(t){KJUR.asn1.DERSet.superclass.constructor.call(this,t),this.hT="31",this.getFreshValueHex=function(){for(var t=new Array,e=0;e<this.asn1Array.length;e++){var r=this.asn1Array[e];t.push(r.getEncodedHex())}return t.sort(),this.hV=t.join(""),this.hV}},J.extend(KJUR.asn1.DERSet,KJUR.asn1.DERAbstractStructured),KJUR.asn1.DERTaggedObject=function(t){KJUR.asn1.DERTaggedObject.superclass.constructor.call(this),this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.setASN1Object=function(t,e,r){this.hT=e,this.isExplicit=t,this.asn1Object=r,this.isExplicit?(this.hV=this.asn1Object.getEncodedHex(),this.hTLV=null,this.isModified=!0):(this.hV=null,this.hTLV=r.getEncodedHex(),this.hTLV=this.hTLV.replace(/^../,e),this.isModified=!1)},this.getFreshValueHex=function(){return this.hV},void 0!==t&&(void 0!==t.tag&&(this.hT=t.tag),void 0!==t.explicit&&(this.isExplicit=t.explicit),void 0!==t.obj&&(this.asn1Object=t.obj,this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)))},J.extend(KJUR.asn1.DERTaggedObject,KJUR.asn1.ASN1Object),function(t){"use strict";var e,r={};r.decode=function(t){var r;if(void 0===e){var i="0123456789ABCDEF",n=" \f\n\r\t\u2028\u2029";for(e=[],r=0;r<16;++r)e[i.charAt(r)]=r;for(i=i.toLowerCase(),r=10;r<16;++r)e[i.charAt(r)]=r;for(r=0;r<n.length;++r)e[n.charAt(r)]=-1}var s=[],o=0,a=0;for(r=0;r<t.length;++r){var h=t.charAt(r);if("="==h)break;if(-1!=(h=e[h])){if(void 0===h)throw"Illegal character at offset "+r;o|=h,++a>=2?(s[s.length]=o,o=0,a=0):o<<=4}}if(a)throw"Hex encoding incomplete: 4 bits missing";return s},t.UnionHex=r}(this),function(t){"use strict";var e,r={};r.decode=function(t){var r;if(void 0===e){var i="= \f\n\r\t\u2028\u2029";for(e=[],r=0;r<64;++r)e["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(r)]=r;for(r=0;r<i.length;++r)e[i.charAt(r)]=-1}var n=[],s=0,o=0;for(r=0;r<t.length;++r){var a=t.charAt(r);if("="==a)break;if(-1!=(a=e[a])){if(void 0===a)throw"Illegal character at offset "+r;s|=a,++o>=4?(n[n.length]=s>>16,n[n.length]=s>>8&255,n[n.length]=255&s,s=0,o=0):s<<=6}}switch(o){case 1:throw"Base64 encoding incomplete: at least 2 bits missing";case 2:n[n.length]=s>>10;break;case 3:n[n.length]=s>>16,n[n.length]=s>>8&255}return n},r.re=/-----BEGIN [^-]+-----([A-Za-z0-9+\/=\s]+)-----END [^-]+-----|begin-base64[^\n]+\n([A-Za-z0-9+\/=\s]+)====/,r.unarmor=function(t){var e=r.re.exec(t);if(e)if(e[1])t=e[1];else{if(!e[2])throw"RegExp out of sync";t=e[2]}return r.decode(t)},t.UnionBase64=r}(this),function(t){"use strict";function e(t,r){t instanceof e?(this.enc=t.enc,this.pos=t.pos):(this.enc=t,this.pos=r)}var r={tag:function(t,e){var r=document.createElement(t);return r.className=e,r},text:function(t){return document.createTextNode(t)}};e.prototype.get=function(t){if(void 0===t&&(t=this.pos++),t>=this.enc.length)throw"Requesting byte offset "+t+" on a stream of length "+this.enc.length;return this.enc[t]},e.prototype.hexDigits="0123456789ABCDEF",e.prototype.hexByte=function(t){return this.hexDigits.charAt(t>>4&15)+this.hexDigits.charAt(15&t)},e.prototype.hexDump=function(t,e,r){for(var i="",n=t;n<e;++n)if(i+=this.hexByte(this.get(n)),!0!==r)switch(15&n){case 7:i+="  ";break;case 15:i+="\n";break;default:i+=" "}return i},e.prototype.parseStringISO=function(t,e){for(var r="",i=t;i<e;++i)r+=String.fromCharCode(this.get(i));return r},e.prototype.parseStringUTF=function(t,e){for(var r="",i=t;i<e;){var n=this.get(i++);r+=n<128?String.fromCharCode(n):n>191&&n<224?String.fromCharCode((31&n)<<6|63&this.get(i++)):String.fromCharCode((15&n)<<12|(63&this.get(i++))<<6|63&this.get(i++))}return r},e.prototype.parseStringBMP=function(t,e){for(var r="",i=t;i<e;i+=2){var n=this.get(i),s=this.get(i+1);r+=String.fromCharCode((n<<8)+s)}return r},e.prototype.reTime=/^((?:1[89]|2\d)?\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/,e.prototype.parseTime=function(t,e){var r=this.parseStringISO(t,e),i=this.reTime.exec(r);return i?(r=i[1]+"-"+i[2]+"-"+i[3]+" "+i[4],i[5]&&(r+=":"+i[5],i[6]&&(r+=":"+i[6],i[7]&&(r+="."+i[7]))),i[8]&&(r+=" UTC","Z"!=i[8]&&(r+=i[8],i[9]&&(r+=":"+i[9]))),r):"Unrecognized time: "+r},e.prototype.parseInteger=function(t,e){var r=e-t;if(r>4){r<<=3;var i=this.get(t);if(0===i)r-=8;else for(;i<128;)i<<=1,--r;return"("+r+" bit)"}for(var n=0,s=t;s<e;++s)n=n<<8|this.get(s);return n},e.prototype.parseBitString=function(t,e){var r=this.get(t),i=(e-t-1<<3)-r,n="("+i+" bit)";if(i<=20){var s=r;n+=" ";for(var o=e-1;o>t;--o){for(var a=this.get(o),h=s;h<8;++h)n+=a>>h&1?"1":"0";s=0}}return n},e.prototype.parseOctetString=function(t,e){var r=e-t,i="("+r+" byte) ";r>100&&(e=t+100);for(var n=t;n<e;++n)i+=this.hexByte(this.get(n));return r>100&&(i+=""),i},e.prototype.parseOID=function(t,e){for(var r="",i=0,n=0,s=t;s<e;++s){var o=this.get(s);if(i=i<<7|127&o,n+=7,!(128&o)){if(""===r){var a=i<80?i<40?0:1:2;r=a+"."+(i-40*a)}else r+="."+(n>=31?"bigint":i);i=n=0}}return r};var i=function(t,e,r,i,n){this.stream=t,this.header=e,this.length=r,this.tag=i,this.sub=n};i.prototype.typeName=function(){if(void 0===this.tag)return"unknown";var t=this.tag>>6,e=(this.tag,31&this.tag);switch(t){case 0:switch(e){case 0:return"EOC";case 1:return"BOOLEAN";case 2:return"INTEGER";case 3:return"BIT_STRING";case 4:return"OCTET_STRING";case 5:return"NULL";case 6:return"OBJECT_IDENTIFIER";case 7:return"ObjectDescriptor";case 8:return"EXTERNAL";case 9:return"REAL";case 10:return"ENUMERATED";case 11:return"EMBEDDED_PDV";case 12:return"UTF8String";case 16:return"SEQUENCE";case 17:return"SET";case 18:return"NumericString";case 19:return"PrintableString";case 20:return"TeletexString";case 21:return"VideotexString";case 22:return"IA5String";case 23:return"UTCTime";case 24:return"GeneralizedTime";case 25:return"GraphicString";case 26:return"VisibleString";case 27:return"GeneralString";case 28:return"UniversalString";case 30:return"BMPString";default:return"Universal_"+e.toString(16)}case 1:return"Application_"+e.toString(16);case 2:return"["+e+"]";case 3:return"Private_"+e.toString(16)}},i.prototype.reSeemsASCII=/^[ -~]+$/,i.prototype.content=function(){if(void 0===this.tag)return null;var t=this.tag>>6,e=31&this.tag,r=this.posContent(),i=Math.abs(this.length);if(0!==t){if(null!==this.sub)return"("+this.sub.length+" elem)";var n=this.stream.parseStringISO(r,r+Math.min(i,100));return this.reSeemsASCII.test(n)?n.substring(0,200)+(n.length>200?"":""):this.stream.parseOctetString(r,r+i)}switch(e){case 1:return 0===this.stream.get(r)?"false":"true";case 2:return this.stream.parseInteger(r,r+i);case 3:return this.sub?"("+this.sub.length+" elem)":this.stream.parseBitString(r,r+i);case 4:return this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(r,r+i);case 6:return this.stream.parseOID(r,r+i);case 16:case 17:return"("+this.sub.length+" elem)";case 12:return this.stream.parseStringUTF(r,r+i);case 18:case 19:case 20:case 21:case 22:case 26:return this.stream.parseStringISO(r,r+i);case 30:return this.stream.parseStringBMP(r,r+i);case 23:case 24:return this.stream.parseTime(r,r+i)}return null},i.prototype.toString=function(){return this.typeName()+"@"+this.stream.pos+"[header:"+this.header+",length:"+this.length+",sub:"+(null===this.sub?"null":this.sub.length)+"]"},i.prototype.print=function(t){if(void 0===t&&(t=""),document.writeln(t+this),null!==this.sub){t+="  ";for(var e=0,r=this.sub.length;e<r;++e)this.sub[e].print(t)}},i.prototype.toPrettyString=function(t){void 0===t&&(t="");var e=t+this.typeName()+" @"+this.stream.pos;if(this.length>=0&&(e+="+"),e+=this.length,32&this.tag?e+=" (constructed)":3!=this.tag&&4!=this.tag||null===this.sub||(e+=" (encapsulates)"),e+="\n",null!==this.sub){t+="  ";for(var r=0,i=this.sub.length;r<i;++r)e+=this.sub[r].toPrettyString(t)}return e},i.prototype.toDOM=function(){var t=r.tag("div","node");t.asn1=this;var e=r.tag("div","head"),i=this.typeName().replace(/_/g," ");e.innerHTML=i;var n=this.content();if(null!==n){n=String(n).replace(/</g,"&lt;");var s=r.tag("span","preview");s.appendChild(r.text(n)),e.appendChild(s)}t.appendChild(e),this.node=t,this.head=e;var o=r.tag("div","value");if(i="Offset: "+this.stream.pos+"<br/>",i+="Length: "+this.header+"+",this.length>=0?i+=this.length:i+=-this.length+" (undefined)",32&this.tag?i+="<br/>(constructed)":3!=this.tag&&4!=this.tag||null===this.sub||(i+="<br/>(encapsulates)"),null!==n&&(i+="<br/>Value:<br/><b>"+n+"</b>","object"==typeof oids&&6==this.tag)){var a=oids[n];a&&(a.d&&(i+="<br/>"+a.d),a.c&&(i+="<br/>"+a.c),a.w&&(i+="<br/>(warning!)"))}o.innerHTML=i,t.appendChild(o);var h=r.tag("div","sub");if(null!==this.sub)for(var u=0,c=this.sub.length;u<c;++u)h.appendChild(this.sub[u].toDOM());return t.appendChild(h),e.onclick=function(){t.className="node collapsed"==t.className?"node":"node collapsed"},t},i.prototype.posStart=function(){return this.stream.pos},i.prototype.posContent=function(){return this.stream.pos+this.header},i.prototype.posEnd=function(){return this.stream.pos+this.header+Math.abs(this.length)},i.prototype.fakeHover=function(t){this.node.className+=" hover",t&&(this.head.className+=" hover")},i.prototype.fakeOut=function(t){var e=/ ?hover/;this.node.className=this.node.className.replace(e,""),t&&(this.head.className=this.head.className.replace(e,""))},i.prototype.toHexDOM_sub=function(t,e,i,n,s){if(!(n>=s)){var o=r.tag("span",e);o.appendChild(r.text(i.hexDump(n,s))),t.appendChild(o)}},i.prototype.toHexDOM=function(t){var e=r.tag("span","hex");if(void 0===t&&(t=e),this.head.hexNode=e,this.head.onmouseover=function(){this.hexNode.className="hexCurrent"},this.head.onmouseout=function(){this.hexNode.className="hex"},e.asn1=this,e.onmouseover=function(){var e=!t.selected;e&&(t.selected=this.asn1,this.className="hexCurrent"),this.asn1.fakeHover(e)},e.onmouseout=function(){var e=t.selected==this.asn1;this.asn1.fakeOut(e),e&&(t.selected=null,this.className="hex")},this.toHexDOM_sub(e,"tag",this.stream,this.posStart(),this.posStart()+1),this.toHexDOM_sub(e,this.length>=0?"dlen":"ulen",this.stream,this.posStart()+1,this.posContent()),null===this.sub)e.appendChild(r.text(this.stream.hexDump(this.posContent(),this.posEnd())));else if(this.sub.length>0){var i=this.sub[0],n=this.sub[this.sub.length-1];this.toHexDOM_sub(e,"intro",this.stream,this.posContent(),i.posStart());for(var s=0,o=this.sub.length;s<o;++s)e.appendChild(this.sub[s].toHexDOM(t));this.toHexDOM_sub(e,"outro",this.stream,n.posEnd(),this.posEnd())}return e},i.prototype.toHexString=function(t){return this.stream.hexDump(this.posStart(),this.posEnd(),!0)},i.decodeLength=function(t){var e=t.get(),r=127&e;if(r==e)return r;if(r>3)throw"Length over 24 bits not supported at position "+(t.pos-1);if(0===r)return-1;e=0;for(var i=0;i<r;++i)e=e<<8|t.get();return e},i.hasContent=function(t,r,n){if(32&t)return!0;if(t<3||t>4)return!1;var s=new e(n);if(3==t&&s.get(),s.get()>>6&1)return!1;try{var o=i.decodeLength(s);return s.pos-n.pos+o==r}catch(t){return!1}},i.decode=function(t){t instanceof e||(t=new e(t,0));var r=new e(t),n=t.get(),s=i.decodeLength(t),o=t.pos-r.pos,a=null;if(i.hasContent(n,s,t)){var h=t.pos;if(3==n&&t.get(),a=[],s>=0){for(var u=h+s;t.pos<u;)a[a.length]=i.decode(t);if(t.pos!=u)throw"Content size is not correct for container starting at offset "+h}else try{for(;;){var c=i.decode(t);if(0===c.tag)break;a[a.length]=c}s=h-t.pos}catch(t){throw"Exception while decoding undefined length content: "+t}}else t.pos+=s;return new i(r,o,s,n,a)},i.test=function(){for(var t=[{value:[39],expected:39},{value:[129,201],expected:201},{value:[131,254,220,186],expected:16702650}],r=0,n=t.length;r<n;++r){var s=new e(t[r].value,0),o=i.decodeLength(s);o!=t[r].expected&&document.write("In test["+r+"] expected "+t[r].expected+" got "+o+"\n")}},t.ASN1=i}(this),ASN1.prototype.getHexStringValue=function(){var t=this.toHexString(),e=2*this.header,r=2*this.length;return t.substr(e,r)},S.prototype.parseKey=function(t){try{var e,r=0,i=0,n=/^\s*(?:[0-9A-Fa-f][0-9A-Fa-f]\s*)+$/.test(t)?UnionHex.decode(t):UnionBase64.unarmor(t);try{e=ASN1.decode(n)}catch(e){return this.e=65537,this.n=m("00"+t,16),!0}if(3===e.sub.length&&(e=e.sub[2].sub[0]),9===e.sub.length){r=e.sub[1].getHexStringValue(),this.n=m(r,16),i=e.sub[2].getHexStringValue(),this.e=parseInt(i,16);var s=e.sub[3].getHexStringValue();this.d=m(s,16);var o=e.sub[4].getHexStringValue();this.p=m(o,16);var a=e.sub[5].getHexStringValue();this.q=m(a,16);var h=e.sub[6].getHexStringValue();this.dmp1=m(h,16);var u=e.sub[7].getHexStringValue();this.dmq1=m(u,16);var c=e.sub[8].getHexStringValue();this.coeff=m(c,16)}else{if(2!==e.sub.length)return!1;r=e.sub[0].getHexStringValue(),this.n=m(r,16),i=e.sub[1].getHexStringValue(),this.e=parseInt(i,16)}return!0}catch(t){return!1}},S.prototype.getPrivateBaseKey=function(){var t={array:[new KJUR.asn1.DERInteger({int:0}),new KJUR.asn1.DERInteger({bigint:this.n}),new KJUR.asn1.DERInteger({int:this.e}),new KJUR.asn1.DERInteger({bigint:this.d}),new KJUR.asn1.DERInteger({bigint:this.p}),new KJUR.asn1.DERInteger({bigint:this.q}),new KJUR.asn1.DERInteger({bigint:this.dmp1}),new KJUR.asn1.DERInteger({bigint:this.dmq1}),new KJUR.asn1.DERInteger({bigint:this.coeff})]};return new KJUR.asn1.DERSequence(t).getEncodedHex()},S.prototype.getPrivateBaseKeyB64=function(){return B(this.getPrivateBaseKey())},S.prototype.getPublicBaseKey=function(){var t={array:[new KJUR.asn1.DERObjectIdentifier({oid:"1.2.840.113549.1.1.1"}),new KJUR.asn1.DERNull]},e=new KJUR.asn1.DERSequence(t);return t={array:[new KJUR.asn1.DERInteger({bigint:this.n}),new KJUR.asn1.DERInteger({int:this.e})]},t={hex:"00"+new KJUR.asn1.DERSequence(t).getEncodedHex()},t={array:[e,new KJUR.asn1.DERBitString(t)]},new KJUR.asn1.DERSequence(t).getEncodedHex()},S.prototype.getPublicBaseKeyB64=function(){return B(this.getPublicBaseKey())},S.prototype.wordwrap=function(t,e){if(e=e||64,!t)return t;var r="(.{1,"+e+"})( +|$\n?)|(.{1,"+e+"})";return t.match(RegExp(r,"g")).join("\n")},S.prototype.getPrivateKey=function(){var t="-----BEGIN RSA PRIVATE KEY-----\n";return t+=this.wordwrap(this.getPrivateBaseKeyB64())+"\n",t+="-----END RSA PRIVATE KEY-----"},S.prototype.getPublicKey=function(){var t="-----BEGIN PUBLIC KEY-----\n";return t+=this.wordwrap(this.getPublicBaseKeyB64())+"\n",t+="-----END PUBLIC KEY-----"},S.prototype.hasPublicKeyProperty=function(t){return(t=t||{}).hasOwnProperty("n")&&t.hasOwnProperty("e")},S.prototype.hasPrivateKeyProperty=function(t){return(t=t||{}).hasOwnProperty("n")&&t.hasOwnProperty("e")&&t.hasOwnProperty("d")&&t.hasOwnProperty("p")&&t.hasOwnProperty("q")&&t.hasOwnProperty("dmp1")&&t.hasOwnProperty("dmq1")&&t.hasOwnProperty("coeff")},S.prototype.parsePropertiesFrom=function(t){this.n=t.n,this.e=t.e,t.hasOwnProperty("d")&&(this.d=t.d,this.p=t.p,this.q=t.q,this.dmp1=t.dmp1,this.dmq1=t.dmq1,this.coeff=t.coeff)};var q=function(t){S.call(this),t&&("string"==typeof t?this.parseKey(t):(this.hasPrivateKeyProperty(t)||this.hasPublicKeyProperty(t))&&this.parsePropertiesFrom(t))};(q.prototype=new S).constructor=q;var V=function(t){t=t||{},this.default_key_size=parseInt(t.default_key_size)||1024,this.default_public_exponent=t.default_public_exponent||"010001",this.log=t.log||!1,this.key=null};V.prototype.setKey=function(t){this.log&&this.key&&UnionLogger.set("A key was already set, overriding existing."),this.key=new q(t)},V.prototype.setPrivateKey=function(t){this.setKey(t)},V.prototype.setPublicKey=function(t){this.setKey(t)},V.prototype.decrypt=function(t){try{return this.getKey().decrypt(t)}catch(t){return!1}},V.prototype.encrypt=function(t){try{return this.getKey().encrypt(t)}catch(t){return!1}},V.prototype.getKey=function(t){if(!this.key){if(this.key=new q,t&&"[object Function]"==={}.toString.call(t))return void this.key.generateAsync(this.default_key_size,this.default_public_exponent,t);this.key.generate(this.default_key_size,this.default_public_exponent)}return this.key},V.prototype.getPrivateKey=function(){return this.getKey().getPrivateKey()},V.prototype.getPrivateKeyB64=function(){return this.getKey().getPrivateBaseKeyB64()},V.prototype.getPublicKey=function(){return this.getKey().getPublicKey()},V.prototype.pkcs1pad2=function(t,e,r){return this.getKey().pkcs1pad2(t,e,r)},V.prototype.getPublicKeyB64=function(){return this.getKey().getPublicBaseKeyB64()},V.version="2.3.1",t.JSEncrypt=V}(this),function(){var t=R,e=R.algorithm,r=(R.util.Checker,R.util.Hex);R.util.UTF8,R.util.Helper,e.RSA={DEFAULT_PUBLIC_EXPONENT:65537,generate:function(t,e){var i=new JSEncrypt({default_key_size:t,default_public_exponent:e}).getKey();return{publicKey:r.parse(i.getPublicBaseKey()),privateKey:r.parse(i.getPrivateBaseKey())}},encrypt:function(t,e){var i=new JSEncrypt;UnionLogger.set("publicKey : \n"+r.stringify(e)),i.setPublicKey(r.stringify(e));var n=r.parse(i.encrypt(t));return UnionLogger.set("Ciphertext : \n"+r.stringify(n)),n},decrypt:function(t,e){var i=new JSEncrypt;return i.setPrivateKey(r.stringify(e)),i.decrypt(r.stringify(t))},_sign:function(t,e){var i=new JSEncrypt;i.setPrivateKey(r.stringify(e));var n=i.getKey().sign(t);return r.parse(n)},_verify:function(t,e,i){var n=new JSEncrypt;return n.setPublicKey(r.stringify(i)),n.getKey().verify(r.stringify(t),e)},sign:function(i,n,s){if(s.name===t.Hasher.NONE.name)return this._sign(i,n);var o=e[s.name].digest(i),a=r.parse(s.DER_OID).concat(o);return this._sign(a,n)},verify:function(i,n,s,o){if(o.name===t.Hasher.NONE.name)return this._verify(i,n,s);var a=e[o.name].digest(n),h=r.parse(o.DER_OID).concat(a);return this._verify(i,h,s)},pkcs1pad:function(t,e,r){return(new JSEncrypt).getKey().pkcs1pad2(t,e,r)},testKeypair:{publicKey:"308189028181009F43B5203FB2A2E20E97D1A985AA3D86F66274922304E9ED6698BA94B7903AD7F3741EDE9078DF3EBA27FCD1A38F9B608499A7E5CD3EF6FC658BAA231028B40033F3A11AB0B286541CA385B758D4C87D052216B14547B28265AC3243549378ECAAA5CEEAA7CB38DA2F78C3D6634A3BEA1745923E452E3C4ABA0D967D67DCABD50203010001",privateKey:"3082025D020100028181009F43B5203FB2A2E20E97D1A985AA3D86F66274922304E9ED6698BA94B7903AD7F3741EDE9078DF3EBA27FCD1A38F9B608499A7E5CD3EF6FC658BAA231028B40033F3A11AB0B286541CA385B758D4C87D052216B14547B28265AC3243549378ECAAA5CEEAA7CB38DA2F78C3D6634A3BEA1745923E452E3C4ABA0D967D67DCABD502030100010281806B37D1C01C21CEB610CCF44103D3500883E65443ED7F695C812D60AEADC55357FE75B6326F60702A7278692358D15CF0E553EC4C3098AAFDCFFEEE531C95CA5728B4CA81F25CF1B88E476F246882BD311DAD00463DEBAE2F0275F1C4538E9216DB70A19DC78DFE875E7EFE35EBFCFB459DFF9EA821A20178C5FE3EC53571BA21024100CE0D43DDE1383EA9827EF3A5F684573F58FAAE294693A48DC56B77489E0A3E86DE74BDE3D43A684C6F15AB21E5ED2B781CBD880246EA99F2A960079AA715AD13024100C5DF02E9ECAE7A3B268377372BC6EAA67838DFAB6C497FDA1216EDCB7962B6D0AB0D33AA13233B19ACDAB0CA86A165A7B96BF9D995643FA431F74A423650E87702410092D2FAF820E2FE2BB57416D3BCCC628B1E314A66D9069DABF3EFF6C884ECD1CF32B6C7149006AA89446291560F4BA7BCE7E5DA039D5AD0260CB103DA1C932287024100BD0E14019F6321644CAB0587D02AF15DF6B61876F832CD9674FC355DD8EFC94E5C7073B187317D314DE7714D400F0B4A92AE28FD8C7049223F9F4FF32D646687024003D59FD40D99C7A67E33836DB66A933432CBBC34D958BA7E233672EBA6174E7AAEC3AF2821A899A667CBBD48283C7BB59BBF77C8A8232CD9F0F17DBDC2629118"}}}(),function(){var t=R.algorithm;R.util.Helper,t.DES=function(){new Array;var t=[128,64,32,16,8,4,2,1],e=[8388608,4194304,2097152,1048576,524288,262144,131072,65536,32768,16384,8192,4096,2048,1024,512,256,128,64,32,16,8,4,2,1],r=[56,48,40,32,24,16,8,0,57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,60,52,44,36,28,20,12,4,27,19,11,3],i=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],n=[13,16,10,23,0,4,2,27,14,5,20,9,22,18,11,3,25,7,15,6,26,19,12,1,40,51,30,36,46,54,29,39,50,44,32,47,43,48,38,55,33,52,45,41,49,35,28,31],s=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],o=[2148565024,2147516416,32768,1081376,1048576,32,2148532256,2147516448,2147483680,2148565024,2148564992,2147483648,2147516416,1048576,32,2148532256,1081344,1048608,2147516448,0,2147483648,32768,1081376,2148532224,1048608,2147483680,0,1081344,32800,2148564992,2148532224,32800,0,1081376,2148532256,1048576,2147516448,2148532224,2148564992,32768,2148532224,2147516416,32,2148565024,1081376,32,32768,2147483648,32800,2148564992,1048576,2147483680,1048608,2147516448,2147483680,1048608,1081344,0,2147516416,32800,2147483648,2148532256,2148565024,1081344],a=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],h=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],u=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],c=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],f=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],l=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696],g=function(s,o){for(var a=new Array(32),h=new Array(56),u=new Array(56),c=0;c<56;c++){f=r[c];h[c]=0!=(o[f>>>3]&t[7&f])}for(p=0;p<16;p++){var f,l,g;g=(l=s?p<<1:15-p<<1)+1,a[l]=a[g]=0;for(c=0;c<28;c++)f=c+i[p],u[c]=f<28?h[f]:h[f-28];for(c=28;c<56;c++)f=c+i[p],u[c]=f<56?h[f]:h[f-28];for(c=0;c<24;c++)u[n[c]]&&(a[l]|=e[c]),u[n[c+24]]&&(a[g]|=e[c])}for(var p=0;32!=p;p+=2){var d,F;d=a[p],F=a[p+1],a[p]=((16515072&d)<<6|(4032&d)<<10|(16515072&F)>>>10|(4032&F)>>>6)>>>0,a[p+1]=((258048&d)<<12|(63&d)<<16|(258048&F)>>>4|63&F)>>>0}return a},p=function(t,e,r,i,n){var g,p,d;d=((255&e[r+0])<<24|(255&e[r+1])<<16|(255&e[r+2])<<8|255&e[r+3])>>>0,p=((255&e[r+4])<<24|(255&e[r+5])<<16|(255&e[r+6])<<8|255&e[r+7])>>>0,p^=g=252645135&(d>>>4^p),p^=g=65535&((d^=g<<4)>>>16^p),p^=(g=858993459&(p>>>2^(d^=g<<16)))<<2,p=(4294967295&((p^=(g=16711935&(p>>>8^(d^=g)))<<8)<<1|p>>>31&1))>>>0,p^=g=(2863311530&((d^=g)^p))>>>0,d=(4294967295&((d^=g)<<1|d>>>31&1))>>>0;for(var F=0;F<8;F++){var v;g=p<<28|p>>>4,g^=t[4*F+0],v=f[63&g],v|=u[g>>>8&63],v|=a[g>>>16&63],v|=s[g>>>24&63],g=p^t[4*F+1],v|=l[63&g],v|=c[g>>>8&63],v|=h[g>>>16&63],g=(d^=v|=o[g>>>24&63])<<28|d>>>4,g^=t[4*F+2],v=f[63&g],v|=u[g>>>8&63],v|=a[g>>>16&63],v|=s[g>>>24&63],g=d^t[4*F+3],v|=l[63&g],v|=c[g>>>8&63],v|=h[g>>>16&63],p^=v|=o[g>>>24&63]}d=(d^=g=(2863311530&(d^(p=p<<31|p>>>1)))>>>0)<<31|d>>>1,d^=(g=16711935&(d>>>8^(p^=g)))<<8,d^=(g=858993459&(d>>>2^(p^=g)))<<2,d^=g=65535&((p^=g)>>>16^d),d^=g=252645135&((p^=g<<16)>>>4^d),p^=g<<4,i[n+0]=(p>>>24&255)>>>0,i[n+1]=(p>>>16&255)>>>0,i[n+2]=(p>>>8&255)>>>0,i[n+3]=(255&p)>>>0,i[n+4]=(d>>>24&255)>>>0,i[n+5]=(d>>>16&255)>>>0,i[n+6]=(d>>>8&255)>>>0,i[n+7]=(255&d)>>>0},d=function(t,e,r){var i=new Array(8);if(8===r.length){var n=g(t,r);p(n,e,0,i,0)}else{var s,o=g(t,r.slice(0,8)),a=g(!t,r.slice(8,16));s=24===r.length?g(t,r.slice(16,24)):o;var h=new Array(8);t?(p(o,e,0,h,0),p(a,h,0,h,0),p(s,h,0,i,0)):(p(s,e,0,h,0),p(a,h,0,h,0),p(o,h,0,i,0))}return i},F=function(t,e,r,i,n){for(var s=0;s<n;s++)r[s+i]=t[s+e];return t},v=function(t,e){for(var r=new Array(8),i=0;i<8;i++)r[i]=t[i]^e[i];return r};return{BLOCK_SIZE:8,encryptWithECB:function(t,e){for(var r=new Array,i=0,n=t.length;i<n;i+=8)r=r.concat(d(!0,t.slice(i,i+8),e));return r},decryptWithECB:function(t,e){for(var r=new Array,i=0,n=t.length;i<n;i+=8)r=r.concat(d(!1,t.slice(i,i+8),e));return r},encryptWithCBC:function(t,e,r){for(var i=new Array(t.length),n=0;n<t.length;n+=8){var s=t.slice(n,n+8),o=v(s,r),a=new Array(8);a=d(!0,o,e),F(a,0,i,n,8),r=a}return i},decryptWithCBC:function(t,e,r){for(var i=new Array(t.length),n=0;n<t.length;n+=8){var s=t.slice(n,n+8),o=new Array(8);o=d(!1,s,e);var a=v(o,r);r=t.slice(n,n+8),F(a,0,i,n,8)}return i}}}()}(),R.algorithm.MD5=function(){var t,e,r,i,n,s,o,a=new Array(16),h=new Array(4),u=function(t,e){a[n++]=(255&t[e]|(255&t[e+1])<<8|(255&t[e+2])<<16|(255&t[e+3])<<24)>>>0,16===n&&m()},c=function(t){n>14&&m(),a[14]=(4294967295&t)>>>0,a[15]=(0xffffffff00000000&t)>>>32},f=function(t,e,r){e[r+0]=t>>>0&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},l=function(){var t=function(t){h[o++]=t,o===h.length&&(u(h,0),o=0),s++},e=8*s;for(t(128);0!=o;)t(0);c(e),m()},g=function(n,s){return l(),f(t,n,s+0),f(e,n,s+4),f(r,n,s+8),f(i,n,s+12),b(),16},p=function(t,e){return(((t=(4294967295&t)>>>0)<<e&4294967295)>>>0|t>>>32-e&4294967295)>>>0},d=function(t,e,r){return t=(4294967295&t)>>>0,e=(4294967295&e)>>>0,r=(4294967295&r)>>>0,(4294967295&(t&e|~t&r))>>>0},F=function(t,e,r){return t=(4294967295&t)>>>0,e=(4294967295&e)>>>0,r=(4294967295&r)>>>0,(4294967295&(t&r|e&~r))>>>0},v=function(t,e,r){return t=(4294967295&t)>>>0,e=(4294967295&e)>>>0,r=(4294967295&r)>>>0,(4294967295&(t^e^r))>>>0},y=function(t,e,r){return t=(4294967295&t)>>>0,e=(4294967295&e)>>>0,r=(4294967295&r)>>>0,(4294967295&(e^(t|~r)))>>>0},m=function(){var s=t,o=e,h=r,u=i;s=p(s+d(o,h,u)+a[0]+3614090360,7)+o,u=p(u+d(s,o,h)+a[1]+3905402710,12)+s,h=p(h+d(u,s,o)+a[2]+606105819,17)+u,o=p(o+d(h,u,s)+a[3]+3250441966,22)+h,s=p(s+d(o,h,u)+a[4]+4118548399,7)+o,u=p(u+d(s,o,h)+a[5]+1200080426,12)+s,h=p(h+d(u,s,o)+a[6]+2821735955,17)+u,o=p(o+d(h,u,s)+a[7]+4249261313,22)+h,s=p(s+d(o,h,u)+a[8]+1770035416,7)+o,u=p(u+d(s,o,h)+a[9]+2336552879,12)+s,h=p(h+d(u,s,o)+a[10]+4294925233,17)+u,o=p(o+d(h,u,s)+a[11]+2304563134,22)+h,s=p(s+d(o,h,u)+a[12]+1804603682,7)+o,u=p(u+d(s,o,h)+a[13]+4254626195,12)+s,h=p(h+d(u,s,o)+a[14]+2792965006,17)+u,o=p(o+d(h,u,s)+a[15]+1236535329,22)+h,s=p(s+F(o,h,u)+a[1]+4129170786,5)+o,u=p(u+F(s,o,h)+a[6]+3225465664,9)+s,h=p(h+F(u,s,o)+a[11]+643717713,14)+u,o=p(o+F(h,u,s)+a[0]+3921069994,20)+h,s=p(s+F(o,h,u)+a[5]+3593408605,5)+o,u=p(u+F(s,o,h)+a[10]+38016083,9)+s,h=p(h+F(u,s,o)+a[15]+3634488961,14)+u,o=p(o+F(h,u,s)+a[4]+3889429448,20)+h,s=p(s+F(o,h,u)+a[9]+568446438,5)+o,u=p(u+F(s,o,h)+a[14]+3275163606,9)+s,h=p(h+F(u,s,o)+a[3]+4107603335,14)+u,o=p(o+F(h,u,s)+a[8]+1163531501,20)+h,s=p(s+F(o,h,u)+a[13]+2850285829,5)+o,u=p(u+F(s,o,h)+a[2]+4243563512,9)+s,h=p(h+F(u,s,o)+a[7]+1735328473,14)+u,o=p(o+F(h,u,s)+a[12]+2368359562,20)+h,s=p(s+v(o,h,u)+a[5]+4294588738,4)+o,u=p(u+v(s,o,h)+a[8]+2272392833,11)+s,h=p(h+v(u,s,o)+a[11]+1839030562,16)+u,o=p(o+v(h,u,s)+a[14]+4259657740,23)+h,s=p(s+v(o,h,u)+a[1]+2763975236,4)+o,u=p(u+v(s,o,h)+a[4]+1272893353,11)+s,h=p(h+v(u,s,o)+a[7]+4139469664,16)+u,o=p(o+v(h,u,s)+a[10]+3200236656,23)+h,s=p(s+v(o,h,u)+a[13]+681279174,4)+o,u=p(u+v(s,o,h)+a[0]+3936430074,11)+s,h=p(h+v(u,s,o)+a[3]+3572445317,16)+u,o=p(o+v(h,u,s)+a[6]+76029189,23)+h,s=p(s+v(o,h,u)+a[9]+3654602809,4)+o,u=p(u+v(s,o,h)+a[12]+3873151461,11)+s,h=p(h+v(u,s,o)+a[15]+530742520,16)+u,o=p(o+v(h,u,s)+a[2]+3299628645,23)+h,s=p(s+y(o,h,u)+a[0]+4096336452,6)+o,u=p(u+y(s,o,h)+a[7]+1126891415,10)+s,h=p(h+y(u,s,o)+a[14]+2878612391,15)+u,o=p(o+y(h,u,s)+a[5]+4237533241,21)+h,s=p(s+y(o,h,u)+a[12]+1700485571,6)+o,u=p(u+y(s,o,h)+a[3]+2399980690,10)+s,h=p(h+y(u,s,o)+a[10]+4293915773,15)+u,o=p(o+y(h,u,s)+a[1]+2240044497,21)+h,s=p(s+y(o,h,u)+a[8]+1873313359,6)+o,u=p(u+y(s,o,h)+a[15]+4264355552,10)+s,h=p(h+y(u,s,o)+a[6]+2734768916,15)+u,o=p(o+y(h,u,s)+a[13]+1309151649,21)+h,s=p(s+y(o,h,u)+a[4]+4149444226,6)+o,u=p(u+y(s,o,h)+a[11]+3174756917,10)+s,h=p(h+y(u,s,o)+a[2]+718787259,15)+u,o=p(o+y(h,u,s)+a[9]+3951481745,21)+h,t=(t+s&4294967295)>>>0,e=(e+o&4294967295)>>>0,r=(r+h&4294967295)>>>0,i=(i+u&4294967295)>>>0,n=0;for(var c=0;c<a.length;c++)a[c]=0},b=function(){t=1732584193,e=4023233417,r=2562383102,i=271733878,n=0;for(var u=0,c=a.length;u<c;u++)a[u]=0;s=0;for(var u=0,c=h.length;u<c;u++)h[u]=0;o=0},A=function(t,e){e=e<0?0:e;var r=0;if(0!=o)for(;r<e;)if(h[o++]=t[r++],4==o){u(h,0),o=0;break}for(var i=(e-r&-4)+r;r<i;r+=4)u(t,r);for(;r<e;)h[o++]=t[r++];s+=e},S=function(){var t=new Array(16);return g(t,0),t};return{digest:function(t){return b(),A(t,t.length),S()},hmac:function(t,e){}}}(),R.algorithm.SHA1=function(){var t,e,r,i,n,s,o,a,h=new Array(80),u=new Array(4),c=1518500249,f=1859775393,l=2400959708,g=3395469782,p=function(t,e,r){return t&e|~t&r},d=function(t,e,r){return t^e^r},F=function(t,e,r){return t&e|t&r|e&r},v=function(t,e,r){e[r]=t>>>24&255,e[++r]=t>>>16&255,e[++r]=t>>>8&255,e[++r]=255&t},y=function(){a=0,o=0;for(var c=0,f=u.length;c<f;c++)u[c]=0;t=1732584193,e=4023233417,r=2562383102,i=271733878,n=3285377520,s=0;for(c=0;c!=h.length;c++)h[c]=0},m=function(){for(S=16;S<80;S++){var o=h[S-3]^h[S-8]^h[S-14]^h[S-16];h[S]=o<<1|o>>>31}for(var a=t,u=e,v=r,y=i,m=n,b=0,A=0;A<4;A++)y+=((m+=(a<<5|a>>>27)+p(u,v,y)+h[b++]+c)<<5|m>>>27)+p(a,u=u<<30|u>>>2,v)+h[b++]+c,a=a<<30|a>>>2,a+=((u+=((v+=(y<<5|y>>>27)+p(m,a,u)+h[b++]+c)<<5|v>>>27)+p(y,m=m<<30|m>>>2,a)+h[b++]+c)<<5|u>>>27)+p(v,y=y<<30|y>>>2,m)+h[b++]+c,v=v<<30|v>>>2;for(A=0;A<4;A++)y+=((m+=(a<<5|a>>>27)+d(u,v,y)+h[b++]+f)<<5|m>>>27)+d(a,u=u<<30|u>>>2,v)+h[b++]+f,a=a<<30|a>>>2,a+=((u+=((v+=(y<<5|y>>>27)+d(m,a,u)+h[b++]+f)<<5|v>>>27)+d(y,m=m<<30|m>>>2,a)+h[b++]+f)<<5|u>>>27)+d(v,y=y<<30|y>>>2,m)+h[b++]+f,v=v<<30|v>>>2;for(A=0;A<4;A++)y+=((m+=(a<<5|a>>>27)+F(u,v,y)+h[b++]+l)<<5|m>>>27)+F(a,u=u<<30|u>>>2,v)+h[b++]+l,a=a<<30|a>>>2,a+=((u+=((v+=(y<<5|y>>>27)+F(m,a,u)+h[b++]+l)<<5|v>>>27)+F(y,m=m<<30|m>>>2,a)+h[b++]+l)<<5|u>>>27)+F(v,y=y<<30|y>>>2,m)+h[b++]+l,v=v<<30|v>>>2;for(A=0;A<=3;A++)y+=((m+=(a<<5|a>>>27)+d(u,v,y)+h[b++]+g)<<5|m>>>27)+d(a,u=u<<30|u>>>2,v)+h[b++]+g,a=a<<30|a>>>2,a+=((u+=((v+=(y<<5|y>>>27)+d(m,a,u)+h[b++]+g)<<5|v>>>27)+d(y,m=m<<30|m>>>2,a)+h[b++]+g)<<5|u>>>27)+d(v,y=y<<30|y>>>2,m)+h[b++]+g,v=v<<30|v>>>2;t+=a,e+=u,r+=v,i+=y,n+=m,t&=4294967295,e&=4294967295,r&=4294967295,i&=4294967295,n&=4294967295,s=0;for(var S=0;S<16;S++)h[S]=0},b=function(t,e){var r=(255&t[e])<<24;r|=(255&t[++e])<<16,r|=(255&t[++e])<<8,r|=255&t[++e],h[s]=r,16==++s&&m()},A=function(t,e,r){r=r<0?0:r;var i=0;if(0!=o)for(;i<r;)if(u[o++]=t[e+i++],4==o){b(u,0),o=0;break}for(var n=(r-i&-4)+i;i<n;i+=4)b(t,e+i);for(;i<r;)u[o++]=t[e+i++];a+=r},S=function(t){u[o++]=t,o==u.length&&(b(u,0),o=0),a++},E=function(t){s>14&&m(),h[14]=(0xffffffff00000000&t)>>>32,h[15]=4294967295&t},B=function(){var t=a<<3;for(S(-128);0!=o;)S(0);E(t),m()},w=function(s,o){return B(),v(t,s,o),v(e,s,o+4),v(r,s,o+8),v(i,s,o+12),v(n,s,o+16),y(),20},x=function(){var t=new Array(20);return w(t,0),t};return{digest:function(t){return y(),A(t,0,t.length),x()}}}(),R.algorithm.SHA224=function(){var t,e,r,i,n,s,o,a,h,u,c,f=new Array(64),l=new Array(4),g=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],p=function(t,e,r){return t&e^~t&r},d=function(t,e,r){return t&e^t&r^e&r},F=function(t){return(t>>>2|t<<30)^(t>>>13|t<<19)^(t>>>22|t<<10)},v=function(t){return(t>>>6|t<<26)^(t>>>11|t<<21)^(t>>>25|t<<7)},y=function(t){return(t>>>7|t<<25)^(t>>>18|t<<14)^t>>>3},m=function(t){return(t>>>17|t<<15)^(t>>>19|t<<13)^t>>>10},b=function(t,e,r){e[r]=t>>>24&255,e[++r]=t>>>16&255,e[++r]=t>>>8&255,e[++r]=255&t},A=function(){c=0,u=0;for(var g=0,p=l.length;g<p;g++)l[g]=0;t=3238371032,e=914150663,r=812702999,i=4144912697,n=4290775857,s=1750603025,o=1694076839,a=3204075428,h=0;for(g=0;g!=f.length;g++)f[g]=0},S=function(){for(w=16;w<=63;w++)f[w]=m(f[w-2])+f[w-7]+y(f[w-15])+f[w-16];for(var u=t,c=e,l=r,b=i,A=n,S=s,E=o,B=a,w=0,x=0;x<8;x++)b+=B+=v(A)+p(A,S,E)+g[w]+f[w],B+=F(u)+d(u,c,l),++w,l+=E+=v(b)+p(b,A,S)+g[w]+f[w],E+=F(B)+d(B,u,c),++w,c+=S+=v(l)+p(l,b,A)+g[w]+f[w],S+=F(E)+d(E,B,u),++w,u+=A+=v(c)+p(c,l,b)+g[w]+f[w],A+=F(S)+d(S,E,B),++w,B+=b+=v(u)+p(u,c,l)+g[w]+f[w],b+=F(A)+d(A,S,E),++w,E+=l+=v(B)+p(B,u,c)+g[w]+f[w],l+=F(b)+d(b,A,S),++w,S+=c+=v(E)+p(E,B,u)+g[w]+f[w],c+=F(l)+d(l,b,A),++w,A+=u+=v(S)+p(S,E,B)+g[w]+f[w],u+=F(c)+d(c,l,b),++w;t+=u,e+=c,r+=l,i+=b,n+=A,s+=S,o+=E,a+=B,t&=4294967295,e&=4294967295,r&=4294967295,i&=4294967295,n&=4294967295,s&=4294967295,o&=4294967295,a&=4294967295,h=0;for(x=0;x<16;x++)f[x]=0},E=function(t,e){var r=(255&t[e])<<24;r|=(255&t[++e])<<16,r|=(255&t[++e])<<8,r|=255&t[++e],f[h]=r,16==++h&&S()},B=function(t,e,r){r=r<0?0:r;var i=0;if(0!=u)for(;i<r;)if(l[u++]=t[e+i++],4==u){E(l,0),u=0;break}for(var n=(r-i&-4)+i;i<n;i+=4)E(t,e+i);for(;i<r;)l[u++]=t[e+i++];c+=r},w=function(t){l[u++]=t,u==l.length&&(E(l,0),u=0),c++},x=function(t){h>14&&S(),f[14]=(0xffffffff00000000&t)>>>32,f[15]=4294967295&t},D=function(){var t=c<<3;for(w(128);0!=u;)w(0);x(t),S()},R=function(a,h){return D(),b(t,a,h),b(e,a,h+4),b(r,a,h+8),b(i,a,h+12),b(n,a,h+16),b(s,a,h+20),b(o,a,h+24),A(),28},T=function(){var t=new Array(28);return R(t,0),t};return{digest:function(t){return A(),B(t,0,t.length),T()}}}(),function(){var e=R.algorithm,r=R.util.Checker,i=R.util.Hex,n=R.util.Helper,s=R.algorithm.SM3,o=R.algorithm.SM4,a=R.util.DataPadding,h=R.util.Long,u=e.Token=function(){function e(){var t=Array.from(B.K).concat(p());return s.digest(t)}function c(){for(var e=p(),r=e.concat(e.length%16==0?new Array(0):new Array(16-e.length%16)),n=Array.from(B.K).slice(0,16),s=new Array(0),a=0;a<r.length/16;a++){var h=r.slice(16*a,16*(a+1));if(0!=a){var u=new t(i.stringify(s));u.add(new t(i.stringify(h))),h=new Array(u.toByteArray()).substring(0,16)}s=o.decryptWithECB(h,n)}return s}function f(t){r.checkArgument(null!=t&&32==t.length,"illegal S:%s",i.encode(t));for(var e=new h(0,0),n=h.getLongFromStr("0x00000000FFFFFFFF"),s=0;s<t.length;s+=4){var o=new h(0,255&t[s]),a=new h(0,255&t[s+1]),u=new h(0,255&t[s+2]),c=new h(0,255&t[s+3]);e=o.leftShift(24).OR(a.leftShift(16)).OR(u.leftShift(8)).OR(c).AND(n).add(e)}return e.high=0,e}function l(t){r.checkArgument(null!=t&&16==t.length,"illegal S:%s",i.encode(t));for(var e=new h(0,0),n=h.getLongFromStr("0x00000000FFFFFFFF"),s=0;s<t.length;s+=4){var o=new h(0,255&t[s]),a=new h(0,255&t[s+1]),u=new h(0,255&t[s+2]),c=new h(0,255&t[s+3]);e=o.leftShift(24).OR(a.leftShift(16)).OR(u.leftShift(8)).OR(c).AND(n).add(e)}return e.high=0,e}function g(t){r.checkArgument(null!=t&&8==t.length,"the size of serial must be 8 byte: %s",t),r.checkArgument(u.verifySerial(t),"verify serial failed.");for(var e=n.ascstr2array(t),i=new Array(t.length),o=0;o<t.length;o++)i[o]=n.ascXOR(n.ascstr2array("F")[0],e[o]);var a=s.digest(e),h=s.digest(i),c=new Array;return c=c.concat(a.slice(0,32),h.slice(0,32)),s.digest(c)}function p(){var t=new Array;if(t=t.concat(null==B.T?new Array:n.convertLong(B.T.toString(16))),t=t.concat(null==B.C?new Array:n.convertInteger(parseInt(B.C))),(t=t.concat(B.Q)).length<E)for(var e=E-t.length,r=0;r<e;r++)t.push(0);return t}function d(t,e){var r=(t=t.toString()).length;if(r<e){for(var i=e-r,n="",s=0;s<i;s++)n+="0";t=n+t}return t}i.decode("FEDCBA09876543211234567890ABCDEF");var F=1e3,v=60,y=-5,m=5,b=!0,A=2147483647,S=2147483648,E=16,B=(new h(0,1).leftShift(32),{sm3:!0,T:null,K:[],C:null,Q:[],N:null}),w=function(t,e,i){r.checkArgument(null!=t&&t.length>=16,"the length of seedKey must not be less than 128 bits (16 bytes)."),r.checkArgument(e>=6,"the length of Token must not be less than 6."),B.K=t,B.N=e,B.sm3=i,B.T=null,B.Q=[],B.C=null},x=w.prototype;return x.token=function(){r.checkArgument(B.N<=12,"the length of token can't be more than 12.");var t=B.sm3?e():c(),i=B.sm3?f(t):l(t),n=0;return B.N<=8?n=i.low%Math.pow(10,B.N):B.N<=12&&(n=(i.high%Math.pow(10,B.N-8)<<32)+i.low),d(n,B.N)},x.timeFactor1=function(t,e){r.checkArgument(e>0&&e<=60,"the value must be [1, 60]."),B.T=t/e},x.timeFactor2=function(t){t=h.getLongFromStr(t.toString(16));var e=new h(0,1),i=new h(2147483647,4294967295);r.checkArgument(t.bigger(e)&&i.bigger(t),"the size of timeFactor must be 8 bytes[-2^63, 2^63-1]."),B.T=(t.high<<32)+t.low},x.eventFactor=function(t){r.checkArgument(A>=t&&t>=S,"the size of eventFactor is [%d, %d]",S,A),B.C=t},x.challenge1=function(t){r.checkArgument(null!=t&&t.length>=4,"the length of challenge must not be less than 4 bytes."),B.Q=t},x.challenge2=function(t,e,i){r.checkArgument(null!=t&&t.length-e>=4&&i>=4,"the length of challenge must not be less than 4 bytes.");var n=new Array(i);n=t.slice(e,i+e),B.Q=n},{verifySerial:function(t){if(null==t||8!=t.length)return!1;for(var e=n.ascstr2array(t),r=e[0],i=1;i<e.length-1;i++)r=n.ascXOR(r,e[i]);return r==e[e.length-1]},verifyToken:function(t,e){if(null==t||t.length<6)return!1;for(var r=Math.floor((new Date).getTime()/F/v),i=t.length,n=y;n<=m;n++){var s=new w(e,i,b);if(s.timeFactor2(r+n),t==s.token())return!0}return!1},verifyActiveCode:function(t,e){if(r.checkArgument(null!=t&&8==t.length,"the size of serial must be 8 byte: %s",t),null==e||e.length<12)return!1;var i=g(t),s=new w(i,6,b);s.challenge2(n.ascstr2array(e),0,8);var o=s.token();return e.substring(8,12)==o.substring(2,6)},generateActiveCode:function(t){r.checkArgument(null!=t&&8==t.length,"the size of serial must be 8 byte: %s",t),r.checkArgument(this.verifySerial(t),"verify serial failed.");var e=n.generateDecRandom(8),i=g(t),s=new w(i,6,b);return s.challenge1(n.ascstr2array(e)),e+s.token().substring(2,6)},generateWorkSeed:function(t,e){r.checkArgument(null!=e&&12==e.length,"the size of active code must be 12 byte: %d",e),r.checkArgument(this.verifyActiveCode(t,e),"verify activeCode failed.");var i=g(t),o=new Array;o=o.concat(n.ascstr2array(e).slice(0,8));var h=a.encodeWith0x00(o,16),u=new Array;u=u.concat(i.slice(0,32),h.slice(0,16));var c=new Array;return c=c.concat(s.digest(u).slice(0,20))},generateToken:function(t,e){r.checkArgument(null!=t&&8==t.length,"the size of serial must be 8 byte: %s",t),r.checkArgument(null!=e&&12==e.length,"the size of active code must be 12 byte: %d",e);var i=this.generateWorkSeed(t,e),n=Math.floor((new Date).getTime()/F/v),s=new w(i,6,b);return s.timeFactor2(n),s.token()}}}()}(),R.algorithm.SHA256=function(){var t,e,r,i,n,s,o,a,h,u,c,f=new Array(64),l=new Array(4),g=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],p=function(t,e,r){return t&e^~t&r},d=function(t,e,r){return t&e^t&r^e&r},F=function(t){return(t>>>2|t<<30)^(t>>>13|t<<19)^(t>>>22|t<<10)},v=function(t){return(t>>>6|t<<26)^(t>>>11|t<<21)^(t>>>25|t<<7)},y=function(t){return(t>>>7|t<<25)^(t>>>18|t<<14)^t>>>3},m=function(t){return(t>>>17|t<<15)^(t>>>19|t<<13)^t>>>10},b=function(t,e,r){e[r]=t>>>24&255,e[++r]=t>>>16&255,e[++r]=t>>>8&255,e[++r]=255&t},A=function(){c=0,u=0;for(var g=0,p=l.length;g<p;g++)l[g]=0;t=1779033703,e=3144134277,r=1013904242,i=2773480762,n=1359893119,s=2600822924,o=528734635,a=1541459225,h=0;for(g=0;g!=f.length;g++)f[g]=0},S=function(){for(w=16;w<=63;w++)f[w]=m(f[w-2])+f[w-7]+y(f[w-15])+f[w-16];for(var u=t,c=e,l=r,b=i,A=n,S=s,E=o,B=a,w=0,x=0;x<8;x++)b+=B+=v(A)+p(A,S,E)+g[w]+f[w],B+=F(u)+d(u,c,l),++w,l+=E+=v(b)+p(b,A,S)+g[w]+f[w],E+=F(B)+d(B,u,c),++w,c+=S+=v(l)+p(l,b,A)+g[w]+f[w],S+=F(E)+d(E,B,u),++w,u+=A+=v(c)+p(c,l,b)+g[w]+f[w],A+=F(S)+d(S,E,B),++w,B+=b+=v(u)+p(u,c,l)+g[w]+f[w],b+=F(A)+d(A,S,E),++w,E+=l+=v(B)+p(B,u,c)+g[w]+f[w],l+=F(b)+d(b,A,S),++w,S+=c+=v(E)+p(E,B,u)+g[w]+f[w],c+=F(l)+d(l,b,A),++w,A+=u+=v(S)+p(S,E,B)+g[w]+f[w],u+=F(c)+d(c,l,b),++w;t+=u,e+=c,r+=l,i+=b,n+=A,s+=S,o+=E,a+=B,t&=4294967295,e&=4294967295,r&=4294967295,i&=4294967295,n&=4294967295,s&=4294967295,o&=4294967295,a&=4294967295,h=0;for(x=0;x<16;x++)f[x]=0},E=function(t,e){var r=(255&t[e])<<24;r|=(255&t[++e])<<16,r|=(255&t[++e])<<8,r|=255&t[++e],f[h]=r,16==++h&&S()},B=function(t,e,r){r=r<0?0:r;var i=0;if(0!=u)for(;i<r;)if(l[u++]=t[e+i++],4==u){E(l,0),u=0;break}for(var n=(r-i&-4)+i;i<n;i+=4)E(t,e+i);for(;i<r;)l[u++]=t[e+i++];c+=r},w=function(t){l[u++]=t,u==l.length&&(E(l,0),u=0),c++},x=function(t){h>14&&S(),f[14]=(0xffffffff00000000&t)>>>32,f[15]=4294967295&t},D=function(){var t=c<<3;for(w(128);0!=u;)w(0);x(t),S()},R=function(h,u){return D(),b(t,h,u),b(e,h,u+4),b(r,h,u+8),b(i,h,u+12),b(n,h,u+16),b(s,h,u+20),b(o,h,u+24),b(a,h,u+28),A(),32},T=function(){var t=new Array(32);return R(t,0),t};return{digest:function(t){return A(),B(t,0,t.length),T()}}}(),function(){var t=R.algorithm,e=R.util.Long;t.SHA384=function(){var t,r,i,n,s,o,a,h,u,c,f,l,g=new Array(8),p=new Array(80),d=["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"],F=[],v=function(t,e,r){return t.AND(e).XOR(t.Negate().AND(r))},y=function(t,e,r){return t.AND(e).XOR(t.AND(r),e.AND(r))},m=function(t){return t.leftShift(36).OR(t.rightShift(28)).XOR(t.leftShift(30).OR(t.rightShift(34)),t.leftShift(25).OR(t.rightShift(39)))},b=function(t){return t.leftShift(50).OR(t.rightShift(14)).XOR(t.leftShift(46).OR(t.rightShift(18)),t.leftShift(23).OR(t.rightShift(41)))},A=function(t){return t.leftShift(63).OR(t.rightShift(1)).XOR(t.leftShift(56).OR(t.rightShift(8)),t.rightShift(7))},S=function(t){return t.leftShift(45).OR(t.rightShift(19)).XOR(t.leftShift(3).OR(t.rightShift(61)),t.rightShift(6))},E=function(t,e){var r=(255&t[e])<<24;return r|=(255&t[++e])<<16,r|=(255&t[++e])<<8,r|=255&t[++e]},B=function(t,e,r){e[r]=t>>>24&255,e[++r]=t>>>16&255,e[++r]=t>>>8&255,e[++r]=255&t},w=function(t,r){var i=new e(0,0);return i.high=E(t,r),i.low=E(t,r+4),i},x=function(t,e,r){B(t.high,e,r),B(t.low,e,r+4)},D=function(){for(E=0;E<d.length;E++)F[E]=e.getLongFromStr(d[E]);t=0,n=e.getLongFromStr("0xcbbb9d5dc1059ed8"),s=e.getLongFromStr("0x629a292a367cd507"),o=e.getLongFromStr("0x9159015a3070dd17"),a=e.getLongFromStr("0x152fecd8f70e5939"),h=e.getLongFromStr("0x67332667ffc00b31"),u=e.getLongFromStr("0x8eb44a8768581511"),c=e.getLongFromStr("0xdb0c2e0d64f98fa7"),f=e.getLongFromStr("0x47b5481dbefa4fa4");n.AND(s),n.OR(s),n.XOR(s),n.leftShift(36),n.rightShift(40),h.Negate(),n.add(s);t=0;for(E=0;E<g.length;E++)g[E]=0;l=0;for(var E=0;E!=p.length;E++)p[E]=new e(0,0);var B=v(h,u,c),w=(y(n,s,o),m(n),b(h));A(n),S(n),f.add(w,B,F[0],p[0]);r=new e(0,0),i=new e(0,0)},R=function(){if(r.high>536870911){i=i.add(r.rightShift(61));var t=new e(536870911,4294967295);r=r.AND(t)}},T=function(){R();for(w=16;w<=79;w++)p[w]=S(p[w-2]).add(p[w-7],A(p[w-15]),p[w-16]);S(p[20]).add(p[15],A(p[7]),p[6]);for(var t=n,e=s,r=o,i=a,g=h,d=u,E=c,B=f,w=0,x=0;x<10;x++)B=B.add(b(g),v(g,d,E),F[w],p[w++]),i=i.add(B),B=B.add(m(t),y(t,e,r)),E=E.add(b(i),v(i,g,d),F[w],p[w++]),r=r.add(E),E=E.add(m(B),y(B,t,e)),d=d.add(b(r),v(r,i,g),F[w],p[w++]),e=e.add(d),d=d.add(m(E),y(E,B,t)),g=g.add(b(e),v(e,r,i),F[w],p[w++]),t=t.add(g),g=g.add(m(d),y(d,E,B)),i=i.add(b(t),v(t,e,r),F[w],p[w++]),B=B.add(i),i=i.add(m(g),y(g,d,E)),r=r.add(b(B),v(B,t,e),F[w],p[w++]),E=E.add(r),r=r.add(m(i),y(i,g,d)),e=e.add(b(E),v(E,B,t),F[w],p[w++]),d=d.add(e),e=e.add(m(r),y(r,i,g)),t=t.add(b(d),v(d,E,B),F[w],p[w++]),g=g.add(t),t=t.add(m(e),y(e,r,i));n=n.add(t),s=s.add(e),o=o.add(r),a=a.add(i),h=h.add(g),u=u.add(d),c=c.add(E),f=f.add(B),l=0;for(x=0;x<16;x++)p[x].high=0,p[x].low=0},C=function(t,e){p[l]=w(t,e),16==++l&&T()},I=function(e){g[t++]=e,t==g.length&&(C(g,0),t=0),r.low++},K=function(e,i,n){for(;0!=t&&n>0;)I(e[i]),i++,n--;for(;n>g.length;)C(e,i),i+=g.length,n-=g.length,r.low+=g.length;for(;n>0;)I(e[i]),i++,n--},O=function(t,e){l>14&&T(),p[14]=e,p[15]=t},U=function(){R();var e=r.leftShift(3),n=i;for(I(128);0!=t;)I(0);O(e,n),T()},H=function(t,e){return U(),x(n,t,e),x(s,t,e+8),x(o,t,e+16),x(a,t,e+24),x(h,t,e+32),x(u,t,e+40),D(),48},N=function(){var t=new Array(48);return H(t,0),t};return{digest:function(t){return D(),K(t,0,t.length),N()}}}()}(),function(){var t=R.algorithm,e=R.util.Long;t.SHA512=function(){var t,r,i,n,s,o,a,h,u,c,f,l,g=new Array(8),p=new Array(80),d=["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"],F=[],v=function(t,e,r){return t.AND(e).XOR(t.Negate().AND(r))},y=function(t,e,r){return t.AND(e).XOR(t.AND(r),e.AND(r))},m=function(t){return t.leftShift(36).OR(t.rightShift(28)).XOR(t.leftShift(30).OR(t.rightShift(34)),t.leftShift(25).OR(t.rightShift(39)))},b=function(t){return t.leftShift(50).OR(t.rightShift(14)).XOR(t.leftShift(46).OR(t.rightShift(18)),t.leftShift(23).OR(t.rightShift(41)))},A=function(t){return t.leftShift(63).OR(t.rightShift(1)).XOR(t.leftShift(56).OR(t.rightShift(8)),t.rightShift(7))},S=function(t){return t.leftShift(45).OR(t.rightShift(19)).XOR(t.leftShift(3).OR(t.rightShift(61)),t.rightShift(6))},E=function(t,e){var r=(255&t[e])<<24;return r|=(255&t[++e])<<16,r|=(255&t[++e])<<8,r|=255&t[++e]},B=function(t,e,r){e[r]=t>>>24&255,e[++r]=t>>>16&255,e[++r]=t>>>8&255,e[++r]=255&t},w=function(t,r){var i=new e(0,0);return i.high=E(t,r),i.low=E(t,r+4),i},x=function(t,e,r){B(t.high,e,r),B(t.low,e,r+4)},D=function(){for(v=0;v<d.length;v++)F[v]=e.getLongFromStr(d[v]);t=0,n=e.getLongFromStr("0x6a09e667f3bcc908"),s=e.getLongFromStr("0xbb67ae8584caa73b"),o=e.getLongFromStr("0x3c6ef372fe94f82b"),a=e.getLongFromStr("0xa54ff53a5f1d36f1"),h=e.getLongFromStr("0x510e527fade682d1"),u=e.getLongFromStr("0x9b05688c2b3e6c1f"),c=e.getLongFromStr("0x1f83d9abfb41bd6b"),f=e.getLongFromStr("0x5be0cd19137e2179"),t=0;for(v=0;v<g.length;v++)g[v]=0;l=0;for(var v=0;v!=p.length;v++)p[v]=new e(0,0);r=new e(0,0),i=new e(0,0)},R=function(){if(r.high>536870911){i=i.add(r.rightShift(61));var t=new e(536870911,4294967295);r=r.AND(t)}},T=function(){R();for(w=16;w<=79;w++)p[w]=S(p[w-2]).add(p[w-7],A(p[w-15]),p[w-16]);S(p[20]).add(p[15],A(p[7]),p[6]);for(var t=n,e=s,r=o,i=a,g=h,d=u,E=c,B=f,w=0,x=0;x<10;x++)B=B.add(b(g),v(g,d,E),F[w],p[w++]),i=i.add(B),B=B.add(m(t),y(t,e,r)),E=E.add(b(i),v(i,g,d),F[w],p[w++]),r=r.add(E),E=E.add(m(B),y(B,t,e)),d=d.add(b(r),v(r,i,g),F[w],p[w++]),e=e.add(d),d=d.add(m(E),y(E,B,t)),g=g.add(b(e),v(e,r,i),F[w],p[w++]),t=t.add(g),g=g.add(m(d),y(d,E,B)),i=i.add(b(t),v(t,e,r),F[w],p[w++]),B=B.add(i),i=i.add(m(g),y(g,d,E)),r=r.add(b(B),v(B,t,e),F[w],p[w++]),E=E.add(r),r=r.add(m(i),y(i,g,d)),e=e.add(b(E),v(E,B,t),F[w],p[w++]),d=d.add(e),e=e.add(m(r),y(r,i,g)),t=t.add(b(d),v(d,E,B),F[w],p[w++]),g=g.add(t),t=t.add(m(e),y(e,r,i));n=n.add(t),s=s.add(e),o=o.add(r),a=a.add(i),h=h.add(g),u=u.add(d),c=c.add(E),f=f.add(B),l=0;for(x=0;x<16;x++)p[x].high=0,p[x].low=0},C=function(t,e){p[l]=w(t,e),16==++l&&T()},I=function(e){g[t++]=e,t==g.length&&(C(g,0),t=0),r.low++},K=function(e,i,n){for(;0!=t&&n>0;)I(e[i]),i++,n--;for(;n>g.length;)C(e,i),i+=g.length,n-=g.length,r.low+=g.length;for(;n>0;)I(e[i]),i++,n--},O=function(t,e){l>14&&T(),p[14]=e,p[15]=t},U=function(){R();var e=r.leftShift(3),n=i;for(I(128);0!=t;)I(0);O(e,n),T()},H=function(t,e){return U(),x(n,t,e),x(s,t,e+8),x(o,t,e+16),x(a,t,e+24),x(h,t,e+32),x(u,t,e+40),x(c,t,e+48),x(f,t,e+56),D(),64},N=function(){var t=new Array(64);return H(t,0),t};return{getAlgorithmName:function(){return"SHA-512"},getDigestSize:function(){return 64},digest:function(t){return D(),K(t,0,t.length),N()}}}()}(),function(){var t=R,e=t.util.Hex,r=t.util.Helper,i=t.util.DataPadding;t.DigitalEnvelope={encrypt:function(n,s,o){void 0===typeof o&&(o={});var a=o.asymmetricAlg.name||t.AsymmetricAlg.RSA.name,h=o.symmetricAlg||t.SymmetricAlg.DES128,u=o.pad||t.Pad.padPKCS5,c=t.algorithm,f=r.getRandom(h.size),l=c[a].encrypt(f,e.parse(s)),g=c[h.name].encryptWithECB(i["encodeWith"+u](n,h.size),f);return{KeyCipher:e.stringify(l),MessageCipher:e.stringify(g)}},decrypt:function(r,n,s){void 0===typeof s&&(s={});var o=s.asymmetricAlg.name||t.AsymmetricAlg.RSA.name,a=s.symmetricAlg||t.SymmetricAlg.DES128,h=s.pad||t.Pad.padPKCS5,u=t.algorithm,c=u[o].decrypt(e.parse(r.KeyCipher),e.parse(n)),f=u[a.name].decryptWithECB(e.parse(r.MessageCipher),c);return e.stringify(i["decodeWith"+h](f))}}}(),R});